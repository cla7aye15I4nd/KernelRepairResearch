id: b8639c8dcb5ec4483d4f
bug_link: https://syzkaller.appspot.com/bug?extid=b8639c8dcb5ec4483d4f
title: 'KASAN: use-after-free Read in delete_partition'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cafe01ef8fcb248583038e1be071383530fe355a
fix_commit: 08fc1ab6d748ab1a690fd483f41e2938984ce353
datetime: '2020-09-01T08:35:35-06:00'
fix_commit_message: 'block: fix locking in bdev_del_partition


  We need to hold the whole device bd_mutex to protect against

  other thread concurrently deleting out partition before we get

  to it, and thus causing a use after free.


  Fixes: cddae808aeb7 ("block: pass a hd_struct to delete_partition")

  Reported-by: syzbot+6448f3c229bc52b82f69@syzkaller.appspotmail.com

  Signed-off-by: Christoph Hellwig <hch@lst.de>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- block/partitions
hunk_count: 2
covered_count: 2
