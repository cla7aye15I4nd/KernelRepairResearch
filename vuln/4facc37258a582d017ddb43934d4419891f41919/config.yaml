id: 4facc37258a582d017ddb43934d4419891f41919
bug_link: https://syzkaller.appspot.com/bug?extid=4facc37258a582d017ddb43934d4419891f41919
title: kernel BUG at arch/x86/kvm/x86.c:LINE!
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ac9b305caa0df6f5b75d294e4b86c1027648991e
fix_commit: 61cb57c9ed631c95b54f8e9090c89d18b3695b3c
datetime: '2017-11-17T13:20:10+01:00'
fix_commit_message: 'KVM: x86: Exit to user-mode on #UD intercept when emulator requires


  Instruction emulation after trapping a #UD exception can result in an

  MMIO access, for example when emulating a MOVBE on a processor that

  doesn''t support the instruction.  In this case, the #UD vmexit handler

  must exit to user mode, but there wasn''t any code to do so.  Add it for

  both VMX and SVM.


  Signed-off-by: Liran Alon <liran.alon@oracle.com>

  Reviewed-by: Nikita Leshenko <nikita.leshchenko@oracle.com>

  Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>

  Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>

  Reviewed-by: Wanpeng Li <wanpeng.li@hotmail.com>

  Reviewed-by: Paolo Bonzini <pbonzini@redhat.com>

  Cc: stable@vger.kernel.org

  Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>

  '
submodule:
- arch/x86/kvm
hunk_count: 2
covered_count: 0
