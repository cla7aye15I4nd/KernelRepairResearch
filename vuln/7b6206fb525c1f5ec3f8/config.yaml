id: 7b6206fb525c1f5ec3f8
bug_link: https://syzkaller.appspot.com/bug?extid=7b6206fb525c1f5ec3f8
title: 'KASAN: slab-out-of-bounds Read in bitmap_port_ext_cleanup'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7eaecf7963c1c8f62d62c6a8e7c439b0e7f2d365
fix_commit: 32c72165dbd0e246e69d16a3ad348a4851afd415
datetime: '2020-01-20T17:41:45+01:00'
fix_commit_message: 'netfilter: ipset: use bitmap infrastructure completely


  The bitmap allocation did not use full unsigned long sizes

  when calculating the required size and that was triggered by KASAN

  as slab-out-of-bounds read in several places. The patch fixes all

  of them.


  Reported-by: syzbot+fabca5cbf5e54f3fe2de@syzkaller.appspotmail.com

  Reported-by: syzbot+827ced406c9a1d9570ed@syzkaller.appspotmail.com

  Reported-by: syzbot+190d63957b22ef673ea5@syzkaller.appspotmail.com

  Reported-by: syzbot+dfccdb2bdb4a12ad425e@syzkaller.appspotmail.com

  Reported-by: syzbot+df0d0f5895ef1f41a65b@syzkaller.appspotmail.com

  Reported-by: syzbot+b08bd19bb37513357fd4@syzkaller.appspotmail.com

  Reported-by: syzbot+53cdd0ec0bbabd53370a@syzkaller.appspotmail.com

  Signed-off-by: Jozsef Kadlecsik <kadlec@netfilter.org>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- include/linux/netfilter/ipset
- net/netfilter
hunk_count: 11
covered_count: 4
