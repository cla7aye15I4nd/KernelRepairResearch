id: ec0723ba9605678b14bf
bug_link: https://syzkaller.appspot.com/bug?extid=ec0723ba9605678b14bf
title: 'KMSAN: uninit-value in ppp_async_push (3)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 8c6790b5c25dfac11b589cc37346bcf9e23ad468
fix_commit: f2aeb7306a898e1cbd03963d376f4b6656ca2b55
datetime: '2024-07-11T11:00:08+02:00'
fix_commit_message: 'ppp: reject claimed-as-LCP but actually malformed packets


  Since ''ppp_async_encode()'' assumes valid LCP packets (with code

  from 1 to 7 inclusive), add ''ppp_check_packet()'' to ensure that

  LCP packet has an actual body beyond PPP_LCP header bytes, and

  reject claimed-as-LCP but actually malformed data otherwise.


  Reported-by: syzbot+ec0723ba9605678b14bf@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=ec0723ba9605678b14bf

  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Signed-off-by: Paolo Abeni <pabeni@redhat.com>

  '
submodule:
- drivers/net/ppp
hunk_count: 3
covered_count: 3
