id: 40642be9b7e0bb28e0df
bug_link: https://syzkaller.appspot.com/bug?extid=40642be9b7e0bb28e0df
title: 'INFO: trying to register non-static key in f2fs_handle_error'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4d8d45df2252980f800c1b2fde941a103a18a70e
fix_commit: cc249e4cba9a6002c9d9e1438daf8440a160bc9e
datetime: '2022-11-11T09:48:24-08:00'
fix_commit_message: "f2fs: fix to avoid accessing uninitialized spinlock\n\nsyzbot\
  \ reports a kernel bug:\n\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x1e3/0x2cb\
  \ lib/dump_stack.c:106\n assign_lock_key+0x22a/0x240 kernel/locking/lockdep.c:981\n\
  \ register_lock_class+0x287/0x9b0 kernel/locking/lockdep.c:1294\n __lock_acquire+0xe4/0x1f60\
  \ kernel/locking/lockdep.c:4934\n lock_acquire+0x1a7/0x400 kernel/locking/lockdep.c:5668\n\
  \ __raw_spin_lock include/linux/spinlock_api_smp.h:133 [inline]\n _raw_spin_lock+0x2a/0x40\
  \ kernel/locking/spinlock.c:154\n spin_lock include/linux/spinlock.h:350 [inline]\n\
  \ f2fs_save_errors fs/f2fs/super.c:3868 [inline]\n f2fs_handle_error+0x29/0x230\
  \ fs/f2fs/super.c:3896\n f2fs_iget+0x215/0x4bb0 fs/f2fs/inode.c:516\n f2fs_fill_super+0x47d3/0x7b50\
  \ fs/f2fs/super.c:4222\n mount_bdev+0x26c/0x3a0 fs/super.c:1401\n legacy_get_tree+0xea/0x180\
  \ fs/fs_context.c:610\n vfs_get_tree+0x88/0x270 fs/super.c:1531\n do_new_mount+0x289/0xad0\
  \ fs/namespace.c:3040\n do_mount fs/namespace.c:3383 [inline]\n __do_sys_mount fs/namespace.c:3591\
  \ [inline]\n __se_sys_mount+0x2e3/0x3d0 fs/namespace.c:3568\n do_syscall_x64 arch/x86/entry/common.c:50\
  \ [inline]\n do_syscall_64+0x2b/0x70 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\
  \nF2FS-fs (loop1): Failed to read F2FS meta data inode\n\nThe root cause is if sbi->error_lock\
  \ may be accessed before\nits initialization, fix it.\n\nLink: https://lore.kernel.org/linux-f2fs-devel/0000000000007edb6605ecbb6442@google.com/T/#u\n\
  Reported-by: syzbot+40642be9b7e0bb28e0df@syzkaller.appspotmail.com\nFixes: 95fa90c9e5a7\
  \ (\"f2fs: support recording errors into superblock\")\nSigned-off-by: Chao Yu <chao@kernel.org>\n\
  Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>\n"
submodule:
- fs/f2fs
hunk_count: 2
covered_count: 2
