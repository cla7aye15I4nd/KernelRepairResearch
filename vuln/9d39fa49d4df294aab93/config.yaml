id: 9d39fa49d4df294aab93
bug_link: https://syzkaller.appspot.com/bug?extid=9d39fa49d4df294aab93
title: 'KASAN: stack-out-of-bounds Write in bitmap_from_arr32'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a379b01cd4b2aa3f12786b281a714871574e5ccb
fix_commit: a770bf515613c6e12ae904c3593e26016de99448
datetime: '2020-12-09T15:50:38-08:00'
fix_commit_message: 'ethtool: fix stack overflow in ethnl_parse_bitset()


  Syzbot reported a stack overflow in bitmap_from_arr32() called from

  ethnl_parse_bitset() when bitset from netlink message is longer than

  target bitmap length. While ethnl_compact_sanity_checks() makes sure that

  trailing part is all zeros (i.e. the request does not try to touch bits

  kernel does not recognize), we also need to cap change_bits to nbits so

  that we don''t try to write past the prepared bitmaps.


  Fixes: 88db6d1e4f62 ("ethtool: add ethnl_parse_bitset() helper")

  Reported-by: syzbot+9d39fa49d4df294aab93@syzkaller.appspotmail.com

  Signed-off-by: Michal Kubecek <mkubecek@suse.cz>

  Link: https://lore.kernel.org/r/3487ee3a98e14cd526f55b6caaa959d2dcbcad9f.1607465316.git.mkubecek@suse.cz

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- net/ethtool
hunk_count: 1
covered_count: 1
