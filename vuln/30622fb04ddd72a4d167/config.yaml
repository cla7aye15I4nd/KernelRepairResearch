id: 30622fb04ddd72a4d167
bug_link: https://syzkaller.appspot.com/bug?extid=30622fb04ddd72a4d167
title: WARNING in __static_key_slow_dec
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e0b6417be08850646d4e44ef1123772ec786baea
fix_commit: 6d5f1ef838683efba01bacb7854f6516fbcbae17
datetime: '2021-09-06T13:12:09+01:00'
fix_commit_message: 'bonding: Fix negative jump label count on nested bonding


  With nested bonding devices the nested bond device''s ndo_bpf was

  called without a program causing it to decrement the static key

  without a prior increment leading to negative count.


  Fix the issue by 1) only calling slave''s ndo_bpf when there''s a

  program to be loaded and 2) only decrement the count when a program

  is unloaded.


  Fixes: 9e2ee5c7e7c3 ("net, bonding: Add XDP support to the bonding driver")

  Reported-by: syzbot+30622fb04ddd72a4d167@syzkaller.appspotmail.com

  Signed-off-by: Jussi Maki <joamaki@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net/bonding
hunk_count: 2
covered_count: 2
