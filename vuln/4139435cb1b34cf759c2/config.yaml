id: 4139435cb1b34cf759c2
bug_link: https://syzkaller.appspot.com/bug?extid=4139435cb1b34cf759c2
title: 'KASAN: slab-out-of-bounds Write in do_handle_open'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 61db088eeb996225bd5b88ba2f6518f865958bd9
fix_commit: 68d6f4f3fbd9b1baae53e7cf33fb3362b5a21494
datetime: '2024-04-05T15:53:47+02:00'
fix_commit_message: 'fs: Annotate struct file_handle with __counted_by() and use struct_size()


  Prepare for the coming implementation by GCC and Clang of the __counted_by

  attribute. Flexible array members annotated with __counted_by can have

  their accesses bounds-checked at run-time via CONFIG_UBSAN_BOUNDS (for

  array indexing) and CONFIG_FORTIFY_SOURCE (for strcpy/memcpy-family

  functions).


  While there, use struct_size() helper, instead of the open-coded

  version.


  [brauner@kernel.org: contains a fix by Edward for an OOB access]

  Reported-by: syzbot+4139435cb1b34cf759c2@syzkaller.appspotmail.com

  Signed-off-by: Edward Adam Davis <eadavis@qq.com>

  Link: https://lore.kernel.org/r/tencent_A7845DD769577306D813742365E976E3A205@qq.com

  Signed-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>

  Link: https://lore.kernel.org/r/ZgImCXTdGDTeBvSS@neat

  Reviewed-by: Jan Kara <jack@suse.cz>

  Signed-off-by: Christian Brauner <brauner@kernel.org>

  '
submodule:
- fs
- include/linux
hunk_count: 4
covered_count: 3
