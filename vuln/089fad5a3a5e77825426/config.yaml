id: 089fad5a3a5e77825426
bug_link: https://syzkaller.appspot.com/bug?extid=089fad5a3a5e77825426
title: 'UBSAN: shift-out-of-bounds in validate_sb_layout'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a069f014797fdef8757f3adebc1c16416271a599
fix_commit: 2045fc4295c427d420aa1ff551b4de8179b6e5d5
datetime: '2024-10-24T17:41:43-04:00'
fix_commit_message: 'bcachefs: Fix invalid shift in validate_sb_layout()


  Add check on layout->sb_max_size_bits against BCH_SB_LAYOUT_SIZE_BITS_MAX

  to prevent UBSAN shift-out-of-bounds in validate_sb_layout().


  Reported-by: syzbot+089fad5a3a5e77825426@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=089fad5a3a5e77825426

  Fixes: 03ef80b469d5 ("bcachefs: Ignore unknown mount options")

  Tested-by: syzbot+089fad5a3a5e77825426@syzkaller.appspotmail.com

  Signed-off-by: Gianfranco Trad <gianf.trad@gmail.com>

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 2
covered_count: 1
