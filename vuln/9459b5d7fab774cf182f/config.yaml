id: 9459b5d7fab774cf182f
bug_link: https://syzkaller.appspot.com/bug?extid=9459b5d7fab774cf182f
title: 'KASAN: stack-out-of-bounds Read in hash'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 96b98a6552a90690d7bc18dd71b66312c9ded1fb
fix_commit: a8d89feba7e54e691ca7c4efc2a6264fa83f3687
datetime: '2024-03-27T09:56:17-07:00'
fix_commit_message: 'bpf: Check bloom filter map value size


  This patch adds a missing check to bloom filter creating, rejecting

  values above KMALLOC_MAX_SIZE. This brings the bloom map in line with

  many other map types.


  The lack of this protection can cause kernel crashes for value sizes

  that overflow int''s. Such a crash was caught by syzkaller. The next

  patch adds more guard-rails at a lower level.


  Signed-off-by: Andrei Matei <andreimatei1@gmail.com>

  Acked-by: Andrii Nakryiko <andrii@kernel.org>

  Link: https://lore.kernel.org/r/20240327024245.318299-2-andreimatei1@gmail.com

  Signed-off-by: Alexei Starovoitov <ast@kernel.org>

  '
submodule:
- kernel/bpf
- tools/testing/selftests/bpf/prog_tests
hunk_count: 4
covered_count: 1
