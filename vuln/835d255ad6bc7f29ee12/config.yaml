id: 835d255ad6bc7f29ee12
bug_link: https://syzkaller.appspot.com/bug?extid=835d255ad6bc7f29ee12
title: 'UBSAN: shift-out-of-bounds in bch2_blacklist_entries_gc'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 211c581de28e7741898720b5f74da4e62f37f972
fix_commit: 472237b69d071c877e97bf0bc3eab1be865fad29
datetime: '2024-06-25T17:53:31-04:00'
fix_commit_message: 'bcachefs: Fix shift-out-of-bounds in bch2_blacklist_entries_gc


  This series fix the shift-out-of-bounds issue in

  bch2_blacklist_entries_gc().


  Instead of passing 0 to eytzinger0_first() when iterating the entries,

  we explicitly check 0 and initialize i to be 0.


  syzbot has tested the proposed patch and the reproducer did not trigger

  any issue:


  Reported-and-tested-by: syzbot+835d255ad6bc7f29ee12@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=835d255ad6bc7f29ee12

  Signed-off-by: Pei Li <peili.dev@gmail.com>

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 1
covered_count: 1
