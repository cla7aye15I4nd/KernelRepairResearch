id: 6f03d895a6cd0d06187f
bug_link: https://syzkaller.appspot.com/bug?extid=6f03d895a6cd0d06187f
title: 'KASAN: use-after-free Read in io_uring_setup'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7b20238d28da46f394d37d4d51cc420e1ff9414a
fix_commit: 044c1ab399afbe9f2ebef49a3204ef1509826dc7
datetime: '2019-10-28T09:15:33-06:00'
fix_commit_message: 'io_uring: don''t touch ctx in setup after ring fd install


  syzkaller reported an issue where it looks like a malicious app can

  trigger a use-after-free of reading the ctx ->sq_array and ->rings

  value right after having installed the ring fd in the process file

  table.


  Defer ring fd installation until after we''re done reading those

  values.


  Fixes: 75b28affdd6a ("io_uring: allocate the two rings together")

  Reported-by: syzbot+6f03d895a6cd0d06187f@syzkaller.appspotmail.com

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 2
covered_count: 2
