id: a0d209a4676664613e76
bug_link: https://syzkaller.appspot.com/bug?extid=a0d209a4676664613e76
title: 'KASAN: invalid-free in skb_free_head'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 41d5b25fed0a010cedbdd25e56fdb92d59c233fa
fix_commit: cf94da6f502d8caecabd56b194541c873c8a7a3c
datetime: '2019-11-04T15:19:02+01:00'
fix_commit_message: 'Bluetooth: Fix invalid-free in bcsp_close()


  Syzbot reported an invalid-free that I introduced fixing a memleak.


  bcsp_recv() also frees bcsp->rx_skb but never nullifies its value.

  Nullify bcsp->rx_skb every time it is freed.


  Signed-off-by: Tomas Bortoli <tomasbortoli@gmail.com>

  Reported-by: syzbot+a0d209a4676664613e76@syzkaller.appspotmail.com

  Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

  '
submodule:
- drivers/bluetooth
hunk_count: 3
covered_count: 3
