id: 9b64b619f10f19d19a7c
bug_link: https://syzkaller.appspot.com/bug?extid=9b64b619f10f19d19a7c
title: 'UBSAN: array-index-out-of-bounds in arch_uprobe_analyze_insn'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4e9a5ae8df5b3365183150f6df49e49dece80d8c
fix_commit: 12cb908a11b2544b5f53e9af856e6b6a90ed5533
datetime: '2020-12-06T10:03:08+01:00'
fix_commit_message: "x86/insn-eval: Use new for_each_insn_prefix() macro to loop over\
  \ prefixes bytes\n\nSince insn.prefixes.nbytes can be bigger than the size of\n\
  insn.prefixes.bytes[] when a prefix is repeated, the proper check must\nbe\n\n \
  \ insn.prefixes.bytes[i] != 0 and i < 4\n\ninstead of using insn.prefixes.nbytes.\
  \ Use the new\nfor_each_insn_prefix() macro which does it correctly.\n\nDebugged\
  \ by Kees Cook <keescook@chromium.org>.\n\n [ bp: Massage commit message. ]\n\n\
  Fixes: 32d0b95300db (\"x86/insn-eval: Add utility functions to get segment selector\"\
  )\nReported-by: syzbot+9b64b619f10f19d19a7c@syzkaller.appspotmail.com\nSigned-off-by:\
  \ Masami Hiramatsu <mhiramat@kernel.org>\nSigned-off-by: Borislav Petkov <bp@suse.de>\n\
  Cc: stable@vger.kernel.org\nLink: https://lkml.kernel.org/r/160697104969.3146288.16329307586428270032.stgit@devnote2\n"
submodule:
- arch/x86/lib
hunk_count: 2
covered_count: 0
