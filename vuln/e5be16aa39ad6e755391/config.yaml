id: e5be16aa39ad6e755391
bug_link: https://syzkaller.appspot.com/bug?extid=e5be16aa39ad6e755391
title: 'KMSAN: uninit-value in bond_start_xmit (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c3ead2df9776ab22490d78a7f68a8ec58700e07f
fix_commit: 9d1bc24b52fb8c5d859f9a47084bf1179470e04c
datetime: '2019-07-03T13:26:12-07:00'
fix_commit_message: 'bonding: validate ip header before check IPPROTO_IGMP


  bond_xmit_roundrobin() checks for IGMP packets but it parses

  the IP header even before checking skb->protocol.


  We should validate the IP header with pskb_may_pull() before

  using iph->protocol.


  Reported-and-tested-by: syzbot+e5be16aa39ad6e755391@syzkaller.appspotmail.com

  Fixes: a2fd940f4cff ("bonding: fix broken multicast with round-robin mode")

  Cc: Jay Vosburgh <j.vosburgh@gmail.com>

  Cc: Veaceslav Falico <vfalico@gmail.com>

  Cc: Andy Gospodarek <andy@greyhouse.net>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net/bonding
hunk_count: 2
covered_count: 2
