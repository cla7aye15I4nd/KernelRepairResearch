id: 838346b979830606c854
bug_link: https://syzkaller.appspot.com/bug?extid=838346b979830606c854
title: 'BUG: unable to handle kernel paging request in bpf_prog_ADDR (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b867247555c4181bf84eb10b72b176862c29112d
fix_commit: 543576ec15b17c0c93301ac8297333c7b6e84ac7
datetime: '2024-04-30T10:43:37-07:00'
fix_commit_message: 'bpf: Add BPF_PROG_TYPE_CGROUP_SKB attach type enforcement in
  BPF_LINK_CREATE


  bpf_prog_attach uses attach_type_to_prog_type to enforce proper

  attach type for BPF_PROG_TYPE_CGROUP_SKB. link_create uses

  bpf_prog_get and relies on bpf_prog_attach_check_attach_type

  to properly verify prog_type <> attach_type association.


  Add missing attach_type enforcement for the link_create case.

  Otherwise, it''s currently possible to attach cgroup_skb prog

  types to other cgroup hooks.


  Fixes: af6eea57437a ("bpf: Implement bpf_link-based cgroup BPF program attachment")

  Link: https://lore.kernel.org/bpf/0000000000004792a90615a1dde0@google.com/

  Reported-by: syzbot+838346b979830606c854@syzkaller.appspotmail.com

  Signed-off-by: Stanislav Fomichev <sdf@google.com>

  Acked-by: Eduard Zingerman <eddyz87@gmail.com>

  Link: https://lore.kernel.org/r/20240426231621.2716876-2-sdf@google.com

  Signed-off-by: Martin KaFai Lau <martin.lau@kernel.org>

  '
submodule:
- kernel/bpf
hunk_count: 1
covered_count: 0
