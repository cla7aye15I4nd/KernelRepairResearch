id: 6a7e7ed886bde43469c4
bug_link: https://syzkaller.appspot.com/bug?extid=6a7e7ed886bde43469c4
title: WARNING in kmalloc_slab (4)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2471c98165494173a3cd03231b216b909c063e41
fix_commit: d97ca5d714a5334aecadadf696875da40f1fbf3e
datetime: '2018-02-13T09:12:09+01:00'
fix_commit_message: 'xfrm_user: uncoditionally validate esn replay attribute struct


  The sanity test added in ecd7918745234 can be bypassed, validation

  only occurs if XFRM_STATE_ESN flag is set, but rest of code doesn''t care

  and just checks if the attribute itself is present.


  So always validate.  Alternative is to reject if we have the attribute

  without the flag but that would change abi.


  Reported-by: syzbot+0ab777c27d2bb7588f73@syzkaller.appspotmail.com

  Cc: Mathias Krause <minipli@googlemail.com>

  Fixes: ecd7918745234 ("xfrm_user: ensure user supplied esn replay window is valid")

  Fixes: d8647b79c3b7e ("xfrm: Add user interface for esn and big anti-replay windows")

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 1
covered_count: 0
