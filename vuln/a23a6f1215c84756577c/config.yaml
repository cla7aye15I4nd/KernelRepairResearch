id: a23a6f1215c84756577c
bug_link: https://syzkaller.appspot.com/bug?extid=a23a6f1215c84756577c
title: 'KCSAN: data-race in snd_rawmidi_transmit / snd_rawmidi_write'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4ebd47037027c4beae99680bff3b20fdee5d7c1e
fix_commit: 88a06d6fd6b369d88cec46c62db3e2604a2f50d5
datetime: '2020-12-06T09:36:10+01:00'
fix_commit_message: 'ALSA: rawmidi: Access runtime->avail always in spinlock


  The runtime->avail field may be accessed concurrently while some

  places refer to it without taking the runtime->lock spinlock, as

  detected by KCSAN.  Usually this isn''t a big problem, but for

  consistency and safety, we should take the spinlock at each place

  referencing this field.


  Reported-by: syzbot+a23a6f1215c84756577c@syzkaller.appspotmail.com

  Reported-by: syzbot+3d367d1df1d2b67f5c19@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20201206083527.21163-1-tiwai@suse.de

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  '
submodule:
- sound/core
hunk_count: 9
covered_count: 4
