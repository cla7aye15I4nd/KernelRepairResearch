id: fef86971c84310f1c8cd
bug_link: https://syzkaller.appspot.com/bug?extid=fef86971c84310f1c8cd
title: 'WARNING: lock held when returning to user space in rcu_lock_acquire'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 54ecb8f7028c5eb3d740bb82b0f1d90f2df63c5c
fix_commit: 73956fc07dd7b25d4a33ab3fdd6247c60d0b237c
datetime: '2019-10-01T21:27:50+02:00'
fix_commit_message: "membarrier: Fix RCU locking bug caused by faulty merge\n\nThe\
  \ following commit:\n\n  227a4aadc75b (\"sched/membarrier: Fix p->mm->membarrier_state\
  \ racy load\")\n\ngot fat fingered by me when merging it with other patches. It\
  \ meant to move\nthe RCU section out of the for loop but ended up doing it partially,\
  \ leaving\na superfluous rcu_read_lock() inside, causing havok.\n\nReported-by:\
  \ Ingo Molnar <mingo@kernel.org>\nSigned-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>\n\
  Cc: Borislav Petkov <bp@alien8.de>\nCc: Chris Metcalf <cmetcalf@ezchip.com>\nCc:\
  \ Christoph Lameter <cl@linux.com>\nCc: Eric W. Biederman <ebiederm@xmission.com>\n\
  Cc: Kirill Tkhai <tkhai@yandex.ru>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\n\
  Cc: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>\nCc: Mike Galbraith <efault@gmx.de>\n\
  Cc: Oleg Nesterov <oleg@redhat.com>\nCc: Paul E. McKenney <paulmck@linux.ibm.com>\n\
  Cc: Peter Zijlstra <peterz@infradead.org>\nCc: Russell King - ARM Linux admin <linux@armlinux.org.uk>\n\
  Cc: Thomas Gleixner <tglx@linutronix.de>\nCc: linux-tip-commits@vger.kernel.org\n\
  Fixes: 227a4aadc75b (\"sched/membarrier: Fix p->mm->membarrier_state racy load\"\
  )\nLink: https://lkml.kernel.org/r/20191001085033.GP4519@hirez.programming.kicks-ass.net\n\
  Signed-off-by: Ingo Molnar <mingo@kernel.org>\n"
submodule:
- kernel/sched
hunk_count: 1
covered_count: 0
