id: a5964227adc0f904549c
bug_link: https://syzkaller.appspot.com/bug?extid=a5964227adc0f904549c
title: 'KASAN: slab-out-of-bounds Read in atomic_ptr_type_ok'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 307ef667e94530c2f2f77797bfe9ea85c22bec7d
fix_commit: 9aa8fe29f624610b4694d5b5695e1017c4753f31
datetime: '2025-03-22T06:19:09-07:00'
fix_commit_message: "Merge branch 'bpf-fix-oob-read-and-add-tests-for-load-acquire-store-release'\n\
  \nKohei Enju says:\n\n====================\nbpf: Fix OOB read and add tests for\
  \ load-acquire/store-release\n\nThis patch series addresses an out-of-bounds read\
  \ issue in\ncheck_atomic_load/store() reported by syzkaller when an invalid register\n\
  number (MAX_BPF_REG or greater) is used.\n\nThe first patch fixes the actual bug\
  \ by changing the order of validity\nchecks, ensuring register validity is checked\
  \ before atomic_ptr_type_ok()\nis called.\nIt also updates some tests that were\
  \ assuming the previous order of checks.\n\nThe second patch adds new tests specifically\
  \ for the invalid register\nnumber case to prevent regression in the future.\n\n\
  Changes:\n  v3:\n    - Change invalid register from R11 to R15 in new tests\n  v2:\
  \ https://lore.kernel.org/all/20250321110010.95217-4-enjuk@amazon.com/\n    - Just\
  \ swap atomic_ptr_type_ok() and check_load_mem()/check_store_reg()\n    - Update\
  \ some tests that were assuming the previous order of checks\n    - Add new tests\
  \ specifically for the invalid register number\n  v1: https://lore.kernel.org/bpf/20250314195619.23772-2-enjuk@amazon.com/\n\
  \nReported-by: syzbot+a5964227adc0f904549c@syzkaller.appspotmail.com\nCloses: https://syzkaller.appspot.com/bug?extid=a5964227adc0f904549c\n\
  ====================\n\nLink: https://patch.msgid.link/20250322045340.18010-4-enjuk@amazon.com\n\
  Signed-off-by: Alexei Starovoitov <ast@kernel.org>\n"
submodule:
- kernel/bpf
- tools/testing/selftests/bpf/progs
hunk_count: 9
covered_count: 3
