id: 2d215d165f9354b9c4ea
bug_link: https://syzkaller.appspot.com/bug?extid=2d215d165f9354b9c4ea
title: 'KASAN: slab-out-of-bounds Write in fuse_dev_do_write'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bd24d2108e9c8459d2c9f3d6d910b0053887df57
fix_commit: 9d81ba6d49a7457784f0b6a71046818b86ec7e44
datetime: '2025-08-27T14:29:43+02:00'
fix_commit_message: 'fuse: Block access to folio overlimit


  syz reported a slab-out-of-bounds Write in fuse_dev_do_write.


  When the number of bytes to be retrieved is truncated to the upper limit

  by fc->max_pages and there is an offset, the oob is triggered.


  Add a loop termination condition to prevent overruns.


  Fixes: 3568a9569326 ("fuse: support large folios for retrieves")

  Reported-by: syzbot+2d215d165f9354b9c4ea@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=2d215d165f9354b9c4ea

  Tested-by: syzbot+2d215d165f9354b9c4ea@syzkaller.appspotmail.com

  Signed-off-by: Edward Adam Davis <eadavis@qq.com>

  Reviewed-by: Joanne Koong <joannelkoong@gmail.com>

  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  '
submodule:
- fs/fuse
hunk_count: 1
covered_count: 1
