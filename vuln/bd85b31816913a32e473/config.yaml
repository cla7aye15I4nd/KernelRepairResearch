id: bd85b31816913a32e473
bug_link: https://syzkaller.appspot.com/bug?extid=bd85b31816913a32e473
title: general protection fault in nl802154_trigger_scan
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6c993779ea1d0cccdb3a5d7d45446dd229e610a3
fix_commit: 02f18662f6c671382345fcb696e808d78f4c194a
datetime: '2023-03-02T14:39:48+01:00'
fix_commit_message: 'ieee802154: Prevent user from crashing the host


  Avoid crashing the machine by checking

  info->attrs[NL802154_ATTR_SCAN_TYPE] presence before de-referencing it,

  which was the primary intend of the blamed patch.


  Reported-by: Sanan Hasanov <sanan.hasanov@Knights.ucf.edu>

  Suggested-by: Eric Dumazet <edumazet@google.com>

  Fixes: a0b6106672b5 ("ieee802154: Convert scan error messages to extack")

  Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

  Link: https://lore.kernel.org/r/20230301154450.547716-1-miquel.raynal@bootlin.com

  Signed-off-by: Stefan Schmidt <stefan@datenfreihafen.org>

  '
submodule:
- net/ieee802154
hunk_count: 1
covered_count: 1
