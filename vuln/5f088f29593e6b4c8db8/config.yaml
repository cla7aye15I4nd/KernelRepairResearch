id: 5f088f29593e6b4c8db8
bug_link: https://syzkaller.appspot.com/bug?extid=5f088f29593e6b4c8db8
title: 'UBSAN: shift-out-of-bounds in extAlloc'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 87098a0d9e42cba2ec49b56dfbf1e4944a6e7bb6
fix_commit: 0225e10972fa809728b8d4c1bd2772b3ec3fdb57
datetime: '2023-08-29T12:25:47-05:00'
fix_commit_message: 'jfs: validate max amount of blocks before allocation.


  The lack of checking bmp->db_max_freebud in extBalloc() can lead to

  shift out of bounds, so this patch prevents undefined behavior, because

  bmp->db_max_freebud == -1 only if there is no free space.


  Signed-off-by: Aleksei Filippov <halip0503@gmail.com>

  Signed-off-by: Dave Kleikamp <dave.kleikamp@oracle.com>

  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Reported-and-tested-by: syzbot+5f088f29593e6b4c8db8@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?id=01abadbd6ae6a08b1f1987aa61554c6b3ac19ff2

  '
submodule:
- fs/jfs
hunk_count: 1
covered_count: 1
