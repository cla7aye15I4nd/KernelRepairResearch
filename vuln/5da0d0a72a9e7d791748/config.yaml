id: 5da0d0a72a9e7d791748
bug_link: https://syzkaller.appspot.com/bug?extid=5da0d0a72a9e7d791748
title: 'KASAN: slab-out-of-bounds Read in sctp_getsockopt'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: df132eff463873e14e019a07f387b4d577d6d1f9
fix_commit: 713358369382cebf92f6e98ce2005f94e7344931
datetime: '2018-10-29T20:50:41-07:00'
fix_commit_message: 'sctp: check policy more carefully when getting pr status


  When getting pr_assocstatus and pr_streamstatus by sctp_getsockopt,

  it doesn''t correctly process the case when policy is set with

  SCTP_PR_SCTP_ALL | SCTP_PR_SCTP_MASK. It even causes a

  slab-out-of-bounds in sctp_getsockopt_pr_streamstatus().


  This patch fixes it by return -EINVAL for this case.


  Fixes: 0ac1077e3a54 ("sctp: get pr_assoc and pr_stream all status with SCTP_PR_SCTP_ALL")

  Reported-by: syzbot+5da0d0a72a9e7d791748@syzkaller.appspotmail.com

  Suggested-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>

  Signed-off-by: Xin Long <lucien.xin@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/sctp
hunk_count: 2
covered_count: 1
