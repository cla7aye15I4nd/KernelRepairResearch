id: c244af085a0159d22879
bug_link: https://syzkaller.appspot.com/bug?extid=c244af085a0159d22879
title: WARNING in __might_sleep (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 352c4cf40c4a7d439fa5d30aa2160f54b394da82
fix_commit: fc01d8c61ce02c034e67378cd3e645734bc18c8c
datetime: '2019-01-18T13:27:54+01:00'
fix_commit_message: 'tty/n_hdlc: fix __might_sleep warning


  Fix __might_sleep warning[1] in tty/n_hdlc.c read due to copy_to_user

  call while current is TASK_INTERRUPTIBLE.  This is a false positive

  since the code path does not depend on current state remaining

  TASK_INTERRUPTIBLE.  The loop breaks out and sets TASK_RUNNING after

  calling copy_to_user.


  This patch supresses the warning by setting TASK_RUNNING before calling

  copy_to_user.


  [1] https://syzkaller.appspot.com/bug?id=17d5de7f1fcab794cb8c40032f893f52de899324


  Signed-off-by: Paul Fulghum <paulkf@microgate.com>

  Reported-by: syzbot <syzbot+c244af085a0159d22879@syzkaller.appspotmail.com>

  Cc: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Cc: Alan Cox <alan@lxorguk.ukuu.org.uk>

  Cc: stable <stable@vger.kernel.org>

  Acked-by: Arnd Bergmann <arnd@arndb.de>

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/tty
hunk_count: 1
covered_count: 1
