id: 8881b478dad0a7971f79
bug_link: https://syzkaller.appspot.com/bug?extid=8881b478dad0a7971f79
title: 'UBSAN: shift-out-of-bounds in option_probe'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: daa919196be49815e342eb79fab81852102703c2
fix_commit: a251963f76fa0226d0fdf0c4f989496f18d9ae7f
datetime: '2020-12-09T14:54:46+01:00'
fix_commit_message: 'USB: serial: option: add interface-number sanity check to flag
  handling


  Add an interface-number sanity check before testing the device flags to

  avoid relying on undefined behaviour when left shifting in case a device

  uses an interface number greater than or equal to BITS_PER_LONG (i.e. 64

  or 32).


  Reported-by: syzbot+8881b478dad0a7971f79@syzkaller.appspotmail.com

  Fixes: c3a65808f04a ("USB: serial: option: reimplement interface masking")

  Cc: stable@vger.kernel.org

  Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  Signed-off-by: Johan Hovold <johan@kernel.org>

  '
submodule:
- drivers/usb/serial
hunk_count: 5
covered_count: 4
