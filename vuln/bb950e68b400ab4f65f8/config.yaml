id: bb950e68b400ab4f65f8
bug_link: https://syzkaller.appspot.com/bug?extid=bb950e68b400ab4f65f8
title: 'INFO: rcu detected stall in snd_seq_write (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 403c521003a1364fd2d7c01a2a1f66ed025fb94a
fix_commit: 6fadb494a638d8b8a55864ecc6ac58194f03f327
datetime: '2021-12-07T17:52:28+01:00'
fix_commit_message: 'ALSA: seq: Set upper limit of processed events


  Currently ALSA sequencer core tries to process the queued events as

  much as possible when they become dispatchable.  If applications try

  to queue too massive events to be processed at the very same timing,

  the sequencer core would still try to process such all events, either

  in the interrupt context or via some notifier; in either away, it

  might be a cause of RCU stall or such problems.


  As a potential workaround for those problems, this patch adds the

  upper limit of the amount of events to be processed.  The remaining

  events are processed in the next batch, so they won''t be lost.


  For the time being, it''s limited up to 1000 events per queue, which

  should be high enough for any normal usages.


  Reported-by: Zqiang <qiang.zhang1211@gmail.com>

  Reported-by: syzbot+bb950e68b400ab4f65f8@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20211102033222.3849-1-qiang.zhang1211@gmail.com

  Link: https://lore.kernel.org/r/20211207165146.2888-1-tiwai@suse.de

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  '
submodule:
- sound/core/seq
hunk_count: 3
covered_count: 3
