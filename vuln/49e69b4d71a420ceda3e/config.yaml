id: 49e69b4d71a420ceda3e
bug_link: https://syzkaller.appspot.com/bug?extid=49e69b4d71a420ceda3e
title: 'KMSAN: uninit-value in audit_log_vformat (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ae83d0b416db002fe95601e7f97f64b59514d936
fix_commit: 763dafc520add02a1f4639b500c509acc0ea8e5b
datetime: '2020-04-20T17:10:58-04:00'
fix_commit_message: 'audit: check the length of userspace generated audit records


  Commit 756125289285 ("audit: always check the netlink payload length

  in audit_receive_msg()") fixed a number of missing message length

  checks, but forgot to check the length of userspace generated audit

  records.  The good news is that you need CAP_AUDIT_WRITE to submit

  userspace audit records, which is generally only given to trusted

  processes, so the impact should be limited.


  Cc: stable@vger.kernel.org

  Fixes: 756125289285 ("audit: always check the netlink payload length in audit_receive_msg()")

  Reported-by: syzbot+49e69b4d71a420ceda3e@syzkaller.appspotmail.com

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  '
submodule:
- kernel
hunk_count: 1
covered_count: 1
