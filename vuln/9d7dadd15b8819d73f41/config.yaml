id: 9d7dadd15b8819d73f41
bug_link: https://syzkaller.appspot.com/bug?extid=9d7dadd15b8819d73f41
title: WARNING in osif_probe/usb_submit_urb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3265a7e6b41bae8608e7e91ac6798de5e5564164
fix_commit: 4ca070ef0dd885616ef294d269a9bf8e3b258e1a
datetime: '2021-06-24T22:08:00+02:00'
fix_commit_message: 'i2c: robotfuzz-osif: fix control-request directions


  The direction of the pipe argument must match the request-type direction

  bit or control requests may fail depending on the host-controller-driver

  implementation.


  Control transfers without a data stage are treated as OUT requests by

  the USB stack and should be using usb_sndctrlpipe(). Failing to do so

  will now trigger a warning.


  Fix the OSIFI2C_SET_BIT_RATE and OSIFI2C_STOP requests which erroneously

  used the osif_usb_read() helper and set the IN direction bit.


  Reported-by: syzbot+9d7dadd15b8819d73f41@syzkaller.appspotmail.com

  Fixes: 83e53a8f120f ("i2c: Add bus driver for for OSIF USB i2c device.")

  Cc: stable@vger.kernel.org      # 3.14

  Signed-off-by: Johan Hovold <johan@kernel.org>

  Signed-off-by: Wolfram Sang <wsa@kernel.org>

  '
submodule:
- drivers/i2c/busses
hunk_count: 2
covered_count: 2
