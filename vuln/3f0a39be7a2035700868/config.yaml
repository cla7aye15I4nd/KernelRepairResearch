id: 3f0a39be7a2035700868
bug_link: https://syzkaller.appspot.com/bug?extid=3f0a39be7a2035700868
title: 'KASAN: slab-use-after-free Write in __hci_acl_create_connection_sync'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bf98feea5b65ced367a871cf35fc044dedbcfb85
fix_commit: 5f641f03abccddd1a37233ff1b8e774b9ff1f4e8
datetime: '2024-03-06T17:23:52-05:00'
fix_commit_message: 'Bluetooth: hci_conn: Fix UAF Write in __hci_acl_create_connection_sync


  This fixes the UAF on __hci_acl_create_connection_sync caused by

  connection abortion, it uses the same logic as to LE_LINK which uses

  hci_cmd_sync_cancel to prevent the callback to run if the connection is

  abort prematurely.


  Reported-by: syzbot+3f0a39be7a2035700868@syzkaller.appspotmail.com

  Fixes: 45340097ce6e ("Bluetooth: hci_conn: Only do ACL connections sequentially")

  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

  '
submodule:
- include/net/bluetooth
- net/bluetooth
hunk_count: 5
covered_count: 3
