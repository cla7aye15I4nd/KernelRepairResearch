id: 015afdb01dbf2abb6a6bfdd5430b72e5503fca6d
bug_link: https://syzkaller.appspot.com/bug?extid=015afdb01dbf2abb6a6bfdd5430b72e5503fca6d
title: 'KASAN: slab-out-of-bounds Read in strcmp'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4f0753e708c2e07f6e9bc1adfa73138e8ab0ee5d
fix_commit: ef28df55ac27e1e5cd122e19fa311d886d47a756
datetime: '2017-11-28T18:51:12-05:00'
fix_commit_message: 'selinux: ensure the context is NUL terminated in security_context_to_sid_core()


  The syzbot/syzkaller automated tests found a problem in

  security_context_to_sid_core() during early boot (before we load the

  SELinux policy) where we could potentially feed context strings without

  NUL terminators into the strcmp() function.


  We already guard against this during normal operation (after the SELinux

  policy has been loaded) by making a copy of the context strings and

  explicitly adding a NUL terminator to the end.  The patch extends this

  protection to the early boot case (no loaded policy) by moving the context

  copy earlier in security_context_to_sid_core().


  Reported-by: syzbot <syzkaller@googlegroups.com>

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  Reviewed-By: William Roberts <william.c.roberts@intel.com>

  '
submodule:
- security/selinux/ss
hunk_count: 1
covered_count: 1
