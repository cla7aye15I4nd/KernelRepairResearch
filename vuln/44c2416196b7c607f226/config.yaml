id: 44c2416196b7c607f226
bug_link: https://syzkaller.appspot.com/bug?extid=44c2416196b7c607f226
title: 'BUG: unable to handle kernel paging request in nsim_bpf'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d3fa86b1a7b4cdc4367acacea16b72e0a200b3d7
fix_commit: c0c6bde586c7dce82719b4ff32a2db6af9ee3d65
datetime: '2023-11-23T13:04:04-08:00'
fix_commit_message: 'netdevsim: Don''t accept device bound programs


  Commit 2b3486bc2d23 ("bpf: Introduce device-bound XDP programs") introduced

  device-bound programs by largely reusing existing offloading infrastructure.

  This changed the semantics of ''prog->aux->offload'' a bit. Now, it''s non-NULL

  for both offloaded and device-bound programs.


  Instead of looking at ''prog->aux->offload'' let''s call bpf_prog_is_offloaded

  which should be true iff the program is offloaded and not merely device-bound.


  Fixes: 2b3486bc2d23 ("bpf: Introduce device-bound XDP programs")

  Reported-by: syzbot+44c2416196b7c607f226@syzkaller.appspotmail.com

  Signed-off-by: Stanislav Fomichev <sdf@google.com>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Reviewed-by: Jakub Kicinski <kuba@kernel.org>

  Cc: Dipendra Khadka <kdipendra88@gmail.com>

  Link: https://lore.kernel.org/bpf/20231114045453.1816995-2-sdf@google.com

  Signed-off-by: Alexei Starovoitov <ast@kernel.org>

  '
submodule:
- drivers/net/netdevsim
hunk_count: 2
covered_count: 2
