id: e2eae5639e7203360018
bug_link: https://syzkaller.appspot.com/bug?extid=e2eae5639e7203360018
title: 'INFO: rcu detected stall in tx'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ff1176468d368232b684f75e82563369208bc371
fix_commit: 30fad76ce4e98263edfa8f885c81d5426c1bf169
datetime: '2021-07-27T15:52:37+02:00'
fix_commit_message: "USB: usbtmc: Fix RCU stall warning\n\nrcu: INFO: rcu_preempt\
  \ self-detected stall on CPU\nrcu:    1-...!: (2 ticks this GP) idle=d92/1/0x4000000000000000\n\
  \        softirq=25390/25392 fqs=3\n        (t=12164 jiffies g=31645 q=43226)\n\
  rcu: rcu_preempt kthread starved for 12162 jiffies! g31645 f0x0\n     RCU_GP_WAIT_FQS(5)\
  \ ->state=0x0 ->cpu=0\nrcu:    Unless rcu_preempt kthread gets sufficient CPU time,\n\
  \        OOM is now expected behavior.\nrcu: RCU grace-period kthread stack dump:\n\
  task:rcu_preempt     state:R  running task\n...........\nusbtmc 3-1:0.0: unknown\
  \ status received: -71\nusbtmc 3-1:0.0: unknown status received: -71\nusbtmc 3-1:0.0:\
  \ unknown status received: -71\nusbtmc 3-1:0.0: unknown status received: -71\nusbtmc\
  \ 3-1:0.0: unknown status received: -71\nusbtmc 3-1:0.0: unknown status received:\
  \ -71\nusbtmc 3-1:0.0: unknown status received: -71\nusbtmc 3-1:0.0: unknown status\
  \ received: -71\nusbtmc 3-1:0.0: usb_submit_urb failed: -19\n\nThe function usbtmc_interrupt()\
  \ resubmits urbs when the error status\nof an urb is -EPROTO. In systems using the\
  \ dummy_hcd usb controller\nthis can result in endless interrupt loops when the\
  \ usbtmc device is\ndisconnected from the host system.\n\nSince host controller\
  \ drivers already try to recover from transmission\nerrors, there is no need to\
  \ resubmit the urb or try other solutions\nto repair the error situation.\n\nIn\
  \ case of errors the INT pipe just stops to wait for further packets.\n\nFixes:\
  \ dbf3e7f654c0 (\"Implement an ioctl to support the USMTMC-USB488 READ_STATUS_BYTE\
  \ operation\")\nCc: stable@vger.kernel.org\nReported-by: syzbot+e2eae5639e7203360018@syzkaller.appspotmail.com\n\
  Signed-off-by: Qiang.zhang <qiang.zhang@windriver.com>\nAcked-by: Guido Kiener <guido.kiener@rohde-schwarz.com>\n\
  Link: https://lore.kernel.org/r/20210723004334.458930-1-qiang.zhang@windriver.com\n\
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n"
submodule:
- drivers/usb/class
hunk_count: 1
covered_count: 0
