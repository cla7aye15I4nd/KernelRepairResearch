id: 30754ca335e6fb7e3092
bug_link: https://syzkaller.appspot.com/bug?extid=30754ca335e6fb7e3092
title: 'KASAN: slab-use-after-free Read in cmp_bss'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f64768bec0d57988782d26d1ea7ae21f959309dd
fix_commit: 26e84445f02ce6b2fe5f3e0e28ff7add77f35e08
datetime: '2025-08-26T13:45:09+02:00'
fix_commit_message: 'wifi: cfg80211: fix use-after-free in cmp_bss()


  Following bss_free() quirk introduced in commit 776b3580178f

  ("cfg80211: track hidden SSID networks properly"), adjust

  cfg80211_update_known_bss() to free the last beacon frame

  elements only if they''re not shared via the corresponding

  ''hidden_beacon_bss'' pointer.


  Reported-by: syzbot+30754ca335e6fb7e3092@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=30754ca335e6fb7e3092

  Fixes: 3ab8227d3e7d ("cfg80211: refactor cfg80211_bss_update")

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Link: https://patch.msgid.link/20250813135236.799384-1-dmantipov@yandex.ru

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/wireless
hunk_count: 1
covered_count: 1
