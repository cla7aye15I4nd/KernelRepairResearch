id: d7e968426f644b567e31
bug_link: https://syzkaller.appspot.com/bug?extid=d7e968426f644b567e31
title: WARNING in rtl8150_open/usb_submit_urb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b2aec4efe834130d190ed8052e3312761fb9e790
fix_commit: 90b7f2961798793275b4844348619b622f983907
datetime: '2025-01-28T11:55:22+01:00'
fix_commit_message: "net: usb: rtl8150: enable basic endpoint checking\n\nSyzkaller\
  \ reports [1] encountering a common issue of utilizing a wrong\nusb endpoint type\
  \ during URB submitting stage. This, in turn, triggers\na warning shown below.\n\
  \nFor now, enable simple endpoint checking (specifically, bulk and\ninterrupt eps,\
  \ testing control one is not essential) to mitigate\nthe issue with a view to do\
  \ other related cosmetic changes later,\nif they are necessary.\n\n[1] Syzkaller\
  \ report:\nusb 1-1: BOGUS urb xfer, pipe 3 != type 1\nWARNING: CPU: 1 PID: 2586\
  \ at drivers/usb/core/urb.c:503 usb_submit_urb+0xe4b/0x1730 driv>\nModules linked\
  \ in:\nCPU: 1 UID: 0 PID: 2586 Comm: dhcpcd Not tainted 6.11.0-rc4-syzkaller-00069-gfc88bb11617>\n\
  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 08/06/2024\n\
  RIP: 0010:usb_submit_urb+0xe4b/0x1730 drivers/usb/core/urb.c:503\nCode: 84 3c 02\
  \ 00 00 e8 05 e4 fc fc 4c 89 ef e8 fd 25 d7 fe 45 89 e0 89 e9 4c 89 f2 48 8>\nRSP:\
  \ 0018:ffffc9000441f740 EFLAGS: 00010282\nRAX: 0000000000000000 RBX: ffff888112487a00\
  \ RCX: ffffffff811a99a9\nRDX: ffff88810df6ba80 RSI: ffffffff811a99b6 RDI: 0000000000000001\n\
  RBP: 0000000000000003 R08: 0000000000000001 R09: 0000000000000000\nR10: 0000000000000000\
  \ R11: 0000000000000001 R12: 0000000000000001\nR13: ffff8881023bf0a8 R14: ffff888112452a20\
  \ R15: ffff888112487a7c\nFS:  00007fc04eea5740(0000) GS:ffff8881f6300000(0000) knlGS:0000000000000000\n\
  CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f0a1de9f870 CR3: 000000010dbd0000\
  \ CR4: 00000000003506f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n\
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n\
  \ <TASK>\n rtl8150_open+0x300/0xe30 drivers/net/usb/rtl8150.c:733\n __dev_open+0x2d4/0x4e0\
  \ net/core/dev.c:1474\n __dev_change_flags+0x561/0x720 net/core/dev.c:8838\n dev_change_flags+0x8f/0x160\
  \ net/core/dev.c:8910\n devinet_ioctl+0x127a/0x1f10 net/ipv4/devinet.c:1177\n inet_ioctl+0x3aa/0x3f0\
  \ net/ipv4/af_inet.c:1003\n sock_do_ioctl+0x116/0x280 net/socket.c:1222\n sock_ioctl+0x22e/0x6c0\
  \ net/socket.c:1341\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:907\
  \ [inline]\n __se_sys_ioctl fs/ioctl.c:893 [inline]\n __x64_sys_ioctl+0x193/0x220\
  \ fs/ioctl.c:893\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xcd/0x250\
  \ arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7fc04ef73d49\n\
  ...\n\nThis change has not been tested on real hardware.\n\nReported-and-tested-by:\
  \ syzbot+d7e968426f644b567e31@syzkaller.appspotmail.com\nCloses: https://syzkaller.appspot.com/bug?extid=d7e968426f644b567e31\n\
  Fixes: 1da177e4c3f4 (\"Linux-2.6.12-rc2\")\nCc: stable@vger.kernel.org\nSigned-off-by:\
  \ Nikita Zhandarovich <n.zhandarovich@fintech.ru>\nLink: https://patch.msgid.link/20250124093020.234642-1-n.zhandarovich@fintech.ru\n\
  Signed-off-by: Paolo Abeni <pabeni@redhat.com>\n\n"
submodule:
- drivers/net/usb
hunk_count: 3
covered_count: 1
