id: 107dd59d1efcaf3ffca4
bug_link: https://syzkaller.appspot.com/bug?extid=107dd59d1efcaf3ffca4
title: 'INFO: task hung in io_uring_setup'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 21b55dbc0653018b8cd4513c37cbca303b0f0d50
fix_commit: 7e84e1c7566a1df470a9e1f49d3db2ce311261a4
datetime: '2020-09-30T20:32:33-06:00'
fix_commit_message: 'io_uring: allow disabling rings during the creation


  This patch adds a new IORING_SETUP_R_DISABLED flag to start the

  rings disabled, allowing the user to register restrictions,

  buffers, files, before to start processing SQEs.


  When IORING_SETUP_R_DISABLED is set, SQE are not processed and

  SQPOLL kthread is not started.


  The restrictions registration are allowed only when the rings

  are disable to prevent concurrency issue while processing SQEs.


  The rings can be enabled using IORING_REGISTER_ENABLE_RINGS

  opcode with io_uring_register(2).


  Suggested-by: Jens Axboe <axboe@kernel.dk>

  Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>

  Reviewed-by: Kees Cook <keescook@chromium.org>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
- include/uapi/linux
hunk_count: 13
covered_count: 5
