id: 9369930ca44f29e60e2d
bug_link: https://syzkaller.appspot.com/bug?extid=9369930ca44f29e60e2d
title: 'KASAN: null-ptr-deref Read in xattr_getsecurity'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2236d4d39035b9839944603ec4b65ce71180a9ea
fix_commit: 1f5781725dcbb026438e77091c91a94f678c3522
datetime: '2018-04-10T19:17:41-05:00'
fix_commit_message: 'commoncap: Handle memory allocation failure.


  syzbot is reporting NULL pointer dereference at xattr_getsecurity() [1],

  for cap_inode_getsecurity() is returning sizeof(struct vfs_cap_data) when

  memory allocation failed. Return -ENOMEM if memory allocation failed.


  [1] https://syzkaller.appspot.com/bug?id=a55ba438506fe68649a5f50d2d82d56b365e0107


  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Fixes: 8db6c34f1dbc8e06 ("Introduce v3 namespaced file capabilities")

  Reported-by: syzbot <syzbot+9369930ca44f29e60e2d@syzkaller.appspotmail.com>

  Cc: stable <stable@vger.kernel.org> # 4.14+

  Acked-by: Serge E. Hallyn <serge@hallyn.com>

  Acked-by: James Morris <james.morris@microsoft.com>

  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>

  '
submodule:
- security
hunk_count: 1
covered_count: 0
