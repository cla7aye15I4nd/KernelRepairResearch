id: dcd3e13cf4472f2e0ba1
bug_link: https://syzkaller.appspot.com/bug?extid=dcd3e13cf4472f2e0ba1
title: memory leak in mld_newpack
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6052a4c11fd893234e085edf7bf2e00a33a79d4e
fix_commit: a43206156263fbaf1f2b7f96257441f331e91bb7
datetime: '2022-09-26T11:23:22-07:00'
fix_commit_message: 'usbnet: Fix memory leak in usbnet_disconnect()


  Currently usbnet_disconnect() unanchors and frees all deferred URBs

  using usb_scuttle_anchored_urbs(), which does not free urb->context,

  causing a memory leak as reported by syzbot.


  Use a usb_get_from_anchor() while loop instead, similar to what we did

  in commit 19cfe912c37b ("Bluetooth: btusb: Fix memory leak in

  play_deferred").  Also free urb->sg.


  Reported-and-tested-by: syzbot+dcd3e13cf4472f2e0ba1@syzkaller.appspotmail.com

  Fixes: 69ee472f2706 ("usbnet & cdc-ether: Autosuspend for online devices")

  Fixes: 638c5115a794 ("USBNET: support DMA SG")

  Signed-off-by: Peilin Ye <peilin.ye@bytedance.com>

  Link: https://lore.kernel.org/r/20220923042551.2745-1-yepeilin.cs@gmail.com

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- drivers/net/usb
hunk_count: 2
covered_count: 0
