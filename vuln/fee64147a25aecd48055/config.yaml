id: fee64147a25aecd48055
bug_link: https://syzkaller.appspot.com/bug?extid=fee64147a25aecd48055
title: general protection fault in skb_segment
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7c68d1a6b4db9012790af7ac0f0fdc0d2083422a
fix_commit: 121d57af308d0cf943f08f4738d24d3966c38cd9
datetime: '2018-01-22T16:01:30-05:00'
fix_commit_message: 'gso: validate gso_type in GSO handlers


  Validate gso_type during segmentation as SKB_GSO_DODGY sources

  may pass packets where the gso_type does not match the contents.


  Syzkaller was able to enter the SCTP gso handler with a packet of

  gso_type SKB_GSO_TCPV4.


  On entry of transport layer gso handlers, verify that the gso_type

  matches the transport protocol.


  Fixes: 90017accff61 ("sctp: Add GSO support")

  Link: http://lkml.kernel.org/r/<001a1137452496ffc305617e5fe0@google.com>

  Reported-by: syzbot+fee64147a25aecd48055@syzkaller.appspotmail.com

  Signed-off-by: Willem de Bruijn <willemb@google.com>

  Acked-by: Jason Wang <jasowang@redhat.com>

  Reviewed-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/ipv4
- net/ipv6
- net/sctp
hunk_count: 7
covered_count: 1
