id: 11c342e5e30e9539cabd
bug_link: https://syzkaller.appspot.com/bug?extid=11c342e5e30e9539cabd
title: WARNING in ieee80211_vif_release_channel (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 60ec7fcfe76892a1479afab51ff17a4281923156
fix_commit: 87a270625a89fc841f1a7e21aae6176543d8385c
datetime: '2021-12-20T11:33:23+00:00'
fix_commit_message: 'mac80211: fix locking in ieee80211_start_ap error path


  We need to hold the local->mtx to release the channel context,

  as even encoded by the lockdep_assert_held() there. Fix it.


  Cc: stable@vger.kernel.org

  Fixes: 295b02c4be74 ("mac80211: Add FILS discovery support")

  Reported-and-tested-by: syzbot+11c342e5e30e9539cabd@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20211220090836.cee3d59a1915.I36bba9b79dc2ff4d57c3c7aa30dff9a003fe8c5c@changeid

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/mac80211
hunk_count: 1
covered_count: 1
