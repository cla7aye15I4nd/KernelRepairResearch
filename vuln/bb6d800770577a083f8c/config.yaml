id: bb6d800770577a083f8c
bug_link: https://syzkaller.appspot.com/bug?extid=bb6d800770577a083f8c
title: 'INFO: task hung in fuse_reverse_inval_entry'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 63825b4e1da5a3cba79d835a5925e5daf7db3a77
fix_commit: c59fd85e4fd07fdf0ab523a5e9734f5338d6aa19
datetime: '2018-09-28T16:43:23+02:00'
fix_commit_message: 'fuse: change interrupt requests allocation algorithm


  Using of two unconnected IDs req->in.h.unique and req->intr_unique does not

  allow to link requests to a hash table. We need can''t use none of them as a

  key to calculate hash.


  This patch changes the algorithm of allocation of IDs for a request. Plain

  requests obtain even ID, while interrupt requests are encoded in the low

  bit. So, in next patches we will be able to use the rest of ID bits to

  calculate hash, and the hash will be the same for plain and interrupt

  requests.


  Signed-off-by: Kirill Tkhai <ktkhai@virtuozzo.com>

  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  '
submodule:
- fs/fuse
hunk_count: 3
covered_count: 1
