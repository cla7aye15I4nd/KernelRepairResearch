id: 3ab78ff125b7979e45f9
bug_link: https://syzkaller.appspot.com/bug?extid=3ab78ff125b7979e45f9
title: general protection fault in bpf_get_attach_cookie_tracing
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2884dc7d08d98a89d8d65121524bb7533183a63a
fix_commit: d0d1df8ba18abc57f28fb3bc053b2bf319367f2c
datetime: '2024-06-05T09:41:33+02:00'
fix_commit_message: 'bpf: Set run context for rawtp test_run callback


  syzbot reported crash when rawtp program executed through the

  test_run interface calls bpf_get_attach_cookie helper or any

  other helper that touches task->bpf_ctx pointer.


  Setting the run context (task->bpf_ctx pointer) for test_run

  callback.


  Fixes: 7adfc6c9b315 ("bpf: Add bpf_get_attach_cookie() BPF helper to access bpf_cookie
  value")

  Reported-by: syzbot+3ab78ff125b7979e45f9@syzkaller.appspotmail.com

  Signed-off-by: Jiri Olsa <jolsa@kernel.org>

  Signed-off-by: Andrii Nakryiko <andrii@kernel.org>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Closes: https://syzkaller.appspot.com/bug?extid=3ab78ff125b7979e45f9

  Link: https://lore.kernel.org/bpf/20240604150024.359247-1-jolsa@kernel.org

  '
submodule:
- net/bpf
hunk_count: 1
covered_count: 1
