id: 675c45cea768b3819803
bug_link: https://syzkaller.appspot.com/bug?extid=675c45cea768b3819803
title: general protection fault in gcmaes_crypt_by_sg (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 5c5d22a750d4bcf35e9539dccec397b0edcce176
fix_commit: db885e66d268884dc72967279b7e84f522556abc
datetime: '2020-01-10T11:20:46-08:00'
fix_commit_message: 'net/tls: fix async operation


  Mallesham reports the TLS with async accelerator was broken by

  commit d10523d0b3d7 ("net/tls: free the record on encryption error")

  because encryption can return -EINPROGRESS in such setups, which

  should not be treated as an error.


  The error is also present in the BPF path (likely copied from there).


  Reported-by: Mallesham Jatharakonda <mallesham.jatharakonda@oneconvergence.com>

  Fixes: d3b18ad31f93 ("tls: add bpf support to sk_msg handling")

  Fixes: d10523d0b3d7 ("net/tls: free the record on encryption error")

  Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>

  Reviewed-by: Simon Horman <simon.horman@netronome.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/tls
hunk_count: 2
covered_count: 0
