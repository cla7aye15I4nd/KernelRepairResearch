id: 48804b87c16588ad491d
bug_link: https://syzkaller.appspot.com/bug?extid=48804b87c16588ad491d
title: 'KASAN: use-after-free Read in sock_i_ino'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e65a9e480e91ddf9e15155454d370cead64689c8
fix_commit: 0a3b8b2b215f9e84b82ae97df71292ccfd92b1e7
datetime: '2018-09-05T22:14:00-07:00'
fix_commit_message: 'tipc: orphan sock in tipc_release()


  Before we unlock the sock in tipc_release(), we have to

  detach sk->sk_socket from sk, otherwise a parallel

  tipc_sk_fill_sock_diag() could stil read it after we

  free this socket.


  Fixes: c30b70deb5f4 ("tipc: implement socket diagnostics for AF_TIPC")

  Reported-and-tested-by: syzbot+48804b87c16588ad491d@syzkaller.appspotmail.com

  Cc: Jon Maloy <jon.maloy@ericsson.com>

  Cc: Ying Xue <ying.xue@windriver.com>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Acked-by: Ying Xue <ying.xue@windriver.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/tipc
hunk_count: 1
covered_count: 0
