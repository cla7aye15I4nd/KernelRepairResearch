id: f69287fa1bf99c7c3321
bug_link: https://syzkaller.appspot.com/bug?extid=f69287fa1bf99c7c3321
title: WARNING in fuse_write_file_get (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 20121d3f58f06e977ca43eb6efe1fb23b1d2f6d9
fix_commit: 184429a17f8ffc9e188dee9a4459165014025e71
datetime: '2024-10-21T10:02:51+02:00'
fix_commit_message: 'Revert "fuse: move initialization of fuse_file to fuse_writepages()
  instead of in callback"


  This reverts commit 672c3b7457fcee9656c36a29a4b21ec4a652433e.


  fuse_writepages() might be called with no dirty pages after all writable

  opens were closed.  In this case __fuse_write_file_get() will return NULL

  which will trigger the WARNING.


  The exact conditions under which this is triggered is unclear and syzbot

  didn''t find a reproducer yet.


  Reported-by: syzbot+217a976dc26ef2fa8711@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/all/CAJnrk1aQwfvb51wQ5rUSf9N8j1hArTFeSkHqC_3T-mU6_BCD=A@mail.gmail.com/

  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  '
submodule:
- fs/fuse
hunk_count: 4
covered_count: 3
