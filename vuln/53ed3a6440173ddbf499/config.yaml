id: 53ed3a6440173ddbf499
bug_link: https://syzkaller.appspot.com/bug?extid=53ed3a6440173ddbf499
title: WARNING in __nf_unregister_net_hook (8)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9d74da1177c800eb3d51c13f9821b7b0683845a5
fix_commit: 688c15017d5cd5aac882400782e7213d40dc3556
datetime: '2025-04-02T22:51:08+02:00'
fix_commit_message: 'netfilter: nf_tables: don''t unregister hook when table is dormant


  When nf_tables_updchain encounters an error, hook registration needs to

  be rolled back.


  This should only be done if the hook has been registered, which won''t

  happen when the table is flagged as dormant (inactive).


  Just move the assignment into the registration block.


  Reported-by: syzbot+53ed3a6440173ddbf499@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=53ed3a6440173ddbf499

  Fixes: b9703ed44ffb ("netfilter: nf_tables: support for adding new devices to an
  existing netdev chain")

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 1
covered_count: 0
