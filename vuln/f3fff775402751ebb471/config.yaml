id: f3fff775402751ebb471
bug_link: https://syzkaller.appspot.com/bug?extid=f3fff775402751ebb471
title: 'UBSAN: shift-out-of-bounds in ocfs2_fill_super'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d994c238347d7ba4de15da00985e1bea75e91dc7
fix_commit: 7f86b2942791012ac7b4c481d1f84a58fd2fbcfc
datetime: '2024-09-01T20:43:38-07:00'
fix_commit_message: 'ocfs2: fix shift-out-of-bounds UBSAN bug in ocfs2_verify_volume()


  This patch addresses a shift-out-of-bounds error in the

  ocfs2_verify_volume() function, identified by UBSAN.  The bug was

  triggered by an invalid s_clustersize_bits value (e.g., 1548), which

  caused the expression "1 <<

  le32_to_cpu(di->id2.i_super.s_clustersize_bits)" to exceed the limits of a

  32-bit integer, leading to an out-of-bounds shift.


  Link: https://lkml.kernel.org/r/ZsPvwQAXd5R/jNY+@hostname

  Signed-off-by: Qasim Ijaz <qasdev00@gmail.com>

  Reported-by: syzbot <syzbot+f3fff775402751ebb471@syzkaller.appspotmail.com>

  Closes: https://syzkaller.appspot.com/bug?extid=f3fff775402751ebb471

  Tested-by: syzbot <syzbot+f3fff775402751ebb471@syzkaller.appspotmail.com>

  Reviewed-by: Joseph Qi <joseph.qi@linux.alibaba.com>

  Cc: Mark Fasheh <mark@fasheh.com>

  Cc: Joel Becker <jlbec@evilplan.org>

  Cc: Junxiao Bi <junxiao.bi@oracle.com>

  Cc: Changwei Ge <gechangwei@live.cn>

  Cc: Gang He <ghe@suse.com>

  Cc: Jun Piao <piaojun@huawei.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- fs/ocfs2
hunk_count: 1
covered_count: 1
