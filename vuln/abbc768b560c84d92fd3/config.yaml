id: abbc768b560c84d92fd3
bug_link: https://syzkaller.appspot.com/bug?extid=abbc768b560c84d92fd3
title: 'KMSAN: uninit-value in batadv_hard_if_event (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 017512a07e15b66472946cf5e6f4b4511e7cf898
fix_commit: f45a4248ea4cc13ed50618ff066849f9587226b2
datetime: '2020-10-06T06:10:21-07:00'
fix_commit_message: 'net: usb: rtl8150: set random MAC address when set_ethernet_addr()
  fails


  When get_registers() fails in set_ethernet_addr(),the uninitialized

  value of node_id gets copied over as the address.

  So, check the return value of get_registers().


  If get_registers() executed successfully (i.e., it returns

  sizeof(node_id)), copy over the MAC address using ether_addr_copy()

  (instead of using memcpy()).


  Else, if get_registers() failed instead, a randomly generated MAC

  address is set as the MAC address instead.


  Reported-by: syzbot+abbc768b560c84d92fd3@syzkaller.appspotmail.com

  Tested-by: syzbot+abbc768b560c84d92fd3@syzkaller.appspotmail.com

  Acked-by: Petko Manolov <petkan@nucleusys.com>

  Signed-off-by: Anant Thazhemadam <anant.thazhemadam@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net/usb
hunk_count: 1
covered_count: 1
