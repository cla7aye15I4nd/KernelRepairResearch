id: e74a998ca8f1df9cc332
bug_link: https://syzkaller.appspot.com/bug?extid=e74a998ca8f1df9cc332
title: WARNING in pvr2_i2c_core_done
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 8edcb5049ac29aa3c8acc5ef15dd4036543d747e
fix_commit: f8194e5e63fdcb349e8da9eef9e574d5b1d687cb
datetime: '2021-05-19T09:51:39+02:00'
fix_commit_message: "media: pvrusb2: fix warning in pvr2_i2c_core_done\n\nsyzbot has\
  \ reported the following warning in pvr2_i2c_done:\n\n\tsysfs group 'power' not\
  \ found for kobject '1-0043'\n\nWhen the device is disconnected (pvr_hdw_disconnect),\
  \ the i2c adapter is\nnot unregistered along with the USB and v4l2 teardown. As\
  \ part of the USB\ndevice disconnect, the sysfs files of the subdevices are also\
  \ deleted.\nSo, by the time pvr_i2c_core_done is called by pvr_context_destroy,\
  \ the\nsysfs files have been deleted.\n\nTo fix this, unregister the i2c adapter\
  \ too in pvr_hdw_disconnect. Make\nthe device deregistration code shared by calling\
  \ pvr_hdw_disconnect from\npvr2_hdw_destroy.\n\nReported-by: syzbot+e74a998ca8f1df9cc332@syzkaller.appspotmail.com\n\
  Tested-by: syzbot+e74a998ca8f1df9cc332@syzkaller.appspotmail.com\nReviewed-by: Greg\
  \ Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Anirudh Rayabharam\
  \ <mail@anirudhrb.com>\nSigned-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>\n\
  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>\n"
submodule:
- drivers/media/usb/pvrusb2
hunk_count: 2
covered_count: 2
