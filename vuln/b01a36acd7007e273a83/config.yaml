id: b01a36acd7007e273a83
bug_link: https://syzkaller.appspot.com/bug?extid=b01a36acd7007e273a83
title: WARNING in f2fs_unlink
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 201e07aec617b10360df09090651dea9d0d4f7d3
fix_commit: 81edb983b3f5d6900d3e337b9af7b1bec4bef0f2
datetime: '2025-02-28T16:31:06+00:00'
fix_commit_message: 'f2fs: add check for deleted inode


  The syzbot reproducer mounts a f2fs image, then tries to unlink an

  existing file. However, the unlinked file already has a link count of 0

  when it is read for the first time in do_read_inode().


  Add a check to sanity_check_inode() for i_nlink == 0.


  [Chao Yu: rebase the code and fix orphan inode recovery issue]

  Reported-by: syzbot+b01a36acd7007e273a83@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=b01a36acd7007e273a83

  Fixes: 39a53e0ce0df ("f2fs: add superblock and major in-memory structure")

  Signed-off-by: Leo Stone <leocstone@gmail.com>

  Signed-off-by: Chao Yu <chao@kernel.org>

  Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>

  '
submodule:
- fs/f2fs
hunk_count: 1
covered_count: 0
