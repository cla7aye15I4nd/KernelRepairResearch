id: 05d673e83ec640f0ced9
bug_link: https://syzkaller.appspot.com/bug?extid=05d673e83ec640f0ced9
title: 'BUG: corrupted list in ring_buffer_subbuf_order_set'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a9d0aab5eb33a44792a66b7af13ff50d7b3e7022
fix_commit: 40ee2afafc1d9fe3aa44a6fbe440d78a5c96a72e
datetime: '2025-06-06T20:25:55-04:00'
fix_commit_message: 'ring-buffer: Fix buffer locking in ring_buffer_subbuf_order_set()


  Enlarge the critical section in ring_buffer_subbuf_order_set() to

  ensure that error handling takes place with per-buffer mutex held,

  thus preventing list corruption and other concurrency-related issues.


  Cc: stable@vger.kernel.org

  Cc: Masami Hiramatsu <mhiramat@kernel.org>

  Cc: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>

  Cc: Tzvetomir Stoyanov <tz.stoyanov@gmail.com>

  Link: https://lore.kernel.org/20250606112242.1510605-1-dmantipov@yandex.ru

  Reported-by: syzbot+05d673e83ec640f0ced9@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=05d673e83ec640f0ced9

  Fixes: f9b94daa542a8 ("ring-buffer: Set new size of the ring buffer sub page")

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Signed-off-by: Steven Rostedt (Google) <rostedt@goodmis.org>

  '
submodule:
- kernel/trace
hunk_count: 3
covered_count: 2
