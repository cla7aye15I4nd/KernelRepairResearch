id: 38d72234503f2b05981f
bug_link: https://syzkaller.appspot.com/bug?extid=38d72234503f2b05981f
title: 'upstream test error: BUG: unable to handle kernel NULL pointer dereference
  in msix_capability_init'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dce3ab4c57e662ae019c22e7c2f2aa887617beae
fix_commit: 3ece3e8e5976c49c3f887e5923f998eabd54ff40
datetime: '2025-03-26T15:28:43+01:00'
fix_commit_message: "PCI/MSI: Handle the NOMASK flag correctly for all PCI/MSI backends\n\
  \nThe conversion of the XEN specific global variable pci_msi_ignore_mask to a\n\
  MSI domain flag, missed the facts that:\n\n    1) Legacy architectures do not provide\
  \ a interrupt domain\n    2) Parent MSI domains do not necessarily have a domain\
  \ info attached\n   \nBoth cases result in an unconditional NULL pointer dereference.\
  \ This was\nunfortunatly missed in review and testing revealed it late.\n\nCure\
  \ this by using the existing pci_msi_domain_supports() helper, which\nhandles all\
  \ possible cases correctly.\n\nFixes: c3164d2e0d18 (\"PCI/MSI: Convert pci_msi_ignore_mask\
  \ to per MSI domain flag\")\nReported-by: Daniel Gomez <da.gomez@kernel.org>\nReported-by:\
  \ Borislav Petkov <bp@alien8.de>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\n\
  Reviewed-by: Juergen Gross <jgross@suse.com>\nTested-by: Marek Szyprowski <m.szyprowski@samsung.com>\n\
  Tested-by: Borislav Petkov <bp@alien8.de>\nTested-by: Daniel Gomez <da.gomez@kernel.org>\n\
  Link: https://lore.kernel.org/all/87iknwyp2o.ffs@tglx\nCloses: https://lore.kernel.org/all/qn7fzggcj6qe6r6gdbwcz23pzdz2jx64aldccmsuheabhmjgrt@tawf5nfwuvw7\n"
submodule:
- drivers/pci/msi
hunk_count: 5
covered_count: 3
