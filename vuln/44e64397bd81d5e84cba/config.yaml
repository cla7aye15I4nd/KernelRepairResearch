id: 44e64397bd81d5e84cba
bug_link: https://syzkaller.appspot.com/bug?extid=44e64397bd81d5e84cba
title: memory leak in hub_event
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2b006e748c81da1b32029257d003f9b2af7435a5
fix_commit: e469d0b09a19496e1972a20974bbf55b728151eb
datetime: '2020-12-07T15:00:15+01:00'
fix_commit_message: 'media: gspca: Fix memory leak in probe


  The gspca driver leaks memory when a probe fails.  gspca_dev_probe2()

  calls v4l2_device_register(), which takes a reference to the

  underlying device node (in this case, a USB interface).  But the

  failure pathway neglects to call v4l2_device_unregister(), the routine

  responsible for dropping this reference.  Consequently the memory for

  the USB interface and its device never gets released.


  This patch adds the missing function call.


  Reported-and-tested-by: syzbot+44e64397bd81d5e84cba@syzkaller.appspotmail.com


  Signed-off-by: Alan Stern <stern@rowland.harvard.edu>

  CC: <stable@vger.kernel.org>

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

  '
submodule:
- drivers/media/usb/gspca
hunk_count: 1
covered_count: 0
