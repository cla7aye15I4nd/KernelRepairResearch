id: b3bcd80232d00091e061
bug_link: https://syzkaller.appspot.com/bug?extid=b3bcd80232d00091e061
title: 'KMSAN: uninit-value in nsim_get_ringparam'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3b1af76604398c12cf6e54a5587cc61566680ca3
fix_commit: 6db9d3a536cd638e2ee17cf880e14026cec19d26
datetime: '2025-01-27T14:37:11-08:00'
fix_commit_message: "netdevsim: don't assume core pre-populates HDS params on GET\n\
  \nSyzbot reports:\n\n  BUG: KMSAN: uninit-value in nsim_get_ringparam+0xa8/0xe0\
  \ drivers/net/netdevsim/ethtool.c:77\n   nsim_get_ringparam+0xa8/0xe0 drivers/net/netdevsim/ethtool.c:77\n\
  \   ethtool_set_ringparam+0x268/0x570 net/ethtool/ioctl.c:2072\n   __dev_ethtool\
  \ net/ethtool/ioctl.c:3209 [inline]\n   dev_ethtool+0x126d/0x2a40 net/ethtool/ioctl.c:3398\n\
  \   dev_ioctl+0xb0e/0x1280 net/core/dev_ioctl.c:759\n\nThis is the SET path, where\
  \ we call GET to either check user request\nagainst max values, or check if any\
  \ of the settings will change.\n\nThe logic in netdevsim is trying to report the\
  \ default (ENABLED)\nif user has not requested any specific setting. The user setting\n\
  is recorded in dev->cfg, don't depend on kernel_ringparam being\npre-populated with\
  \ it.\n\nFixes: 928459bbda19 (\"net: ethtool: populate the default HDS params in\
  \ the core\")\nReported-by: Eric Dumazet <edumazet@google.com>\nReported-by: syzbot+b3bcd80232d00091e061@syzkaller.appspotmail.com\n\
  Tested-by: syzbot+b3bcd80232d00091e061@syzkaller.appspotmail.com\nLink: https://patch.msgid.link/20250123221410.1067678-1-kuba@kernel.org\n\
  Signed-off-by: Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- drivers/net/netdevsim
hunk_count: 1
covered_count: 1
