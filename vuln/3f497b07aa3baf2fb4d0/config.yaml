id: 3f497b07aa3baf2fb4d0
bug_link: https://syzkaller.appspot.com/bug?extid=3f497b07aa3baf2fb4d0
title: 'KMSAN: uninit-value in __nla_validate_parse (3)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 661779e1fcafe1b74b3f3fe8e980c1e207fea1fd
fix_commit: 9a0d18853c280f6a0ee99f91619f2442a17a323a
datetime: '2024-02-22T19:01:55-08:00'
fix_commit_message: "netlink: add nla be16/32 types to minlen array\n\nBUG: KMSAN:\
  \ uninit-value in nla_validate_range_unsigned lib/nlattr.c:222 [inline]\nBUG: KMSAN:\
  \ uninit-value in nla_validate_int_range lib/nlattr.c:336 [inline]\nBUG: KMSAN:\
  \ uninit-value in validate_nla lib/nlattr.c:575 [inline]\nBUG: KMSAN: uninit-value\
  \ in __nla_validate_parse+0x2e20/0x45c0 lib/nlattr.c:631\n nla_validate_range_unsigned\
  \ lib/nlattr.c:222 [inline]\n nla_validate_int_range lib/nlattr.c:336 [inline]\n\
  \ validate_nla lib/nlattr.c:575 [inline]\n...\n\nThe message in question matches\
  \ this policy:\n\n [NFTA_TARGET_REV]       = NLA_POLICY_MAX(NLA_BE32, 255),\n\n\
  but because NLA_BE32 size in minlen array is 0, the validation\ncode will read past\
  \ the malformed (too small) attribute.\n\nNote: Other attributes, e.g. BITFIELD32,\
  \ SINT, UINT.. are also missing:\nthose likely should be added too.\n\nReported-by:\
  \ syzbot+3f497b07aa3baf2fb4d0@syzkaller.appspotmail.com\nReported-by: xingwei lee\
  \ <xrivendell7@gmail.com>\nCloses: https://lore.kernel.org/all/CABOYnLzFYHSnvTyS6zGa-udNX55+izqkOt2sB9WDqUcEGW6n8w@mail.gmail.com/raw\n\
  Fixes: ecaf75ffd5f5 (\"netlink: introduce bigendian integer types\")\nSigned-off-by:\
  \ Florian Westphal <fw@strlen.de>\nLink: https://lore.kernel.org/r/20240221172740.5092-1-fw@strlen.de\n\
  Signed-off-by: Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- lib
hunk_count: 2
covered_count: 2
