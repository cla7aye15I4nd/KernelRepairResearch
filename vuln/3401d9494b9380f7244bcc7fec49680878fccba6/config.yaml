id: 3401d9494b9380f7244bcc7fec49680878fccba6
bug_link: https://syzkaller.appspot.com/bug?extid=3401d9494b9380f7244bcc7fec49680878fccba6
title: general protection fault in blkcipher_walk_done
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2b4f27c36bcd46e820ddb9a8e6fe6a63fa4250b8
fix_commit: 11edb555966ed2c66c533d17c604f9d7e580a829
datetime: '2017-12-11T22:29:54+11:00'
fix_commit_message: 'crypto: af_alg - wait for data at beginning of recvmsg


  The wait for data is a non-atomic operation that can sleep and therefore

  potentially release the socket lock. The release of the socket lock

  allows another thread to modify the context data structure. The waiting

  operation for new data therefore must be called at the beginning of

  recvmsg. This prevents a race condition where checks of the members of

  the context data structure are performed by recvmsg while there is a

  potential for modification of these values.


  Fixes: e870456d8e7c ("crypto: algif_skcipher - overhaul memory management")

  Fixes: d887c52d6ae4 ("crypto: algif_aead - overhaul memory management")

  Reported-by: syzbot <syzkaller@googlegroups.com>

  Cc: <stable@vger.kernel.org> # v4.14+

  Signed-off-by: Stephan Mueller <smueller@chronox.de>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 3
covered_count: 0
