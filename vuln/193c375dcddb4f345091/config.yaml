id: 193c375dcddb4f345091
bug_link: https://syzkaller.appspot.com/bug?extid=193c375dcddb4f345091
title: memory leak in nfs_fs_context_parse_monolithic
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1821b26a1fed8fca57a96ef87bac7a6a48e78815
fix_commit: 75a9b9176157f3095d3099adf512b5a233addbc7
datetime: '2020-02-25T13:48:21-05:00'
fix_commit_message: 'NFS: Fix leak of ctx->nfs_server.hostname


  If userspace passes an nfs_mount_data struct in the data argument of

  mount(2), then nfs23_parse_monolithic() or nfs4_parse_monolithic()

  will allocate memory for ctx->nfs_server.hostname.  This needs to be

  freed in nfs_parse_source(), which also allocates memory for

  ctx->nfs_server.hostname, otherwise a leak will occur.


  Reported-by: syzbot+193c375dcddb4f345091@syzkaller.appspotmail.com

  Fixes: f2aedb713c28 ("NFS: Add fs_context support.")

  Signed-off-by: Scott Mayhew <smayhew@redhat.com>

  Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>

  '
submodule:
- fs/nfs
hunk_count: 1
covered_count: 0
