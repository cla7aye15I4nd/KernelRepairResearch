id: fbb3e0b24e8dae5a16ee
bug_link: https://syzkaller.appspot.com/bug?extid=fbb3e0b24e8dae5a16ee
title: WARNING in nilfs_segctor_do_construct
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ef79361b265dd229725ad62bc850f6913ef2f94a
fix_commit: 723ac751208f6d6540191689cfbf6c77135a7a1b
datetime: '2022-10-11T18:51:10-07:00'
fix_commit_message: 'nilfs2: replace WARN_ONs by nilfs_error for checkpoint acquisition
  failure


  If creation or finalization of a checkpoint fails due to anomalies in the

  checkpoint metadata on disk, a kernel warning is generated.


  This patch replaces the WARN_ONs by nilfs_error, so that a kernel, booted

  with panic_on_warn, does not panic.  A nilfs_error is appropriate here to

  handle the abnormal filesystem condition.


  This also replaces the detected error codes with an I/O error so that

  neither of the internal error codes is returned to callers.


  Link: https://lkml.kernel.org/r/20220929123330.19658-1-konishi.ryusuke@gmail.com

  Signed-off-by: Ryusuke Konishi <konishi.ryusuke@gmail.com>

  Reported-by: syzbot+fbb3e0b24e8dae5a16ee@syzkaller.appspotmail.com

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- fs/nilfs2
hunk_count: 2
covered_count: 0
