id: 3b6b32dc50537a49bb4a
bug_link: https://syzkaller.appspot.com/bug?extid=3b6b32dc50537a49bb4a
title: 'KCSAN: data-race in __ep_remove / __fput (5)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 05fba0a11557dfdc1b6895f4a3fb59165669e643
fix_commit: 6474353a5e3d0b2cf610153cea0c61f576a36d0a
datetime: '2024-10-22T11:16:56+02:00'
fix_commit_message: 'epoll: annotate racy check


  Epoll relies on a racy fastpath check during __fput() in

  eventpoll_release() to avoid the hit of pointlessly acquiring a

  semaphore. Annotate that race by using WRITE_ONCE() and READ_ONCE().


  Link: https://lore.kernel.org/r/66edfb3c.050a0220.3195df.001a.GAE@google.com

  Link: https://lore.kernel.org/r/20240925-fungieren-anbauen-79b334b00542@brauner

  Reviewed-by: Jan Kara <jack@suse.cz>

  Reported-by: syzbot+3b6b32dc50537a49bb4a@syzkaller.appspotmail.com

  Signed-off-by: Christian Brauner <brauner@kernel.org>

  '
submodule:
- fs
- include/linux
hunk_count: 3
covered_count: 2
