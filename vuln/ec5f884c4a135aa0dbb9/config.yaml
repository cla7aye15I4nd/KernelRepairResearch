id: ec5f884c4a135aa0dbb9
bug_link: https://syzkaller.appspot.com/bug?extid=ec5f884c4a135aa0dbb9
title: 'INFO: rcu detected stall in hub_event'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2a770b49b1bf00fca5473cb386eaf36d21d17d4b
fix_commit: 64f2657b579343cf923aa933f08074e6258eb07b
datetime: '2025-01-09T10:07:28+01:00'
fix_commit_message: "HID: core: Fix assumption that Resolution Multipliers must be\
  \ in Logical Collections\n\nA report in 2019 by the syzbot fuzzer was found to be\
  \ connected to two\nerrors in the HID core associated with Resolution Multipliers.\
  \  One of\nthe errors was fixed by commit ea427a222d8b (\"HID: core: Fix deadloop\n\
  in hid_apply_multiplier.\"), but the other has not been fixed.\n\nThis error arises\
  \ because hid_apply_multipler() assumes that every\nResolution Multiplier control\
  \ is contained in a Logical Collection,\ni.e., there's no way the routine can ever\
  \ set multiplier_collection to\nNULL.  This is in spite of the fact that the function\
  \ starts with a\nbig comment saying:\n\n\t * \"The Resolution Multiplier control\
  \ must be contained in the same\n\t * Logical Collection as the control(s) to which\
  \ it is to be applied.\n\t   ...\n\t *  If no Logical Collection is\n\t * defined,\
  \ the Resolution Multiplier is associated with all\n\t * controls in the report.\"\
  \n\t * HID Usage Table, v1.12, Section 4.3.1, p30\n\t *\n\t * Thus, search from\
  \ the current collection upwards until we find a\n\t * logical collection...\n\n\
  The comment and the code overlook the possibility that none of the\ncollections\
  \ found may be a Logical Collection.\n\nThe fix is to set the multiplier_collection\
  \ pointer to NULL if the\ncollection found isn't a Logical Collection.\n\nReported-by:\
  \ syzbot+ec5f884c4a135aa0dbb9@syzkaller.appspotmail.com\nCloses: https://lore.kernel.org/all/000000000000109c040597dc5843@google.com/\n\
  Signed-off-by: Alan Stern <stern@rowland.harvard.edu>\nCc: Peter Hutterer <peter.hutterer@who-t.net>\n\
  Fixes: 5a4abb36f312 (\"HID: core: process the Resolution Multiplier\")\nCc: stable@vger.kernel.org\n\
  Signed-off-by: Jiri Kosina <jkosina@suse.com>\n"
submodule:
- drivers/hid
hunk_count: 1
covered_count: 0
