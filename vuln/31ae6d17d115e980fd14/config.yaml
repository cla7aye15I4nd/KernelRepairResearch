id: 31ae6d17d115e980fd14
bug_link: https://syzkaller.appspot.com/bug?extid=31ae6d17d115e980fd14
title: 'INFO: task hung in usb_get_descriptor'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bd8b82042269a95db48074b8bb400678dbac1815
fix_commit: 363eaa3a450abb4e63bd6e3ad79d1f7a0f717814
datetime: '2021-04-05T09:05:42+02:00'
fix_commit_message: 'usbip: synchronize event handler with sysfs code paths


  Fuzzing uncovered race condition between sysfs code paths in usbip

  drivers. Device connect/disconnect code paths initiated through

  sysfs interface are prone to races if disconnect happens during

  connect and vice versa.


  Use sysfs_lock to synchronize event handler with sysfs paths

  in usbip drivers.


  Cc: stable@vger.kernel.org

  Reported-and-tested-by: syzbot+a93fba6d384346a761e3@syzkaller.appspotmail.com

  Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

  Link: https://lore.kernel.org/r/c5c8723d3f29dfe3d759cfaafa7dd16b0dfe2918.1616807117.git.skhan@linuxfoundation.org

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/usb/usbip
hunk_count: 2
covered_count: 0
