id: 582c98032903dcc04816
bug_link: https://syzkaller.appspot.com/bug?extid=582c98032903dcc04816
title: 'WARNING: suspicious RCU usage in bond_ipsec_add_sa'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7d25e14eb2c0f07d10815a524542cdf681cb472c
fix_commit: f548a476268d621846bb0146af861bb56250ae37
datetime: '2020-07-08T16:09:07-07:00'
fix_commit_message: 'bonding: don''t need RTNL for ipsec helpers


  The bond_ipsec_* helpers don''t need RTNL, and can potentially get called

  without it being held, so switch from rtnl_dereference() to

  rcu_dereference() to access bond struct data.


  Lightly tested with xfrm bonding, no problems found, should address the

  syzkaller bug referenced below.


  Reported-by: syzbot+582c98032903dcc04816@syzkaller.appspotmail.com

  CC: Huy Nguyen <huyn@mellanox.com>

  CC: Saeed Mahameed <saeedm@mellanox.com>

  CC: Jay Vosburgh <j.vosburgh@gmail.com>

  CC: Veaceslav Falico <vfalico@gmail.com>

  CC: Andy Gospodarek <andy@greyhouse.net>

  CC: "David S. Miller" <davem@davemloft.net>

  CC: Jeff Kirsher <jeffrey.t.kirsher@intel.com>

  CC: Jakub Kicinski <kuba@kernel.org>

  CC: Steffen Klassert <steffen.klassert@secunet.com>

  CC: Herbert Xu <herbert@gondor.apana.org.au>

  CC: netdev@vger.kernel.org

  CC: intel-wired-lan@lists.osuosl.org

  Signed-off-by: Jarod Wilson <jarod@redhat.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net/bonding
hunk_count: 3
covered_count: 3
