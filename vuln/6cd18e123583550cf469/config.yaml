id: 6cd18e123583550cf469
bug_link: https://syzkaller.appspot.com/bug?extid=6cd18e123583550cf469
title: 'WARNING: locking bug in umh_complete'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ceaa837f96adb69c0df0397937cd74991d5d821a
fix_commit: eedeb787ebb53de5c5dcf7b7b39d01bf1b0f037d
datetime: '2023-02-13T16:36:14+01:00'
fix_commit_message: 'freezer,umh: Fix call_usermode_helper_exec() vs SIGKILL


  Tetsuo-San noted that commit f5d39b020809 ("freezer,sched: Rewrite

  core freezer logic") broke call_usermodehelper_exec() for the KILLABLE

  case.


  Specifically it was missed that the second, unconditional,

  wait_for_completion() was not optional and ensures the on-stack

  completion is unused before going out-of-scope.


  Fixes: f5d39b020809 ("freezer,sched: Rewrite core freezer logic")

  Reported-by: syzbot+6cd18e123583550cf469@syzkaller.appspotmail.com

  Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Debugged-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>

  Link: https://lkml.kernel.org/r/Y90ar35uKQoUrLEK@hirez.programming.kicks-ass.net

  '
submodule:
- kernel
hunk_count: 1
covered_count: 0
