id: 98fd2d1422063b0f8c44
bug_link: https://syzkaller.appspot.com/bug?extid=98fd2d1422063b0f8c44
title: 'KASAN: use-after-free Read in inet_bind2_bucket_find'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 219b51a6f040fa5367adadd7d58c4dda0896a01d
fix_commit: 593d1ebe00a45af5cb7bda1235c0790987c2a2b2
datetime: '2022-06-16T11:07:59-07:00'
fix_commit_message: 'Revert "net: Add a second bind table hashed by port and address"


  This reverts:


  commit d5a42de8bdbe ("net: Add a second bind table hashed by port and address")

  commit 538aaf9b2383 ("selftests: Add test for timing a bind request to a port with
  a populated bhash entry")

  Link: https://lore.kernel.org/netdev/20220520001834.2247810-1-kuba@kernel.org/


  There are a few things that need to be fixed here:

  * Updating bhash2 in cases where the socket''s rcv saddr changes

  * Adding bhash2 hashbucket locks


  Links to syzbot reports:

  https://lore.kernel.org/netdev/00000000000022208805e0df247a@google.com/

  https://lore.kernel.org/netdev/0000000000003f33bc05dfaf44fe@google.com/


  Fixes: d5a42de8bdbe ("net: Add a second bind table hashed by port and address")

  Reported-by: syzbot+015d756bbd1f8b5c8f09@syzkaller.appspotmail.com

  Reported-by: syzbot+98fd2d1422063b0f8c44@syzkaller.appspotmail.com

  Reported-by: syzbot+0a847a982613c6438fba@syzkaller.appspotmail.com

  Signed-off-by: Joanne Koong <joannelkoong@gmail.com>

  Link: https://lore.kernel.org/r/20220615193213.2419568-1-joannelkoong@gmail.com

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- include/net
- net/dccp
- net/ipv4
- tools/testing/selftests/net
hunk_count: 44
covered_count: 16
