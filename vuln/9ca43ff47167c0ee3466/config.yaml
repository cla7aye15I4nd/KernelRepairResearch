id: 9ca43ff47167c0ee3466
bug_link: https://syzkaller.appspot.com/bug?extid=9ca43ff47167c0ee3466
title: general protection fault in blk_mq_run_hw_queues
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 58b63e0f556c2debb8c942abcc9e6beadc4a07f0
fix_commit: 16ad3db3b24cd9f70aa24e93cef0d4a83dece7ac
datetime: '2021-07-15T09:30:15-06:00'
fix_commit_message: 'nbd: fix order of cleaning up the queue and freeing the tagset


  We must release the queue before freeing the tagset.


  Fixes: 4af5f2e03013 ("nbd: use blk_mq_alloc_disk and blk_cleanup_disk")

  Reported-and-tested-by: syzbot+9ca43ff47167c0ee3466@syzkaller.appspotmail.com

  Signed-off-by: Wang Qing <wangqing@vivo.com>

  Signed-off-by: Guoqing Jiang <jiangguoqing@kylinos.cn>

  Reviewed-by: Christoph Hellwig <hch@lst.de>

  Link: https://lore.kernel.org/r/20210706040016.1360412-1-guoqing.jiang@linux.dev

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- drivers/block
hunk_count: 1
covered_count: 1
