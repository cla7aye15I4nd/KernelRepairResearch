id: af43e647fd835acc02df
bug_link: https://syzkaller.appspot.com/bug?extid=af43e647fd835acc02df
title: WARNING in ipv6_gso_segment
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7cbd49795d4ca86fba5830084e94fece3b343b79
fix_commit: d45cf1e7d7180256e17c9ce88e32e8061a7887fe
datetime: '2025-08-01T14:40:53-07:00'
fix_commit_message: "ipv6: reject malicious packets in ipv6_gso_segment()\n\nsyzbot\
  \ was able to craft a packet with very long IPv6 extension headers\nleading to an\
  \ overflow of skb->transport_header.\n\nThis 16bit field has a limited range.\n\n\
  Add skb_reset_transport_header_careful() helper and use it\nfrom ipv6_gso_segment()\n\
  \nWARNING: CPU: 0 PID: 5871 at ./include/linux/skbuff.h:3032 skb_reset_transport_header\
  \ include/linux/skbuff.h:3032 [inline]\nWARNING: CPU: 0 PID: 5871 at ./include/linux/skbuff.h:3032\
  \ ipv6_gso_segment+0x15e2/0x21e0 net/ipv6/ip6_offload.c:151\nModules linked in:\n\
  CPU: 0 UID: 0 PID: 5871 Comm: syz-executor211 Not tainted 6.16.0-rc6-syzkaller-g7abc678e3084\
  \ #0 PREEMPT(full)\nHardware name: Google Google Compute Engine/Google Compute Engine,\
  \ BIOS Google 07/12/2025\n RIP: 0010:skb_reset_transport_header include/linux/skbuff.h:3032\
  \ [inline]\n RIP: 0010:ipv6_gso_segment+0x15e2/0x21e0 net/ipv6/ip6_offload.c:151\n\
  Call Trace:\n <TASK>\n  skb_mac_gso_segment+0x31c/0x640 net/core/gso.c:53\n  nsh_gso_segment+0x54a/0xe10\
  \ net/nsh/nsh.c:110\n  skb_mac_gso_segment+0x31c/0x640 net/core/gso.c:53\n  __skb_gso_segment+0x342/0x510\
  \ net/core/gso.c:124\n  skb_gso_segment include/net/gso.h:83 [inline]\n  validate_xmit_skb+0x857/0x11b0\
  \ net/core/dev.c:3950\n  validate_xmit_skb_list+0x84/0x120 net/core/dev.c:4000\n\
  \  sch_direct_xmit+0xd3/0x4b0 net/sched/sch_generic.c:329\n  __dev_xmit_skb net/core/dev.c:4102\
  \ [inline]\n  __dev_queue_xmit+0x17b6/0x3a70 net/core/dev.c:4679\n\nFixes: d1da932ed4ec\
  \ (\"ipv6: Separate ipv6 offload support\")\nReported-by: syzbot+af43e647fd835acc02df@syzkaller.appspotmail.com\n\
  Closes: https://lore.kernel.org/netdev/688a1a05.050a0220.5d226.0008.GAE@google.com/T/#u\n\
  Signed-off-by: Eric Dumazet <edumazet@google.com>\nReviewed-by: Dawid Osuchowski\
  \ <dawid.osuchowski@linux.intel.com>\nReviewed-by: Willem de Bruijn <willemb@google.com>\n\
  Link: https://patch.msgid.link/20250730131738.3385939-1-edumazet@google.com\nSigned-off-by:\
  \ Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- include/linux
- net/ipv6
hunk_count: 2
covered_count: 2
