id: ce3408364c4a234dd90c
bug_link: https://syzkaller.appspot.com/bug?extid=ce3408364c4a234dd90c
title: 'WARNING: locking bug in hfa384x_usbctlx_completion_task'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a111daf0c53ae91e71fd2bfe7497862d14132e3e
fix_commit: ee6c6e7342471d468096a16bee9f89b5a6c1e39d
datetime: '2022-07-01T09:58:58+02:00'
fix_commit_message: 'staging/wlan-ng: get the correct struct hfa384x in work callback


  hfa384x_usbctlx_completion_task() is bogusly using the reaper BH when

  in fact this is the completion_bh. This was reflected when trying

  to acquire the hw->ctlxq.lock and getting a failed lockdep class

  initialized to it.


  Fixes: 9442e81d7e7c ("staging/wlan-ng, prism2usb: replace completion_bh tasklet
  with work")

  Reported-by: syzbot+ce3408364c4a234dd90c@syzkaller.appspotmail.com

  Signed-off-by: Davidlohr Bueso <dave@stgolabs.net>

  Link: https://lore.kernel.org/r/20220629165225.3436822-1-dave@stgolabs.net

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/staging/wlan-ng
hunk_count: 1
covered_count: 1
