id: de4025c006ec68ac56fc
bug_link: https://syzkaller.appspot.com/bug?extid=de4025c006ec68ac56fc
title: WARNING in __nf_unregister_net_hook (6)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 40b9385dd8e6a0515e1c9cd06a277483556b7286
fix_commit: bccebf64701735533c8db37773eeacc6566cc8ec
datetime: '2024-02-22T00:14:54+01:00'
fix_commit_message: 'netfilter: nf_tables: set dormant flag on hook register failure


  We need to set the dormant flag again if we fail to register

  the hooks.


  During memory pressure hook registration can fail and we end up

  with a table marked as active but no registered hooks.


  On table/base chain deletion, nf_tables will attempt to unregister

  the hook again which yields a warn splat from the nftables core.


  Reported-and-tested-by: syzbot+de4025c006ec68ac56fc@syzkaller.appspotmail.com

  Fixes: 179d9ba5559a ("netfilter: nf_tables: fix table flag updates")

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 1
covered_count: 0
