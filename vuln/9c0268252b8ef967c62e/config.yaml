id: 9c0268252b8ef967c62e
bug_link: https://syzkaller.appspot.com/bug?extid=9c0268252b8ef967c62e
title: 'INFO: task hung in tls_sw_sendpage (3)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 49c47cc21b5b7a3d8deb18fc57b0aa2ab1286962
fix_commit: f3221361dc85d4de22586ce8441ec2c67b454f5d
datetime: '2023-03-01T20:32:36-08:00'
fix_commit_message: 'net: tls: avoid hanging tasks on the tx_lock


  syzbot sent a hung task report and Eric explains that adversarial

  receiver may keep RWIN at 0 for a long time, so we are not guaranteed

  to make forward progress. Thread which took tx_lock and went to sleep

  may not release tx_lock for hours. Use interruptible sleep where

  possible and reschedule the work if it can''t take the lock.


  Testing: existing selftest passes


  Reported-by: syzbot+9c0268252b8ef967c62e@syzkaller.appspotmail.com

  Fixes: 79ffe6087e91 ("net/tls: add a TX lock")

  Link: https://lore.kernel.org/all/000000000000e412e905f5b46201@google.com/

  Cc: stable@vger.kernel.org # wait 4 weeks

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Link: https://lore.kernel.org/r/20230301002857.2101894-1-kuba@kernel.org

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- net/tls
hunk_count: 3
covered_count: 2
