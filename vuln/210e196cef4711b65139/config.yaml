id: 210e196cef4711b65139
bug_link: https://syzkaller.appspot.com/bug?extid=210e196cef4711b65139
title: WARNING in nci_add_new_protocol
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e8b4fc13900b8e8be48debffd0dfd391772501f7
fix_commit: e329e71013c9b5a4535b099208493c7826ee4a64
datetime: '2022-12-05T17:46:25-08:00'
fix_commit_message: "NFC: nci: Bounds check struct nfc_target arrays\n\nWhile running\
  \ under CONFIG_FORTIFY_SOURCE=y, syzkaller reported:\n\n  memcpy: detected field-spanning\
  \ write (size 129) of single field \"target->sensf_res\" at net/nfc/nci/ntf.c:260\
  \ (size 18)\n\nThis appears to be a legitimate lack of bounds checking in\nnci_add_new_protocol().\
  \ Add the missing checks.\n\nReported-by: syzbot+210e196cef4711b65139@syzkaller.appspotmail.com\n\
  Link: https://lore.kernel.org/lkml/0000000000001c590f05ee7b3ff4@google.com\nFixes:\
  \ 019c4fbaa790 (\"NFC: Add NCI multiple targets support\")\nSigned-off-by: Kees\
  \ Cook <keescook@chromium.org>\nReviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>\n\
  Link: https://lore.kernel.org/r/20221202214410.never.693-kees@kernel.org\nSigned-off-by:\
  \ Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- net/nfc
hunk_count: 3
covered_count: 3
