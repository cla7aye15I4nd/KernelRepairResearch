id: d44d88f1d11e6ca8576b
bug_link: https://syzkaller.appspot.com/bug?extid=d44d88f1d11e6ca8576b
title: 'BUG: unable to handle kernel paging request in atm_tc_destroy'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cafc3662ee3fe29a0027e0a947e6c6493cccaf60
fix_commit: 4fab64126891d413f207dacd5762a839b3470315
datetime: '2023-02-13T09:51:59+00:00'
fix_commit_message: 'net/sched: fix error recovery in qdisc_create()


  If TCA_STAB attribute is malformed, qdisc_get_stab() returns

  an error, and we end up calling ops->destroy() while ops->init()

  has not been called yet.


  While we are at it, call qdisc_put_stab() after ops->destroy().


  Fixes: 1f62879e3632 ("net/sched: make stab available before ops->init() call")

  Reported-by: syzbot+d44d88f1d11e6ca8576b@syzkaller.appspotmail.com

  Signed-off-by: Eric Dumazet <edumazet@google.com>

  Cc: Vladimir Oltean <vladimir.oltean@nxp.com>

  Cc: Kurt Kanzenbach <kurt@linutronix.de>

  Reviewed-by: Vladimir Oltean <vladimir.oltean@nxp.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/sched
hunk_count: 4
covered_count: 4
