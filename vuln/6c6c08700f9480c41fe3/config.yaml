id: 6c6c08700f9480c41fe3
bug_link: https://syzkaller.appspot.com/bug?extid=6c6c08700f9480c41fe3
title: 'KASAN: use-after-free Read in rtw_load_firmware_cb'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 27d90ad37771ab4af5ae2bf531321497984053b7
fix_commit: 0e735a4c6137262bcefe45bb52fde7b1f5fc6c4d
datetime: '2024-08-02T09:31:12+08:00'
fix_commit_message: 'wifi: rtw88: always wait for both firmware loading attempts


  In ''rtw_wait_firmware_completion()'', always wait for both (regular and

  wowlan) firmware loading attempts. Otherwise if ''rtw_usb_intf_init()''

  has failed in ''rtw_usb_probe()'', ''rtw_usb_disconnect()'' may issue

  ''ieee80211_free_hw()'' when one of ''rtw_load_firmware_cb()'' (usually

  the wowlan one) is still in progress, causing UAF detected by KASAN.


  Fixes: c8e5695eae99 ("rtw88: load wowlan firmware if wowlan is supported")

  Reported-by: syzbot+6c6c08700f9480c41fe3@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=6c6c08700f9480c41fe3

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Signed-off-by: Ping-Ke Shih <pkshih@realtek.com>

  Link: https://patch.msgid.link/20240726114657.25396-1-dmantipov@yandex.ru

  '
submodule:
- drivers/net/wireless/realtek/rtw88
hunk_count: 1
covered_count: 0
