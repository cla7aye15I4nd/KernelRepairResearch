id: d9536adc269404a984f8
bug_link: https://syzkaller.appspot.com/bug?extid=d9536adc269404a984f8
title: 'KASAN: use-after-free Read in j1939_session_get_by_addr'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: fd81ebfe7975b9a69494430676d16f7125aac3ee
fix_commit: d966635b384b9571a43bd38c61f280c47eb564ad
datetime: '2019-11-13T10:42:34+01:00'
fix_commit_message: 'can: j1939: transport: make sure the aborted session will be
  deactivated only once


  j1939_session_cancel() was modifying session->state without protecting

  it by locks and without checking actual state of the session.


  This patch moves j1939_tp_set_rxtimeout() into j1939_session_cancel()

  and adds the missing locking.


  Fixes: 9d71dd0c7009 ("can: add support of SAE J1939 protocol")

  Signed-off-by: Oleksij Rempel <o.rempel@pengutronix.de>

  '
submodule:
- net/can
hunk_count: 8
covered_count: 0
