id: f43a23b6e622797c7a28
bug_link: https://syzkaller.appspot.com/bug?extid=f43a23b6e622797c7a28
title: 'KASAN: slab-use-after-free Read in nla_find'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f7dd48ea76be30666f0614d6a06061185ed38c60
fix_commit: 2130c519a401e576647040043cb46d6fdc361dcc
datetime: '2023-12-19T15:20:40+01:00'
fix_commit_message: 'bpf: Use nla_ok() instead of checking nla_len directly


  nla_len may also be too short to be sane, in which case after

  recent changes nla_len() will return a wrapped value.


  Fixes: 172db56d90d2 ("netlink: Return unsigned value for nla_len()")

  Reported-by: syzbot+f43a23b6e622797c7a28@syzkaller.appspotmail.com

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Reviewed-by: Simon Horman <horms@kernel.org>

  Link: https://lore.kernel.org/bpf/20231218231904.260440-1-kuba@kernel.org

  '
submodule:
- net/core
hunk_count: 1
covered_count: 1
