id: 8407d9bb88cd4c6bf61a
bug_link: https://syzkaller.appspot.com/bug?extid=8407d9bb88cd4c6bf61a
title: 'KMSAN: uninit-value in nf_flow_offload_inet_hook'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a0b39e2dc7017ac667b70bdeee5293e410fab2fb
fix_commit: 6ea14ccb60c8ab829349979b22b58a941ec4a3ee
datetime: '2024-08-22T12:14:18+02:00'
fix_commit_message: "netfilter: flowtable: validate vlan header\n\nEnsure there is\
  \ sufficient room to access the protocol field of the\nVLAN header, validate it\
  \ once before the flowtable lookup.\n\n=====================================================\n\
  BUG: KMSAN: uninit-value in nf_flow_offload_inet_hook+0x45a/0x5f0 net/netfilter/nf_flow_table_inet.c:32\n\
  \ nf_flow_offload_inet_hook+0x45a/0x5f0 net/netfilter/nf_flow_table_inet.c:32\n\
  \ nf_hook_entry_hookfn include/linux/netfilter.h:154 [inline]\n nf_hook_slow+0xf4/0x400\
  \ net/netfilter/core.c:626\n nf_hook_ingress include/linux/netfilter_netdev.h:34\
  \ [inline]\n nf_ingress net/core/dev.c:5440 [inline]\n\nFixes: 4cd91f7c290f (\"\
  netfilter: flowtable: add vlan support\")\nReported-by: syzbot+8407d9bb88cd4c6bf61a@syzkaller.appspotmail.com\n\
  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>\n"
submodule:
- net/netfilter
hunk_count: 2
covered_count: 1
