id: 2da1965168e7dbcba136
bug_link: https://syzkaller.appspot.com/bug?extid=2da1965168e7dbcba136
title: general protection fault in rxe_completer
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e0ba8ff46704fc924e2ef0451ba196cbdc0d68f2
fix_commit: 5993b75d0bc71cd2b441d174b028fc36180f032c
datetime: '2023-07-31T15:24:12-03:00'
fix_commit_message: 'RDMA/rxe: Fix unsafe drain work queue code


  If create_qp does not fully succeed it is possible for qp cleanup

  code to attempt to drain the send or recv work queues before the

  queues have been created causing a seg fault. This patch checks

  to see if the queues exist before attempting to drain them.


  Link: https://lore.kernel.org/r/20230620135519.9365-3-rpearsonhpe@gmail.com

  Reported-by: syzbot+2da1965168e7dbcba136@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/linux-rdma/00000000000012d89205fe7cfe00@google.com/raw

  Fixes: 49dc9c1f0c7e ("RDMA/rxe: Cleanup reset state handling in rxe_resp.c")

  Fixes: fbdeb828a21f ("RDMA/rxe: Cleanup error state handling in rxe_comp.c")

  Signed-off-by: Bob Pearson <rpearsonhpe@gmail.com>

  Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>

  '
submodule:
- drivers/infiniband/sw/rxe
hunk_count: 2
covered_count: 1
