id: b974d32294d1dffbea36
bug_link: https://syzkaller.appspot.com/bug?extid=b974d32294d1dffbea36
title: general protection fault in xsk_recvmsg
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2f4b03195fe8ed3b1e213f4a6cfe14cfc109d829
fix_commit: 3546b9b8eced9799b35ef953f766a0973b17fda2
datetime: '2020-12-08T17:11:58+01:00'
fix_commit_message: 'xsk: Validate socket state in xsk_recvmsg, prior touching socket
  members


  In AF_XDP the socket state needs to be checked, prior touching the

  members of the socket. This was not the case for the recvmsg

  implementation. Fix that by moving the xsk_is_bound() call.


  Fixes: 45a86681844e ("xsk: Add support for recvmsg()")

  Reported-by: kernel test robot <oliver.sang@intel.com>

  Signed-off-by: Björn Töpel <bjorn.topel@intel.com>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Acked-by: Magnus Karlsson <magnus.karlsson@intel.com>

  Link: https://lore.kernel.org/bpf/20201207082008.132263-1-bjorn.topel@gmail.com

  '
submodule:
- net/xdp
hunk_count: 1
covered_count: 1
