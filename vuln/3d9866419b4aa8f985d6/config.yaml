id: 3d9866419b4aa8f985d6
bug_link: https://syzkaller.appspot.com/bug?extid=3d9866419b4aa8f985d6
title: 'WARNING: suspicious RCU usage in xfrm_set_default'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 047a749d231e4faccaf5f473cf73dc5732425f81
fix_commit: 93ec1320b0170d7a207eda2d119c669b673401ed
datetime: '2021-09-23T10:11:12+02:00'
fix_commit_message: 'xfrm: fix rcu lock in xfrm_notify_userpolicy()


  As stated in the comment above xfrm_nlmsg_multicast(), rcu read lock must

  be held before calling this function.


  Reported-by: syzbot+3d9866419b4aa8f985d6@syzkaller.appspotmail.com

  Fixes: 703b94b93c19 ("xfrm: notify default policy on update")

  Signed-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 2
covered_count: 2
