id: 4abac52934a48af5ff19
bug_link: https://syzkaller.appspot.com/bug?extid=4abac52934a48af5ff19
title: general protection fault in proc_kill_sb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9d78edeaec759f997c303f286ecd39daee166f2a
fix_commit: 058f2e4da79b23afb56ce3d03d907d6cdd36f2b8
datetime: '2020-06-10T14:54:54-05:00'
fix_commit_message: 'proc: s_fs_info may be NULL when proc_kill_sb is called


  syzbot found that proc_fill_super() fails before filling up sb->s_fs_info,

  deactivate_locked_super() will be called and sb->s_fs_info will be NULL.

  The proc_kill_sb() does not expect fs_info to be NULL which is wrong.


  Link: https://lore.kernel.org/lkml/0000000000002d7ca605a7b8b1c5@google.com

  Reported-by: syzbot+4abac52934a48af5ff19@syzkaller.appspotmail.com

  Fixes: fa10fed30f25 ("proc: allow to mount many instances of proc in one pid namespace")

  Signed-off-by: Alexey Gladkov <gladkov.alexey@gmail.com>

  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>

  '
submodule:
- fs/proc
hunk_count: 1
covered_count: 1
