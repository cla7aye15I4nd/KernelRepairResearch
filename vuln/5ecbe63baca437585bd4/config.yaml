id: 5ecbe63baca437585bd4
bug_link: https://syzkaller.appspot.com/bug?extid=5ecbe63baca437585bd4
title: kernel BUG in memory_bm_free
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a1df829ead5877d4a1061e976a50e2e665a16f24
fix_commit: 91cb2c8b072e00632adf463b78b44f123d46a0fa
datetime: '2021-02-02T17:44:47+00:00'
fix_commit_message: 'arm64: Do not pass tagged addresses to __is_lm_address()


  Commit 519ea6f1c82f ("arm64: Fix kernel address detection of

  __is_lm_address()") fixed the incorrect validation of addresses below

  PAGE_OFFSET. However, it no longer allowed tagged addresses to be passed

  to virt_addr_valid().


  Fix this by explicitly resetting the pointer tag prior to invoking

  __is_lm_address(). This is consistent with the __lm_to_phys() macro.


  Fixes: 519ea6f1c82f ("arm64: Fix kernel address detection of __is_lm_address()")

  Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

  Acked-by: Ard Biesheuvel <ardb@kernel.org>

  Cc: <stable@vger.kernel.org> # 5.4.x

  Cc: Will Deacon <will@kernel.org>

  Cc: Vincenzo Frascino <vincenzo.frascino@arm.com>

  Cc: Mark Rutland <mark.rutland@arm.com>

  Link: https://lore.kernel.org/r/20210201190634.22942-2-catalin.marinas@arm.com

  '
submodule:
- arch/arm64/include/asm
- arch/arm64/mm
hunk_count: 2
covered_count: 0
