id: 52c1a7d3e5b361ccd346
bug_link: https://syzkaller.appspot.com/bug?extid=52c1a7d3e5b361ccd346
title: 'KASAN: slab-out-of-bounds Read in mcp2221_raw_event'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9fc51941d9e7793da969b2c66e6f8213c5b1237f
fix_commit: b56cc41a3ae7323aa3c6165f93c32e020538b6d2
datetime: '2025-08-13T10:49:16+02:00'
fix_commit_message: 'hid: fix I2C read buffer overflow in raw_event() for mcp2221


  As reported by syzbot, mcp2221_raw_event lacked

  validation of incoming I2C read data sizes, risking buffer

  overflows in mcp->rxbuf during multi-part transfers.

  As highlighted in the DS20005565B spec, p44, we have:

  "The number of read-back data bytes to follow in this packet:

  from 0 to a maximum of 60 bytes of read-back bytes."

  This patch enforces we don''t exceed this limit.


  Reported-by: syzbot+52c1a7d3e5b361ccd346@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=52c1a7d3e5b361ccd346

  Tested-by: syzbot+52c1a7d3e5b361ccd346@syzkaller.appspotmail.com

  Signed-off-by: Arnaud Lecomte <contact@arnaud-lcm.com>

  Link: https://patch.msgid.link/20250726220931.7126-1-contact@arnaud-lcm.com

  Signed-off-by: Benjamin Tissoires <bentiss@kernel.org>

  '
submodule:
- drivers/hid
hunk_count: 1
covered_count: 0
