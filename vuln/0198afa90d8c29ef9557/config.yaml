id: 0198afa90d8c29ef9557
bug_link: https://syzkaller.appspot.com/bug?extid=0198afa90d8c29ef9557
title: 'KMSAN: uninit-value in io_rw_fail (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6e5e6d274956305f1fc0340522b38f5f5be74bdb
fix_commit: 0a535eddbe0dc1de4386046ab849f08aeb2f8faf
datetime: '2023-12-21T08:49:18-07:00'
fix_commit_message: 'io_uring/rw: ensure io->bytes_done is always initialized


  If IOSQE_ASYNC is set and we fail importing an iovec for a readv or

  writev request, then we leave ->bytes_done uninitialized and hence the

  eventual failure CQE posted can potentially have a random res value

  rather than the expected -EINVAL.


  Setup ->bytes_done before potentially failing, so we have a consistent

  value if we fail the request early.


  Cc: stable@vger.kernel.org

  Reported-by: xingwei lee <xrivendell7@gmail.com>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- io_uring
hunk_count: 1
covered_count: 0
