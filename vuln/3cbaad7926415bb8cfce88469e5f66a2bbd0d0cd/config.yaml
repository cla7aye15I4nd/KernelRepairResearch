id: 3cbaad7926415bb8cfce88469e5f66a2bbd0d0cd
bug_link: https://syzkaller.appspot.com/bug?extid=3cbaad7926415bb8cfce88469e5f66a2bbd0d0cd
title: 'KASAN: use-after-free Write in aead_recvmsg'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9abffc6f2efe46c3564c04312e52e07622d40e51
fix_commit: d53c5135792319e095bb126bc43b2ee98586f7fe
datetime: '2017-12-11T22:29:55+11:00'
fix_commit_message: 'crypto: af_alg - fix race accessing cipher request


  When invoking an asynchronous cipher operation, the invocation of the

  callback may be performed before the subsequent operations in the

  initial code path are invoked. The callback deletes the cipher request

  data structure which implies that after the invocation of the

  asynchronous cipher operation, this data structure must not be accessed

  any more.


  The setting of the return code size with the request data structure must

  therefore be moved before the invocation of the asynchronous cipher

  operation.


  Fixes: e870456d8e7c ("crypto: algif_skcipher - overhaul memory management")

  Fixes: d887c52d6ae4 ("crypto: algif_aead - overhaul memory management")

  Reported-by: syzbot <syzkaller@googlegroups.com>

  Cc: <stable@vger.kernel.org> # v4.14+

  Signed-off-by: Stephan Mueller <smueller@chronox.de>

  Acked-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 4
covered_count: 2
