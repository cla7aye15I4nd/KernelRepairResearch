id: 915a8416bf15895b8e07
bug_link: https://syzkaller.appspot.com/bug?extid=915a8416bf15895b8e07
title: 'KASAN: use-after-free Read in mgmt_pending_remove'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 23b72814da1a094b4c065e0bb598249f310c5577
fix_commit: 3cfbc6ac22d62d0a06be9ce2996ba9fed75436cd
datetime: '2022-08-25T16:26:17-07:00'
fix_commit_message: 'Bluetooth: hci_sync: fix double mgmt_pending_free() in remove_adv_monitor()


  syzbot is reporting double kfree() at remove_adv_monitor() [1], for

  commit 7cf5c2978f23fdbb ("Bluetooth: hci_sync: Refactor remove Adv

  Monitor") forgot to remove duplicated mgmt_pending_remove() when

  merging "if (err) {" path and "if (!pending) {" path.


  Link: https://syzkaller.appspot.com/bug?extid=915a8416bf15895b8e07 [1]

  Reported-by: syzbot <syzbot+915a8416bf15895b8e07@syzkaller.appspotmail.com>

  Fixes: 7cf5c2978f23fdbb ("Bluetooth: hci_sync: Refactor remove Adv Monitor")

  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

  '
submodule:
- net/bluetooth
hunk_count: 1
covered_count: 1
