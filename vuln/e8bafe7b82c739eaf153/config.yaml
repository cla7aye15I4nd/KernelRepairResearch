id: e8bafe7b82c739eaf153
bug_link: https://syzkaller.appspot.com/bug?extid=e8bafe7b82c739eaf153
title: 'UBSAN: array-index-out-of-bounds in ima_inode_setxattr'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d07eeeb8745973389e1d772b3b654f5860441589
fix_commit: cb181da161963eddc9de0000de6ab2c7942be219
datetime: '2021-08-23T18:22:00-04:00'
fix_commit_message: 'IMA: reject unknown hash algorithms in ima_get_hash_algo


  The new function validate_hash_algo() assumed that ima_get_hash_algo()

  always return a valid ''enum hash_algo'', but it returned the

  user-supplied value present in the digital signature without

  any bounds checks.


  Update ima_get_hash_algo() to always return a valid hash algorithm,

  defaulting on ''ima_hash_algo'' when the user-supplied value inside

  the xattr is invalid.


  Signed-off-by: THOBY Simon <Simon.THOBY@viveris.fr>

  Reported-by: syzbot+e8bafe7b82c739eaf153@syzkaller.appspotmail.com

  Fixes: 50f742dd9147 ("IMA: block writes of the security.ima xattr with unsupported
  algorithms")

  Reviewed-by: Lakshmi Ramasubramanian <nramas@linux.microsoft.com>

  Signed-off-by: Mimi Zohar <zohar@linux.ibm.com>

  '
submodule:
- security/integrity/ima
hunk_count: 1
covered_count: 0
