id: 0cfd5e38e96a5596f2b6
bug_link: https://syzkaller.appspot.com/bug?extid=0cfd5e38e96a5596f2b6
title: 'KMSAN: uninit-value in __alloc_frozen_pages_noprof'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e842f9a1edf306bf36fe2a4d847a0b0d458770de
fix_commit: 8fe9ed44dc29fba0786b7e956d2e87179e407582
datetime: '2025-03-05T21:36:20-08:00'
fix_commit_message: "mm/page_alloc: fix uninitialized variable\n\nThe variable \"\
  compact_result\" is not initialized in function\n__alloc_pages_slowpath().  It causes\
  \ should_compact_retry() to use an\nuninitialized value.\n\nInitialize variable\
  \ \"compact_result\" with the value COMPACT_SKIPPED.\n\nBUG: KMSAN: uninit-value\
  \ in __alloc_pages_slowpath+0xee8/0x16c0 mm/page_alloc.c:4416\n __alloc_pages_slowpath+0xee8/0x16c0\
  \ mm/page_alloc.c:4416\n __alloc_frozen_pages_noprof+0xa4c/0xe00 mm/page_alloc.c:4752\n\
  \ alloc_pages_mpol+0x4cd/0x890 mm/mempolicy.c:2270\n alloc_frozen_pages_noprof mm/mempolicy.c:2341\
  \ [inline]\n alloc_pages_noprof mm/mempolicy.c:2361 [inline]\n folio_alloc_noprof+0x1dc/0x350\
  \ mm/mempolicy.c:2371\n filemap_alloc_folio_noprof+0xa6/0x440 mm/filemap.c:1019\n\
  \ __filemap_get_folio+0xb9a/0x1840 mm/filemap.c:1970\n grow_dev_folio fs/buffer.c:1039\
  \ [inline]\n grow_buffers fs/buffer.c:1105 [inline]\n __getblk_slow fs/buffer.c:1131\
  \ [inline]\n bdev_getblk+0x2c9/0xab0 fs/buffer.c:1431\n getblk_unmovable include/linux/buffer_head.h:369\
  \ [inline]\n ext4_getblk+0x3b7/0xe50 fs/ext4/inode.c:864\n ext4_bread_batch+0x9f/0x7d0\
  \ fs/ext4/inode.c:933\n __ext4_find_entry+0x1ebb/0x36c0 fs/ext4/namei.c:1627\n ext4_lookup_entry\
  \ fs/ext4/namei.c:1729 [inline]\n ext4_lookup+0x189/0xb40 fs/ext4/namei.c:1797\n\
  \ __lookup_slow+0x538/0x710 fs/namei.c:1793\n lookup_slow+0x6a/0xd0 fs/namei.c:1810\n\
  \ walk_component fs/namei.c:2114 [inline]\n link_path_walk+0xf29/0x1420 fs/namei.c:2479\n\
  \ path_openat+0x30f/0x6250 fs/namei.c:3985\n do_filp_open+0x268/0x600 fs/namei.c:4016\n\
  \ do_sys_openat2+0x1bf/0x2f0 fs/open.c:1428\n do_sys_open fs/open.c:1443 [inline]\n\
  \ __do_sys_openat fs/open.c:1459 [inline]\n __se_sys_openat fs/open.c:1454 [inline]\n\
  \ __x64_sys_openat+0x2a1/0x310 fs/open.c:1454\n x64_sys_call+0x36f5/0x3c30 arch/x86/include/generated/asm/syscalls_64.h:258\n\
  \ do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xcd/0x1e0\
  \ arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nLocal\
  \ variable compact_result created at:\n __alloc_pages_slowpath+0x66/0x16c0 mm/page_alloc.c:4218\n\
  \ __alloc_frozen_pages_noprof+0xa4c/0xe00 mm/page_alloc.c:4752\n\nLink: https://lkml.kernel.org/r/tencent_ED1032321D6510B145CDBA8CBA0093178E09@qq.com\n\
  Reported-by: syzbot+0cfd5e38e96a5596f2b6@syzkaller.appspotmail.com\nCloses: https://syzkaller.appspot.com/bug?extid=0cfd5e38e96a5596f2b6\n\
  Signed-off-by: Hao Zhang <zhanghao1@kylinos.cn>\nReviewed-by: Vlastimil Babka <vbabka@suse.cz>\n\
  Cc: Michal Hocko <mhocko@kernel.org>\nCc: Mel Gorman <mgorman@techsingularity.net>\n\
  Cc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\n"
submodule:
- mm
hunk_count: 1
covered_count: 1
