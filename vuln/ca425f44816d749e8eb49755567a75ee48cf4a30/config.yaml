id: ca425f44816d749e8eb49755567a75ee48cf4a30
bug_link: https://syzkaller.appspot.com/bug?extid=ca425f44816d749e8eb49755567a75ee48cf4a30
title: suspicious RCU usage at ./include/linux/rcupdate.h:LINE (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4e765b4972af7b07adcb1feb16e7a525ce1f6b28
fix_commit: 2f10a61cee8fdb9f8da90f5db687e1862b22cf06
datetime: '2017-12-31T16:29:24+01:00'
fix_commit_message: 'xfrm: fix rcu usage in xfrm_get_type_offload


  request_module can sleep, thus we cannot hold rcu_read_lock() while

  calling it. The function also jumps back and takes rcu_read_lock()

  again (in xfrm_state_get_afinfo()), resulting in an imbalance.


  This codepath is triggered whenever a new offloaded state is created.


  Fixes: ffdb5211da1c ("xfrm: Auto-load xfrm offload modules")

  Reported-by: syzbot+ca425f44816d749e8eb49755567a75ee48cf4a30@syzkaller.appspotmail.com

  Signed-off-by: Sabrina Dubroca <sd@queasysnail.net>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 1
covered_count: 1
