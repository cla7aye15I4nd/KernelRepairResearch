id: 36cf9e58446a643bfa14
bug_link: https://syzkaller.appspot.com/bug?extid=36cf9e58446a643bfa14
title: 'KASAN: slab-out-of-bounds Write in queue_stack_map_push_elem'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dde7011a824cfa815b03f853ec985ff46b740939
fix_commit: 813961de3ee6474dd5703e883471fd941d6c8f69
datetime: '2018-11-22T21:29:40+01:00'
fix_commit_message: 'bpf: fix integer overflow in queue_stack_map


  Fix the following issues:


  - allow queue_stack_map for root only

  - fix u32 max_entries overflow

  - disallow value_size == 0


  Fixes: f1a2e44a3aec ("bpf: add queue and stack maps")

  Reported-by: Wei Wu <ww9210@gmail.com>

  Signed-off-by: Alexei Starovoitov <ast@kernel.org>

  Cc: Mauricio Vasquez B <mauricio.vasquez@polito.it>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  '
submodule:
- kernel/bpf
hunk_count: 3
covered_count: 3
