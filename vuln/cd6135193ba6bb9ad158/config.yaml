id: cd6135193ba6bb9ad158
bug_link: https://syzkaller.appspot.com/bug?extid=cd6135193ba6bb9ad158
title: WARNING in rdev_scan
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 819bda58e77bb67974f94dc1aa11b0556b6f6889
fix_commit: 0941772342d59e48733131ac3a202fa1a4d832e9
datetime: '2024-06-12T10:06:58+02:00'
fix_commit_message: 'wifi: cfg80211: wext: set ssids=NULL for passive scans


  In nl80211, we always set the ssids of a scan request to

  NULL when n_ssids==0 (passive scan). Drivers have relied

  on this behaviour in the past, so we fixed it in 6 GHz

  scan requests as well, and added a warning so we''d have

  assurance the API would always be called that way.


  syzbot found that wext doesn''t ensure that, so we reach

  the check and trigger the warning. Fix the wext code to

  set the ssids pointer to NULL when there are none.


  Reported-by: syzbot+cd6135193ba6bb9ad158@syzkaller.appspotmail.com

  Fixes: f7a8b10bfd61 ("wifi: cfg80211: fix 6 GHz scan request building")

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/wireless
hunk_count: 1
covered_count: 1
