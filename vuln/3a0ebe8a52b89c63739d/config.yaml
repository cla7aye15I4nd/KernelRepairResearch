id: 3a0ebe8a52b89c63739d
bug_link: https://syzkaller.appspot.com/bug?extid=3a0ebe8a52b89c63739d
title: 'KASAN: slab-use-after-free Read in input_dev_uevent'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1d7546042f8fdc4bc39ab91ec966203e2d64f8bd
fix_commit: dd613a4e45f8d35f49a63a2064e5308fa5619e29
datetime: '2023-08-24T15:57:57+02:00'
fix_commit_message: 'HID: uclogic: Correct devm device reference for hidinput input_dev
  name


  Reference the HID device rather than the input device for the devm

  allocation of the input_dev name. Referencing the input_dev would lead to a

  use-after-free when the input_dev was unregistered and subsequently fires a

  uevent that depends on the name. At the point of firing the uevent, the

  name would be freed by devres management.


  Use devm_kasprintf to simplify the logic for allocating memory and

  formatting the input_dev name string.


  Reported-by: syzbot+3a0ebe8a52b89c63739d@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/linux-input/ZOZIZCND+L0P1wJc@penguin/T/

  Reported-by: Maxime Ripard <mripard@kernel.org>

  Closes: https://lore.kernel.org/linux-input/ZOZIZCND+L0P1wJc@penguin/T/#m443f3dce92520f74b6cf6ffa8653f9c92643d4ae

  Fixes: cce2dbdf258e ("HID: uclogic: name the input nodes based on their tool")

  Suggested-by: Maxime Ripard <mripard@kernel.org>

  Suggested-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

  Signed-off-by: Rahul Rameshbabu <sergeantsagara@protonmail.com>

  Reviewed-by: Maxime Ripard <mripard@kernel.org>

  Link: https://lore.kernel.org/r/20230824061308.222021-2-sergeantsagara@protonmail.com

  Signed-off-by: Benjamin Tissoires <bentiss@kernel.org>

  '
submodule:
- drivers/hid
hunk_count: 2
covered_count: 2
