id: 8ab6f1042021b4eed062
bug_link: https://syzkaller.appspot.com/bug?extid=8ab6f1042021b4eed062
title: 'KASAN: use-after-free Read in ceph_destroy_options'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 57361846b52bc686112da6ca5368d11210796804
fix_commit: 8aaff15168cfbc7c8980fdb0e8a585f1afe56ec0
datetime: '2018-09-06T16:18:04+02:00'
fix_commit_message: 'ceph: avoid a use-after-free in ceph_destroy_options()


  syzbot reported a use-after-free in ceph_destroy_options(), called from

  ceph_mount().  The problem was that create_fs_client() consumed the opt

  pointer on some errors, but not on all of them.  Make sure it always

  consumes both libceph and ceph options.


  Reported-by: syzbot+8ab6f1042021b4eed062@syzkaller.appspotmail.com

  Signed-off-by: Ilya Dryomov <idryomov@gmail.com>

  Reviewed-by: "Yan, Zheng" <zyan@redhat.com>

  '
submodule:
- fs/ceph
hunk_count: 4
covered_count: 2
