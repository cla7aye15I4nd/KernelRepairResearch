id: f966c13b1b4fc0403b19
bug_link: https://syzkaller.appspot.com/bug?extid=f966c13b1b4fc0403b19
title: WARNING in erofs_iget
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 80e78fcce86de0288793a0ef0f6acf37656ee4cf
fix_commit: 1dd73601a1cba37a0ed5f89a8662c90191df5873
datetime: '2022-09-20T07:59:32+08:00'
fix_commit_message: 'erofs: fix order >= MAX_ORDER warning due to crafted negative
  i_size


  As syzbot reported [1], the root cause is that i_size field is a

  signed type, and negative i_size is also less than EROFS_BLKSIZ.

  As a consequence, it''s handled as fast symlink unexpectedly.


  Let''s fall back to the generic path to deal with such unusual i_size.


  [1] https://lore.kernel.org/r/000000000000ac8efa05e7feaa1f@google.com


  Reported-by: syzbot+f966c13b1b4fc0403b19@syzkaller.appspotmail.com

  Fixes: 431339ba9042 ("staging: erofs: add inode operations")

  Reviewed-by: Yue Hu <huyue2@coolpad.com>

  Link: https://lore.kernel.org/r/20220909023948.28925-1-hsiangkao@linux.alibaba.com

  Signed-off-by: Gao Xiang <hsiangkao@linux.alibaba.com>

  '
submodule:
- fs/erofs
hunk_count: 1
covered_count: 1
