id: 0c35af046fa98c893c84
bug_link: https://syzkaller.appspot.com/bug?extid=0c35af046fa98c893c84
title: 'BUG: bad usercopy in raw_getsockopt'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a93fca920167755db7e931f9b302b355edec910a
fix_commit: c8fba5d6df5e476aa791db4f1f014dad2bb5e904
datetime: '2024-02-20T08:20:42+01:00'
fix_commit_message: 'can: raw: fix getsockopt() for new CAN_RAW_XL_VCID_OPTS


  The code for the CAN_RAW_XL_VCID_OPTS getsockopt() was incompletely adopted

  from the CAN_RAW_FILTER getsockopt().


  Add the missing put_user() and return statements.


  Flagged by Smatch.


  Fixes: c83c22ec1493 ("can: canxl: add virtual CAN network identifier support")

  Reported-by: Simon Horman <horms@kernel.org>

  Signed-off-by: Oliver Hartkopp <socketcan@hartkopp.net>

  Link: https://lore.kernel.org/all/20240219200021.12113-1-socketcan@hartkopp.net

  Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

  '
submodule:
- net/can
hunk_count: 1
covered_count: 1
