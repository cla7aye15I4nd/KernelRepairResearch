id: 24ebd650e20bd263ca01
bug_link: https://syzkaller.appspot.com/bug?extid=24ebd650e20bd263ca01
title: 'KASAN: slab-out-of-bounds Read in hci_le_meta_evt'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 70f259a3f4276b71db365b1d6ff1eab805ea6ec3
fix_commit: f7e0e8b2f1b0a09b527885babda3e912ba820798
datetime: '2020-11-09T13:15:21+01:00'
fix_commit_message: 'Bluetooth: Fix slab-out-of-bounds read in hci_le_direct_adv_report_evt()


  `num_reports` is not being properly checked. A malformed event packet with

  a large `num_reports` number makes hci_le_direct_adv_report_evt() read out

  of bounds. Fix it.


  Cc: stable@vger.kernel.org

  Fixes: 2f010b55884e ("Bluetooth: Add support for handling LE Direct Advertising
  Report events")

  Reported-and-tested-by: syzbot+24ebd650e20bd263ca01@syzkaller.appspotmail.com

  Link: https://syzkaller.appspot.com/bug?extid=24ebd650e20bd263ca01

  Signed-off-by: Peilin Ye <yepeilin.cs@gmail.com>

  Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

  '
submodule:
- net/bluetooth
hunk_count: 1
covered_count: 1
