id: 1e9af9185d8850e2c2fa
bug_link: https://syzkaller.appspot.com/bug?extid=1e9af9185d8850e2c2fa
title: kernel BUG in warn_crc32c_csum_combine
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4b549ccce941798703f159b227aa28c716aa78fa
fix_commit: 7f57f8165cb6d2c206e2b9ada53b9e2d6d8af42f
datetime: '2022-10-27T16:35:12+02:00'
fix_commit_message: 'af_key: Fix send_acquire race with pfkey_register


  The function pfkey_send_acquire may race with pfkey_register

  (which could even be in a different name space).  This may result

  in a buffer overrun.


  Allocating the maximum amount of memory that could be used prevents

  this.


  Reported-by: syzbot+1e9af9185d8850e2c2fa@syzkaller.appspotmail.com

  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  Reviewed-by: Sabrina Dubroca <sd@queasysnail.net>

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/key
hunk_count: 8
covered_count: 3
