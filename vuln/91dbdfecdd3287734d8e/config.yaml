id: 91dbdfecdd3287734d8e
bug_link: https://syzkaller.appspot.com/bug?extid=91dbdfecdd3287734d8e
title: possible deadlock in touch_wq_lockdep_map
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7c626ce4bae1ac14f60076d00eafe71af30450ba
fix_commit: ccbde4b128ef9c73d14d0d7817d68ef795f6d131
datetime: '2024-08-13T10:06:12+02:00'
fix_commit_message: 'char: xillybus: Don''t destroy workqueue from work item running
  on it


  Triggered by a kref decrement, destroy_workqueue() may be called from

  within a work item for destroying its own workqueue. This illegal

  situation is averted by adding a module-global workqueue for exclusive

  use of the offending work item. Other work items continue to be queued

  on per-device workqueues to ensure performance.


  Reported-by: syzbot+91dbdfecdd3287734d8e@syzkaller.appspotmail.com

  Cc: stable <stable@kernel.org>

  Closes: https://lore.kernel.org/lkml/0000000000000ab25a061e1dfe9f@google.com/

  Signed-off-by: Eli Billauer <eli.billauer@gmail.com>

  Link: https://lore.kernel.org/r/20240801121126.60183-1-eli.billauer@gmail.com

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/char/xillybus
hunk_count: 5
covered_count: 3
