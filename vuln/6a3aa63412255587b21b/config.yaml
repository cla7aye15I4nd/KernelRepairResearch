id: 6a3aa63412255587b21b
bug_link: https://syzkaller.appspot.com/bug?extid=6a3aa63412255587b21b
title: 'KASAN: slab-out-of-bounds Write in __put_unused_fd'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0357ef03c94ef835bd44a0658b8edb672a9dbf51
fix_commit: 0c0214df28f0dba8de084cb4dedc0c459dfbc083
datetime: '2025-01-06T12:08:42+01:00'
fix_commit_message: 'fanotify: Fix crash in fanotify_init(2)


  The rrror handling in fanotify_init(2) is buggy and overwrites ''fd''

  before calling put_unused_fd() leading to possible access beyond the end

  of fd bitmap. Fix it.


  Reported-by: syzbot+6a3aa63412255587b21b@syzkaller.appspotmail.com

  Fixes: ebe559609d78 ("fs: get rid of __FMODE_NONOTIFY kludge")

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/notify
hunk_count: 1
covered_count: 1
