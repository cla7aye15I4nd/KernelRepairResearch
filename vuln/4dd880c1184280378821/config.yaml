id: 4dd880c1184280378821
bug_link: https://syzkaller.appspot.com/bug?extid=4dd880c1184280378821
title: 'KMSAN: uninit-value in iforce_init_device (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c7e37cc6240767f794678d11704935d49cc81d59
fix_commit: b8ebf250997c5fb253582f42bfe98673801ebebd
datetime: '2022-11-07T10:28:58-08:00'
fix_commit_message: 'Input: iforce - invert valid length check when fetching device
  IDs


  syzbot is reporting uninitialized value at iforce_init_device() [1], for

  commit 6ac0aec6b0a6 ("Input: iforce - allow callers supply data buffer

  when fetching device IDs") is checking that valid length is shorter than

  bytes to read. Since iforce_get_id_packet() stores valid length when

  returning 0, the caller needs to check that valid length is longer than or

  equals to bytes to read.


  Reported-by: syzbot <syzbot+4dd880c1184280378821@syzkaller.appspotmail.com>

  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Fixes: 6ac0aec6b0a6 ("Input: iforce - allow callers supply data buffer when fetching
  device IDs")

  Link: https://lore.kernel.org/r/531fb432-7396-ad37-ecba-3e42e7f56d5c@I-love.SAKURA.ne.jp

  Cc: stable@vger.kernel.org

  Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

  '
submodule:
- drivers/input/joystick/iforce
hunk_count: 1
covered_count: 1
