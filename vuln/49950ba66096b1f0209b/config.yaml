id: 49950ba66096b1f0209b
bug_link: https://syzkaller.appspot.com/bug?extid=49950ba66096b1f0209b
title: 'KASAN: use-after-free Read in pty_close'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cf0dd9527eee5d6d183fa724fdee6a128cb17b8d
fix_commit: 7a121ced6e6430d49fb802067b4f020f6df62362
datetime: '2022-07-24T18:39:17-06:00'
fix_commit_message: 'io_uring: don''t miss setting REQ_F_DOUBLE_POLL


  When adding a second poll entry we should set REQ_F_DOUBLE_POLL

  unconditionally. We might race with the first entry removal but that

  doesn''t change the rule.


  Fixes: a18427bb2d9b ("io_uring: optimise submission side poll_refs")

  Reported-and-tested-by: syzbot+49950ba66096b1f0209b@syzkaller.appspotmail.com

  Signed-off-by: Pavel Begunkov <asml.silence@gmail.com>

  Link: https://lore.kernel.org/r/8b680d83ded07424db83e8745585e7a6d72826ef.1657203020.git.asml.silence@gmail.com

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- io_uring
hunk_count: 1
covered_count: 1
