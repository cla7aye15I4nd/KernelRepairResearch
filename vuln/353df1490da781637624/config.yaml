id: 353df1490da781637624
bug_link: https://syzkaller.appspot.com/bug?extid=353df1490da781637624
title: WARNING in nla_get_range_unsigned
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0f091e43310f5c292b7094f9f115e651358e8053
fix_commit: c30a3c957c885e618ddffc065f888be4f8d5a9bd
datetime: '2020-08-31T12:01:15-07:00'
fix_commit_message: 'netlink: policy: correct validation type check


  In the policy export for binary attributes I erroneously used

  a != NLA_VALIDATE_NONE comparison instead of checking for the

  two possible values, which meant that if a validation function

  pointer ended up aliasing the min/max as negatives, we''d hit

  a warning in nla_get_range_unsigned().


  Fix this to correctly check for only the two types that should

  be handled here, i.e. range with or without warn-too-long.


  Reported-by: syzbot+353df1490da781637624@syzkaller.appspotmail.com

  Fixes: 8aa26c575fb3 ("netlink: make NLA_BINARY validation more flexible")

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/netlink
hunk_count: 1
covered_count: 1
