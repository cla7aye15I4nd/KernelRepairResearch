id: 7fbfe5fed73ebb675748
bug_link: https://syzkaller.appspot.com/bug?extid=7fbfe5fed73ebb675748
title: 'UBSAN: array-index-out-of-bounds in udf_statfs'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 902e7f373fff2476b53824264c12e4e76c7ec02a
fix_commit: 781d2a9a2fc7d0be53a072794dc03ef6de770f3d
datetime: '2021-08-11T16:54:44+02:00'
fix_commit_message: 'udf: Check LVID earlier


  We were checking validity of LVID entries only when getting

  implementation use information from LVID in udf_sb_lvidiu(). However if

  the LVID is suitably corrupted, it can cause problems also to code such

  as udf_count_free() which doesn''t use udf_sb_lvidiu(). So check validity

  of LVID already when loading it from the disk and just disable LVID

  altogether when it is not valid.


  Reported-by: syzbot+7fbfe5fed73ebb675748@syzkaller.appspotmail.com

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/udf
hunk_count: 3
covered_count: 0
