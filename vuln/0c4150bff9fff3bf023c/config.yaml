id: 0c4150bff9fff3bf023c
bug_link: https://syzkaller.appspot.com/bug?extid=0c4150bff9fff3bf023c
title: WARNING in skb_ensure_writable
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b99a95bc56c52a428befbce12d9451fd7a0f3bc2
fix_commit: 2bbe3e5a2f4ef69d13be54f1cf895b4658287080
datetime: '2024-06-14T17:20:21+02:00'
fix_commit_message: 'bpf: Avoid splat in pskb_pull_reason


  syzkaller builds (CONFIG_DEBUG_NET=y) frequently trigger a debug

  hint in pskb_may_pull.


  We''d like to retain this debug check because it might hint at integer

  overflows and other issues (kernel code should pull headers, not huge

  value).


  In bpf case, this splat isn''t interesting at all: such (nonsensical)

  bpf programs are typically generated by a fuzzer anyway.


  Do what Eric suggested and suppress such warning.


  For CONFIG_DEBUG_NET=n we don''t need the extra check because

  pskb_may_pull will do the right thing: return an error without the

  WARN() backtrace.


  Fixes: 219eee9c0d16 ("net: skbuff: add overflow debug check to pull/push helpers")

  Reported-by: syzbot+0c4150bff9fff3bf023c@syzkaller.appspotmail.com

  Suggested-by: Eric Dumazet <edumazet@google.com>

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Acked-by: Daniel Borkmann <daniel@iogearbox.net>

  Closes: https://syzkaller.appspot.com/bug?extid=0c4150bff9fff3bf023c

  Link: https://lore.kernel.org/netdev/9f254c96-54f2-4457-b7ab-1d9f6187939c@gmail.com/

  Link: https://lore.kernel.org/bpf/20240614101801.9496-1-fw@strlen.de

  '
submodule:
- net/core
hunk_count: 1
covered_count: 1
