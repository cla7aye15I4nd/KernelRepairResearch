id: 3ae0a3f42c84074b7c8e
bug_link: https://syzkaller.appspot.com/bug?extid=3ae0a3f42c84074b7c8e
title: WARNING in send_hsr_supervision_frame (3)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 62b4248105353e7d1debd30ca5c57ec5e5f28e35
fix_commit: 37e8c97e539015637cb920d3e6f1e404f707a06e
datetime: '2024-01-29T11:29:55+00:00'
fix_commit_message: "net: hsr: remove WARN_ONCE() in send_hsr_supervision_frame()\n\
  \nSyzkaller reported [1] hitting a warning after failing to allocate\nresources\
  \ for skb in hsr_init_skb(). Since a WARN_ONCE() call will\nnot help much in this\
  \ case, it might be prudent to switch to\nnetdev_warn_once(). At the very least\
  \ it will suppress syzkaller\nreports such as [1].\n\nJust in case, use netdev_warn_once()\
  \ in send_prp_supervision_frame()\nfor similar reasons.\n\n[1]\nHSR: Could not send\
  \ supervision frame\nWARNING: CPU: 1 PID: 85 at net/hsr/hsr_device.c:294 send_hsr_supervision_frame+0x60a/0x810\
  \ net/hsr/hsr_device.c:294\nRIP: 0010:send_hsr_supervision_frame+0x60a/0x810 net/hsr/hsr_device.c:294\n\
  ...\nCall Trace:\n <IRQ>\n hsr_announce+0x114/0x370 net/hsr/hsr_device.c:382\n call_timer_fn+0x193/0x590\
  \ kernel/time/timer.c:1700\n expire_timers kernel/time/timer.c:1751 [inline]\n __run_timers+0x764/0xb20\
  \ kernel/time/timer.c:2022\n run_timer_softirq+0x58/0xd0 kernel/time/timer.c:2035\n\
  \ __do_softirq+0x21a/0x8de kernel/softirq.c:553\n invoke_softirq kernel/softirq.c:427\
  \ [inline]\n __irq_exit_rcu kernel/softirq.c:632 [inline]\n irq_exit_rcu+0xb7/0x120\
  \ kernel/softirq.c:644\n sysvec_apic_timer_interrupt+0x95/0xb0 arch/x86/kernel/apic/apic.c:1076\n\
  \ </IRQ>\n <TASK>\n asm_sysvec_apic_timer_interrupt+0x1a/0x20 arch/x86/include/asm/idtentry.h:649\n\
  ...\n\nThis issue is also found in older kernels (at least up to 5.10).\n\nCc: stable@vger.kernel.org\n\
  Reported-by: syzbot+3ae0a3f42c84074b7c8e@syzkaller.appspotmail.com\nFixes: 121c33b07b31\
  \ (\"net: hsr: introduce common code for skb initialization\")\nSigned-off-by: Nikita\
  \ Zhandarovich <n.zhandarovich@fintech.ru>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n"
submodule:
- net/hsr
hunk_count: 2
covered_count: 2
