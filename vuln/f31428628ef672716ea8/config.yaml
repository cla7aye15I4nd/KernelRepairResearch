id: f31428628ef672716ea8
bug_link: https://syzkaller.appspot.com/bug?extid=f31428628ef672716ea8
title: WARNING in idr_alloc
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bcf7ddb0186d366f761f86196b480ea6dd2dc18c
fix_commit: 8dfddfb79653df7c38a9c8c4c034f242a36acee9
datetime: '2020-08-17T15:00:41-07:00'
fix_commit_message: 'net: qrtr: fix usage of idr in port assignment to socket


  Passing large uint32 sockaddr_qrtr.port numbers for port allocation

  triggers a warning within idr_alloc() since the port number is cast

  to int, and thus interpreted as a negative number. This leads to

  the rejection of such valid port numbers in qrtr_port_assign() as

  idr_alloc() fails.


  To avoid the problem, switch to idr_alloc_u32() instead.


  Fixes: bdabad3e363d ("net: Add Qualcomm IPC router")

  Reported-by: syzbot+f31428628ef672716ea8@syzkaller.appspotmail.com

  Signed-off-by: Necip Fazil Yildiran <necip@google.com>

  Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/qrtr
hunk_count: 1
covered_count: 1
