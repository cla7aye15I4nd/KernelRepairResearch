id: 25aae26fb74bd5909706
bug_link: https://syzkaller.appspot.com/bug?extid=25aae26fb74bd5909706
title: 'linux-next boot error: WARNING in kthread_should_stop'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 19258d05b619d26622bdcfa11eca1f457b69e4da
fix_commit: db516da95ce458f0cab5e7ae2db93fd821484d7d
datetime: '2022-11-18T02:18:10+01:00'
fix_commit_message: 'hw_random: use add_hwgenerator_randomness() for early entropy


  Rather than calling add_device_randomness(), the add_early_randomness()

  function should use add_hwgenerator_randomness(), so that the early

  entropy can be potentially credited, which allows for the RNG to

  initialize earlier without having to wait for the kthread to come up.


  This requires some minor API refactoring, by adding a `sleep_after`

  parameter to add_hwgenerator_randomness(), so that we don''t hit a

  blocking sleep from add_early_randomness().


  Tested-by: AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>

  Tested-by: Marek Szyprowski <m.szyprowski@samsung.com>

  Reviewed-by: AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>

  Reviewed-by: Dominik Brodowski <linux@dominikbrodowski.net>

  Acked-by: Herbert Xu <herbert@gondor.apana.org.au>

  Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com>

  '
submodule:
- drivers/char
- drivers/char/hw_random
- include/linux
hunk_count: 6
covered_count: 3
