id: a91fcdbd2698f99db8f4
bug_link: https://syzkaller.appspot.com/bug?extid=a91fcdbd2698f99db8f4
title: possible deadlock in upgrade_mmap_lock_carefully (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 519b078998ce6e729f98dccf35505b4756985d11
fix_commit: a49f0abd8959048af18c6c690b065eb0d65b2d21
datetime: '2025-07-08T09:42:21+02:00'
fix_commit_message: 'Revert "fs/ntfs3: Replace inode_trylock with inode_lock"


  This reverts commit 69505fe98f198ee813898cbcaf6770949636430b.


  Initially, conditional lock acquisition was removed to fix an xfstest bug

  that was observed during internal testing. The deadlock reported by syzbot

  is resolved by reintroducing conditional acquisition. The xfstest bug no

  longer occurs on kernel version 6.16-rc1 during internal testing. I

  assume that changes in other modules may have contributed to this.


  Fixes: 69505fe98f19 ("fs/ntfs3: Replace inode_trylock with inode_lock")

  Reported-by: syzbot+a91fcdbd2698f99db8f4@syzkaller.appspotmail.com

  Suggested-by: Lorenzo Stoakes <lorenzo.stoakes@oracle.com>

  Signed-off-by: Konstantin Komarov <almaz.alexandrovich@paragon-software.com>

  '
submodule:
- fs/ntfs3
hunk_count: 1
covered_count: 1
