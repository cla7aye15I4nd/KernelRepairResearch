id: f02ef87ef8bbb97026bd
bug_link: https://syzkaller.appspot.com/bug?extid=f02ef87ef8bbb97026bd
title: 'net-next test error: UBSAN: array-index-out-of-bounds in alloc_pid'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 112e7e21519422b6f2bb0fa8061f5685e9757170
fix_commit: b69f0aeb068980af983d399deafc7477cec8bc04
datetime: '2023-06-30T09:04:01-07:00'
fix_commit_message: "pid: Replace struct pid 1-element array with flex-array\n\nFor\
  \ pid namespaces, struct pid uses a dynamically sized array member,\n\"numbers\"\
  .  This was implemented using the ancient 1-element fake\nflexible array, which\
  \ has been deprecated for decades.\n\nReplace it with a C99 flexible array, refactor\
  \ the array size\ncalculations to use struct_size(), and address elements via indexes.\n\
  Note that the static initializer (which defines a single element) works\nas-is,\
  \ and requires no special handling.\n\nWithout this, CONFIG_UBSAN_BOUNDS (and potentially\n\
  CONFIG_FORTIFY_SOURCE) will trigger bounds checks:\n\n  https://lore.kernel.org/lkml/20230517-bushaltestelle-super-e223978c1ba6@brauner\n\
  \nCc: Christian Brauner <brauner@kernel.org>\nCc: Jan Kara <jack@suse.cz>\nCc: Jeff\
  \ Xu <jeffxu@google.com>\nCc: Andreas Gruenbacher <agruenba@redhat.com>\nCc: Daniel\
  \ Verkamp <dverkamp@chromium.org>\nCc: \"Paul E. McKenney\" <paulmck@kernel.org>\n\
  Cc: Jeff Xu <jeffxu@google.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\n\
  Cc: Boqun Feng <boqun.feng@gmail.com>\nCc: Luis Chamberlain <mcgrof@kernel.org>\n\
  Cc: Frederic Weisbecker <frederic@kernel.org>\nReported-by: syzbot+ac3b41786a2d0565b6d5@syzkaller.appspotmail.com\n\
  [brauner: dropped unrelated changes and remove 0 with NULL cast]\nSigned-off-by:\
  \ Kees Cook <keescook@chromium.org>\nSigned-off-by: Christian Brauner <brauner@kernel.org>\n\
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n"
submodule:
- include/linux
- kernel
hunk_count: 3
covered_count: 0
