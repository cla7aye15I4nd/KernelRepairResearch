id: 91b4b56ead187d35c9d3
bug_link: https://syzkaller.appspot.com/bug?extid=91b4b56ead187d35c9d3
title: memory leak in io_submit_sqes (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e4b4a13f494120c475580927864cc1dd96f595d1
fix_commit: f01272541d2cd7b7f24909d63ea2b028a6a66293
datetime: '2021-03-04T06:38:10-07:00'
fix_commit_message: 'io-wq: ensure all pending work is canceled on exit


  If we race on shutting down the io-wq, then we should ensure that any

  work that was queued after workers shutdown is canceled. Harden the

  add work check a bit too, checking for IO_WQ_BIT_EXIT and cancel if

  it''s set.


  Add a WARN_ON() for having any work before we kill the io-wq context.


  Reported-by: syzbot+91b4b56ead187d35c9d3@syzkaller.appspotmail.com

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 6
covered_count: 0
