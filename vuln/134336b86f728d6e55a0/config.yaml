id: 134336b86f728d6e55a0
bug_link: https://syzkaller.appspot.com/bug?extid=134336b86f728d6e55a0
title: 'KCSAN: data-race in find_next_bit / rcu_report_exp_cpu_mult'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e42617b825f8073569da76dc4510bfa019b1c35a
fix_commit: 15c7c972cd26d89a26788e609c53b5a465324a6c
datetime: '2019-12-09T12:24:56-08:00'
fix_commit_message: 'rcu: Use *_ONCE() to protect lockless ->expmask accesses


  The rcu_node structure''s ->expmask field is accessed locklessly when

  starting a new expedited grace period and when reporting an expedited

  RCU CPU stall warning.  This commit therefore handles the former by

  taking a snapshot of ->expmask while the lock is held and the latter

  by applying READ_ONCE() to lockless reads and WRITE_ONCE() to the

  corresponding updates.


  Link: https://lore.kernel.org/lkml/CANpmjNNmSOagbTpffHr4=Yedckx9Rm2NuGqC9UqE+AOz5f1-ZQ@mail.gmail.com

  Reported-by: syzbot+134336b86f728d6e55a0@syzkaller.appspotmail.com

  Signed-off-by: Paul E. McKenney <paulmck@kernel.org>

  Acked-by: Marco Elver <elver@google.com>

  '
submodule:
- kernel/rcu
hunk_count: 8
covered_count: 4
