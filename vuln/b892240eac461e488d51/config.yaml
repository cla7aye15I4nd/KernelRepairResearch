id: b892240eac461e488d51
bug_link: https://syzkaller.appspot.com/bug?extid=b892240eac461e488d51
title: 'KASAN: slab-out-of-bounds Read in ntfs_trim_fs'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bfcdbae0523bd95eb75a739ffb6221a37109881e
fix_commit: 557d19675a470bb0a98beccec38c5dc3735c20fa
datetime: '2022-11-12T20:59:40+03:00'
fix_commit_message: 'fs/ntfs3: Fix slab-out-of-bounds read in ntfs_trim_fs


  Syzbot reports an out of bound access in ntfs_trim_fs.

  The cause of this is using a loop termination condition that compares

  window index (iw) with wnd->nbits instead of wnd->nwnd, due to which the

  index used for wnd->free_bits exceeds the size of the array allocated.


  Fix the loop condition.


  Fixes: 3f3b442b5ad2 ("fs/ntfs3: Add bitmap")

  Link: https://syzkaller.appspot.com/bug?extid=b892240eac461e488d51

  Reported-by: syzbot+b892240eac461e488d51@syzkaller.appspotmail.com

  Signed-off-by: Abdun Nihaal <abdun.nihaal@gmail.com>

  Signed-off-by: Konstantin Komarov <almaz.alexandrovich@paragon-software.com>

  '
submodule:
- fs/ntfs3
hunk_count: 1
covered_count: 1
