id: 32d4647f551007595173
bug_link: https://syzkaller.appspot.com/bug?extid=32d4647f551007595173
title: 'BUG: unable to handle kernel paging request in snd_pcm_format_set_silence
  (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7b9938a14460e8ec7649ca2e80ac0aae9815bf02
fix_commit: 93a81ca0657758b607c3f4ba889ae806be9beb73
datetime: '2025-05-16T10:09:02+02:00'
fix_commit_message: 'ALSA: pcm: Fix race of buffer access at PCM OSS layer


  The PCM OSS layer tries to clear the buffer with the silence data at

  initialization (or reconfiguration) of a stream with the explicit call

  of snd_pcm_format_set_silence() with runtime->dma_area.  But this may

  lead to a UAF because the accessed runtime->dma_area might be freed

  concurrently, as it''s performed outside the PCM ops.


  For avoiding it, move the code into the PCM core and perform it inside

  the buffer access lock, so that it won''t be changed during the

  operation.


  Reported-by: syzbot+32d4647f551007595173@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/68164d8e.050a0220.11da1b.0019.GAE@google.com

  Cc: <stable@vger.kernel.org>

  Link: https://patch.msgid.link/20250516080817.20068-1-tiwai@suse.de

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  '
submodule:
- include/sound
- sound/core
- sound/core/oss
hunk_count: 3
covered_count: 1
