id: d7b4dc6cd50410152534
bug_link: https://syzkaller.appspot.com/bug?extid=d7b4dc6cd50410152534
title: 'KMSAN: uninit-value in nci_rx_work'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cc563e749810f5636451d4b833fbd689899ecdb9
fix_commit: e4a87abf588536d1cdfb128595e6e680af5cf3ed
datetime: '2024-05-20T11:41:26+01:00'
fix_commit_message: 'nfc: nci: Fix uninit-value in nci_rx_work


  syzbot reported the following uninit-value access issue [1]


  nci_rx_work() parses received packet from ndev->rx_q. It should be

  validated header size, payload size and total packet size before

  processing the packet. If an invalid packet is detected, it should be

  silently discarded.


  Fixes: d24b03535e5e ("nfc: nci: Fix uninit-value in nci_dev_up and nci_ntf_packet")

  Reported-and-tested-by: syzbot+d7b4dc6cd50410152534@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=d7b4dc6cd50410152534 [1]

  Signed-off-by: Ryosuke Yasuoka <ryasuoka@redhat.com>

  Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/nfc
hunk_count: 2
covered_count: 1
