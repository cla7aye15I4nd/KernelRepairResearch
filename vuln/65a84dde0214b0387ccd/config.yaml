id: 65a84dde0214b0387ccd
bug_link: https://syzkaller.appspot.com/bug?extid=65a84dde0214b0387ccd
title: kernel BUG at drivers/vhost/vhost.c:LINE! (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7ced6c98c7ab7a1f6743931e28671b833af79b1e
fix_commit: d14d2b78090c7de0557362b26a4ca591aa6a9faa
datetime: '2018-04-11T10:54:06-04:00'
fix_commit_message: "vhost: fix vhost_vq_access_ok() log check\n\nCommit d65026c6c62e7d9616c8ceb5a53b68bcdc050525\
  \ (\"vhost: validate log\nwhen IOTLB is enabled\") introduced a regression.  The\
  \ logic was\noriginally:\n\n  if (vq->iotlb)\n      return 1;\n  return A && B;\n\
  \nAfter the patch the short-circuit logic for A was inverted:\n\n  if (A || vq->iotlb)\n\
  \      return A;\n  return B;\n\nThis patch fixes the regression by rewriting the\
  \ checks in the obvious\nway, no longer returning A when vq->iotlb is non-NULL (which\
  \ is hard to\nunderstand).\n\nReported-by: syzbot+65a84dde0214b0387ccd@syzkaller.appspotmail.com\n\
  Cc: Jason Wang <jasowang@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>\n\
  Acked-by: Michael S. Tsirkin <mst@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n"
submodule:
- drivers/vhost
hunk_count: 1
covered_count: 0
