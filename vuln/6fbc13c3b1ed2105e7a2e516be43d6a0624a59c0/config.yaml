id: 6fbc13c3b1ed2105e7a2e516be43d6a0624a59c0
bug_link: https://syzkaller.appspot.com/bug?extid=6fbc13c3b1ed2105e7a2e516be43d6a0624a59c0
title: 'KASAN: use-after-free Read in aead_recvmsg'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d2890c3778b164fde587bc16583f3a1c87233ec5
fix_commit: b32a7dc8aef1882fbf983eb354837488cc9d54dc
datetime: '2017-11-29T13:39:14+11:00'
fix_commit_message: 'crypto: algif_aead - fix reference counting of null skcipher


  In the AEAD interface for AF_ALG, the reference to the "null skcipher"

  held by each tfm was being dropped in the wrong place -- when each

  af_alg_ctx was freed instead of when the aead_tfm was freed.  As

  discovered by syzkaller, a specially crafted program could use this to

  cause the null skcipher to be freed while it is still in use.


  Fix it by dropping the reference in the right place.


  Fixes: 72548b093ee3 ("crypto: algif_aead - copy AAD from src to dst")

  Reported-by: syzbot <syzkaller@googlegroups.com>

  Cc: <stable@vger.kernel.org> # v4.14+

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Reviewed-by: Stephan Mueller <smueller@chronox.de>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 2
covered_count: 2
