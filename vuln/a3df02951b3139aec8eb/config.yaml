id: a3df02951b3139aec8eb
bug_link: https://syzkaller.appspot.com/bug?extid=a3df02951b3139aec8eb
title: WARNING in __bch2_fsck_err (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7c980a43e936e32741a62bf5a047c5f5ad572ec8
fix_commit: 5612daafb76420c6793dc48ce6d0c20f36cc7981
datetime: '2024-09-27T21:46:35-04:00'
fix_commit_message: 'bcachefs: Fix fsck warnings from bkey validation


  __bch2_fsck_err() warns if the current task has a btree_trans object and

  it wasn''t passed in, because if it has to prompt for user input it has

  to be able to unlock it.


  But plumbing the btree_trans through bkey_validate(), as well as

  transaction restarts, is problematic - so instead make bkey fsck errors

  FSCK_AUTOFIX, which doesn''t need to warn.


  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 2
covered_count: 1
