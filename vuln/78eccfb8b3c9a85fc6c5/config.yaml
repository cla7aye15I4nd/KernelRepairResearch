id: 78eccfb8b3c9a85fc6c5
bug_link: https://syzkaller.appspot.com/bug?extid=78eccfb8b3c9a85fc6c5
title: 'KMSAN: uninit-value in line6_midibuf_read'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 312c04cee408a8448ec8b639fe7f0434017d7161
fix_commit: 15b7a03205b31bc5623378c190d22b7ff60026f1
datetime: '2024-08-05T15:03:03+02:00'
fix_commit_message: 'ALSA: line6: Fix racy access to midibuf


  There can be concurrent accesses to line6 midibuf from both the URB

  completion callback and the rawmidi API access.  This could be a cause

  of KMSAN warning triggered by syzkaller below (so put as reported-by

  here).


  This patch protects the midibuf call of the former code path with a

  spinlock for avoiding the possible races.


  Reported-by: syzbot+78eccfb8b3c9a85fc6c5@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/00000000000000949c061df288c5@google.com

  Cc: <stable@vger.kernel.org>

  Link: https://patch.msgid.link/20240805130129.10872-1-tiwai@suse.de

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  '
submodule:
- sound/usb/line6
hunk_count: 2
covered_count: 2
