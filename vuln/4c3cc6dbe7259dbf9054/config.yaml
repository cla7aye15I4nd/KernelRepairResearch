id: 4c3cc6dbe7259dbf9054
bug_link: https://syzkaller.appspot.com/bug?extid=4c3cc6dbe7259dbf9054
title: 'KASAN: use-after-free Read in bitmap_port_ext_cleanup'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c9f53049d4a842db6bcd76f597759a0ef5f65c86
fix_commit: c120959387efa51479056fd01dc90adfba7a590c
datetime: '2020-01-13T18:53:59+01:00'
fix_commit_message: 'netfilter: fix a use-after-free in mtype_destroy()


  map->members is freed by ip_set_free() right before using it in

  mtype_ext_cleanup() again. So we just have to move it down.


  Reported-by: syzbot+4c3cc6dbe7259dbf9054@syzkaller.appspotmail.com

  Fixes: 40cd63bf33b2 ("netfilter: ipset: Support extensions which need a per data
  destroy function")

  Acked-by: Jozsef Kadlecsik <kadlec@netfilter.org>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 1
covered_count: 1
