id: 494c7ddf66acac0ad747
bug_link: https://syzkaller.appspot.com/bug?extid=494c7ddf66acac0ad747
title: general protection fault in do_move_mount
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 80f232121b69cc69a31ccb2b38c1665d770b0710
fix_commit: 05883eee857eab4693e7d13ebab06716475c5754
datetime: '2019-05-09T02:32:50-04:00'
fix_commit_message: 'do_move_mount(): fix an unsafe use of is_anon_ns()


  What triggers it is a race between mount --move and umount -l

  of the source; we should reject it (the source is parentless *and*

  not the root of anon namespace at that), but the check for namespace

  being an anon one is broken in that case - is_anon_ns() needs

  ns to be non-NULL.  Better fixed here than in is_anon_ns(), since

  the rest of the callers is guaranteed to get a non-NULL argument...


  Reported-by: syzbot+494c7ddf66acac0ad747@syzkaller.appspotmail.com

  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

  '
submodule:
- fs
hunk_count: 1
covered_count: 1
