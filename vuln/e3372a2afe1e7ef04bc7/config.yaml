id: e3372a2afe1e7ef04bc7
bug_link: https://syzkaller.appspot.com/bug?extid=e3372a2afe1e7ef04bc7
title: 'KASAN: use-after-free Read in vkms_dumb_create'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c27f0cc4d43a7f910e3cf779f44c470275604236
fix_commit: 0ea2ea42b31abc1141f2fd3911f952a97d401fcb
datetime: '2020-05-06T21:51:46-04:00'
fix_commit_message: 'drm/vkms: Hold gem object while still in-use


  We need to keep the reference to the drm_gem_object

  until the last access by vkms_dumb_create.


  Therefore, the put the object after it is used.


  This fixes a use-after-free issue reported by syzbot.


  While here, change vkms_gem_create() symbol to static.


  Reported-and-tested-by: syzbot+e3372a2afe1e7ef04bc7@syzkaller.appspotmail.com

  Signed-off-by: Ezequiel Garcia <ezequiel@collabora.com>

  Reviewed-by: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>

  Signed-off-by: Rodrigo Siqueira <rodrigosiqueiramelo@gmail.com>

  Link: https://patchwork.freedesktop.org/patch/msgid/20200427214405.13069-1-ezequiel@collabora.com

  '
submodule:
- drivers/gpu/drm/vkms
hunk_count: 4
covered_count: 3
