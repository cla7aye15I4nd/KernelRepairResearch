id: 3266db0c26d1fbbe3abb
bug_link: https://syzkaller.appspot.com/bug?extid=3266db0c26d1fbbe3abb
title: 'KMSAN: uninit-value in af_alg_free_sg (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 69fba378edcaffba7bc7d299fdee02e377069d30
fix_commit: 24c890dd712f6345e382256cae8c97abb0406b70
datetime: '2024-02-02T18:08:12+08:00'
fix_commit_message: 'crypto: algif_hash - Remove bogus SGL free on zero-length error
  path


  When a zero-length message is hashed by algif_hash, and an error

  is triggered, it tries to free an SG list that was never allocated

  in the first place.  Fix this by not freeing the SG list on the

  zero-length error path.


  Reported-by: Shigeru Yoshida <syoshida@redhat.com>

  Reported-by: xingwei lee <xrivendell7@gmail.com>

  Fixes: b6d972f68983 ("crypto: af_alg/hash: Fix recvmsg() after sendmsg(MSG_MORE)")

  Cc: <stable@vger.kernel.org>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  Reported-by: syzbot+3266db0c26d1fbbe3abb@syzkaller.appspotmail.com

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 2
covered_count: 2
