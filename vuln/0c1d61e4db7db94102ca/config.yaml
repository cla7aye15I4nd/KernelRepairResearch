id: 0c1d61e4db7db94102ca
bug_link: https://syzkaller.appspot.com/bug?extid=0c1d61e4db7db94102ca
title: WARNING in kmem_cache_create_usercopy
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 52ad259eaac0454c1ac7123e7148cf8d6e6f5301
fix_commit: 574d356b7a02c7e1b01a1d9cba8a26b3c2888f45
datetime: '2018-12-25T17:07:49+09:00'
fix_commit_message: '9p/net: put a lower bound on msize


  If the requested msize is too small (either from command line argument

  or from the server version reply), we won''t get any work done.

  If it''s *really* too small, nothing will work, and this got caught by

  syzbot recently (on a new kmem_cache_create_usercopy() call)


  Just set a minimum msize to 4k in both code paths, until someone

  complains they have a use-case for a smaller msize.


  We need to check in both mount option and server reply individually

  because the msize for the first version request would be unchecked

  with just a global check on clnt->msize.


  Link: http://lkml.kernel.org/r/1541407968-31350-1-git-send-email-asmadeus@codewreck.org

  Reported-by: syzbot+0c1d61e4db7db94102ca@syzkaller.appspotmail.com

  Signed-off-by: Dominique Martinet <dominique.martinet@cea.fr>

  Cc: Eric Van Hensbergen <ericvh@gmail.com>

  Cc: Latchesar Ionkov <lucho@ionkov.net>

  Cc: stable@vger.kernel.org

  '
submodule:
- net/9p
hunk_count: 3
covered_count: 1
