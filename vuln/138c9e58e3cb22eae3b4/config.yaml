id: 138c9e58e3cb22eae3b4
bug_link: https://syzkaller.appspot.com/bug?extid=138c9e58e3cb22eae3b4
title: general protection fault in ext4_fill_super
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4f98186848707f530669238d90e0562d92a78aab
fix_commit: 7c268d4ce2d3761f666a9950b029c8902bfab710
datetime: '2022-02-03T10:57:44-05:00'
fix_commit_message: 'ext4: fix potential NULL pointer dereference in ext4_fill_super()


  By mistake we fail to return an error from ext4_fill_super() in case

  that ext4_alloc_sbi() fails to allocate a new sbi. Instead we just set

  the ret variable and allow the function to continue which will later

  lead to a NULL pointer dereference. Fix it by returning -ENOMEM in the

  case ext4_alloc_sbi() fails.


  Fixes: cebe85d570cf ("ext4: switch to the new mount api")

  Reported-by: kernel test robot <lkp@intel.com>

  Reported-by: Dan Carpenter <dan.carpenter@oracle.com>

  Signed-off-by: Lukas Czerner <lczerner@redhat.com>

  Link: https://lore.kernel.org/r/20220119130209.40112-1-lczerner@redhat.com

  Signed-off-by: Theodore Ts''o <tytso@mit.edu>

  Cc: stable@kernel.org

  '
submodule:
- fs/ext4
hunk_count: 1
covered_count: 1
