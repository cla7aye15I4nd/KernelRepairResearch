id: c31a48e6702ccb3d64c9
bug_link: https://syzkaller.appspot.com/bug?extid=c31a48e6702ccb3d64c9
title: 'KASAN: out-of-bounds Read in leaf_paste_entries'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 728d392f8a799f037812d0f2b254fb3b5e115fcf
fix_commit: 13d257503c0930010ef9eed78b689cec417ab741
datetime: '2021-07-16T12:36:51+02:00'
fix_commit_message: 'reiserfs: check directory items on read from disk


  While verifying the leaf item that we read from the disk, reiserfs

  doesn''t check the directory items, this could cause a crash when we

  read a directory item from the disk that has an invalid deh_location.


  This patch adds a check to the directory items read from the disk that

  does a bounds check on deh_location for the directory entries. Any

  directory entry header with a directory entry offset greater than the

  item length is considered invalid.


  Link: https://lore.kernel.org/r/20210709152929.766363-1-chouhan.shreyansh630@gmail.com

  Reported-by: syzbot+c31a48e6702ccb3d64c9@syzkaller.appspotmail.com

  Signed-off-by: Shreyansh Chouhan <chouhan.shreyansh630@gmail.com>

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/reiserfs
hunk_count: 2
covered_count: 0
