id: 2ccea6339d368360800d
bug_link: https://syzkaller.appspot.com/bug?extid=2ccea6339d368360800d
title: WARNING in squashfs_read_table
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: eabac19e40c095543def79cb6ffeb3a8588aaff4
fix_commit: 506220d2ba21791314af569211ffd8870b8208fa
datetime: '2021-02-09T17:26:44-08:00'
fix_commit_message: "squashfs: add more sanity checks in xattr id lookup\n\nSysbot\
  \ has reported a warning where a kmalloc() attempt exceeds the\nmaximum limit. \
  \ This has been identified as corruption of the xattr_ids\ncount when reading the\
  \ xattr id lookup table.\n\nThis patch adds a number of additional sanity checks\
  \ to detect this\ncorruption and others.\n\n1. It checks for a corrupted xattr index\
  \ read from the inode.  This could\n   be because the metadata block is uncompressed,\
  \ or because the\n   \"compression\" bit has been corrupted (turning a compressed\
  \ block\n   into an uncompressed block).  This would cause an out of bounds read.\n\
  \n2. It checks against corruption of the xattr_ids count.  This can either\n   lead\
  \ to the above kmalloc failure, or a smaller than expected\n   table to be read.\n\
  \n3. It checks the contents of the index table for corruption.\n\n[phillip@squashfs.org.uk:\
  \ fix checkpatch issue]\n  Link: https://lkml.kernel.org/r/270245655.754655.1612770082682@webmail.123-reg.co.uk\n\
  \nLink: https://lkml.kernel.org/r/20210204130249.4495-5-phillip@squashfs.org.uk\n\
  Signed-off-by: Phillip Lougher <phillip@squashfs.org.uk>\nReported-by: syzbot+2ccea6339d368360800d@syzkaller.appspotmail.com\n\
  Cc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\n\
  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n"
submodule:
- fs/squashfs
hunk_count: 3
covered_count: 3
