id: afb726d49f84c8d95ee1
bug_link: https://syzkaller.appspot.com/bug?extid=afb726d49f84c8d95ee1
title: 'riscv/fixes boot error: kernel BUG in __phys_addr_symbol'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 420370f3ae3d3b883813fd3051a38805160b2b9f
fix_commit: c29fc621e1a49949a14c7fa031dd4760087bfb29
datetime: '2024-01-09T10:59:06-08:00'
fix_commit_message: 'riscv: Fix wrong usage of lm_alias() when splitting a huge linear
  mapping


  lm_alias() can only be used on kernel mappings since it explicitly uses

  __pa_symbol(), so simply fix this by checking where the address belongs

  to before.


  Fixes: 311cd2f6e253 ("riscv: Fix set_memory_XX() and set_direct_map_XX() by splitting
  huge linear mappings")

  Reported-by: syzbot+afb726d49f84c8d95ee1@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/linux-riscv/000000000000620dd0060c02c5e1@google.com/

  Signed-off-by: Alexandre Ghiti <alexghiti@rivosinc.com>

  Reviewed-by: Charlie Jenkins <charlie@rivosinc.com>

  Link: https://lore.kernel.org/r/20231212195400.128457-1-alexghiti@rivosinc.com

  Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>

  '
submodule:
- arch/riscv/mm
hunk_count: 1
covered_count: 1
