id: ef054c4d3f64cd7f7cec
bug_link: https://syzkaller.appspot.com/bug?extid=ef054c4d3f64cd7f7cec
title: WARNING in request_end
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d2d2d4fb1f54eff0f3faa9762d84f6446a4bc5d0
fix_commit: 4c316f2f3ff315cb48efb7435621e5bfb81df96d
datetime: '2018-09-28T16:43:22+02:00'
fix_commit_message: 'fuse: set FR_SENT while locked


  Otherwise fuse_dev_do_write() could come in and finish off the request, and

  the set_bit(FR_SENT, ...) could trigger the WARN_ON(test_bit(FR_SENT, ...))

  in request_end().


  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  Reported-by: syzbot+ef054c4d3f64cd7f7cec@syzkaller.appspotmai

  Fixes: 46c34a348b0a ("fuse: no fc->lock for pqueue parts")

  Cc: <stable@vger.kernel.org> # v4.2

  '
submodule:
- fs/fuse
hunk_count: 1
covered_count: 0
