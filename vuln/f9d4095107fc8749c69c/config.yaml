id: f9d4095107fc8749c69c
bug_link: https://syzkaller.appspot.com/bug?extid=f9d4095107fc8749c69c
title: memory leak in nf_tables_parse_netdev_hooks
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9332d27d7918182add34e8043f6a754530fdd022
fix_commit: cd77e75b5e4632d05d61fec5383052713c8ede2b
datetime: '2020-01-16T14:22:32+01:00'
fix_commit_message: 'netfilter: nf_tables: fix memory leak in nf_tables_parse_netdev_hooks()


  Syzbot detected a leak in nf_tables_parse_netdev_hooks().  If the hook

  already exists, then the error handling doesn''t free the newest "hook".


  Reported-by: syzbot+f9d4095107fc8749c69c@syzkaller.appspotmail.com

  Fixes: b75a3e8371bc ("netfilter: nf_tables: allow netdevice to be used only once
  per flowtable")

  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>

  Reviewed-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 1
covered_count: 1
