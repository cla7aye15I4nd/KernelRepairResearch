id: 5ea725c25d06fb9114c4
bug_link: https://syzkaller.appspot.com/bug?extid=5ea725c25d06fb9114c4
title: WARNING in __dev_queue_xmit
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3b1c31474cb934be352a8d75389bfe04773799c6
fix_commit: dc633700f00f726e027846a318c5ffeb8deaaeda
datetime: '2022-07-29T12:09:27+01:00'
fix_commit_message: 'net/af_packet: check len when min_header_len equals to 0


  User can use AF_PACKET socket to send packets with the length of 0.

  When min_header_len equals to 0, packet_snd will call __dev_queue_xmit

  to send packets, and sock->type can be any type.


  Reported-by: syzbot+5ea725c25d06fb9114c4@syzkaller.appspotmail.com

  Fixes: fd1894224407 ("bpf: Don''t redirect packets with invalid pkt_len")

  Signed-off-by: Zhengchao Shao <shaozhengchao@huawei.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/packet
hunk_count: 1
covered_count: 0
