id: 54fd8cca4b7226c94b8e
bug_link: https://syzkaller.appspot.com/bug?extid=54fd8cca4b7226c94b8e
title: 'KASAN: user-memory-access Write in video_usercopy'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e4b9b6454d94481483c435b94517249b79e82b63
fix_commit: 1dc8b65c944e5cfce3d830a5b97b42be185a1984
datetime: '2020-01-08T13:27:58+01:00'
fix_commit_message: 'media: v4l2-core: only zero-out ioctl-read buffers


  The memset() got moved out of the check for _IOC_NONE, so passing a

  made-up command number with a size but no direction would allow clearing

  data on user-provided pointers.


  Move video_get_user() back into the _IOC_NONE check where it belongs.


  Reported-by: syzbot+54fd8cca4b7226c94b8e@syzkaller.appspotmail.com

  Fixes: 6c625c01c7a6 ("media: v4l2-core: split out data copy from video_usercopy")

  Signed-off-by: Arnd Bergmann <arnd@arndb.de>

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

  '
submodule:
- drivers/media/v4l2-core
hunk_count: 1
covered_count: 1
