id: 9bb26e7c5e8e4fa7e641
bug_link: https://syzkaller.appspot.com/bug?extid=9bb26e7c5e8e4fa7e641
title: WARNING in exit_tasks_rcu_finish
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 434c9eefb959c36331a93617ea95df903469b99f
fix_commit: 0356d4e66214569de674ab2684f2e0b440a466ab
datetime: '2022-06-20T09:22:28-07:00'
fix_commit_message: 'rcu-tasks: Track blocked RCU Tasks Trace readers


  This commit places any task that has ever blocked within its current

  RCU Tasks Trace read-side critical section on a per-CPU list within the

  rcu_tasks_percpu structure.  Tasks are removed from this list when they

  exit by the exit_tasks_rcu_finish_trace() function.  The purpose of this

  commit is to provide the information needed to eliminate the current

  scan of the full task list.


  This commit offsets the INT_MIN value for ->trc_reader_nesting with the

  new nesting level in order to avoid queueing tasks that are exiting

  their read-side critical sections.


  [ paulmck: Apply kernel test robot feedback. ]

  [ paulmck: Apply feedback from syzbot+9bb26e7c5e8e4fa7e641@syzkaller.appspotmail.com
  ]


  Signed-off-by: Paul E. McKenney <paulmck@kernel.org>

  Tested-by: syzbot <syzbot+9bb26e7c5e8e4fa7e641@syzkaller.appspotmail.com>

  Tested-by: "Zhang, Qiang1" <qiang1.zhang@intel.com>

  Cc: Peter Zijlstra <peterz@infradead.org>

  Cc: Neeraj Upadhyay <quic_neeraju@quicinc.com>

  Cc: Eric Dumazet <edumazet@google.com>

  Cc: Alexei Starovoitov <ast@kernel.org>

  Cc: Andrii Nakryiko <andrii@kernel.org>

  Cc: Martin KaFai Lau <kafai@fb.com>

  Cc: KP Singh <kpsingh@kernel.org>

  '
submodule:
- include/linux
- kernel/rcu
hunk_count: 5
covered_count: 0
