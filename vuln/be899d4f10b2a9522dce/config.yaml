id: be899d4f10b2a9522dce
bug_link: https://syzkaller.appspot.com/bug?extid=be899d4f10b2a9522dce
title: possible deadlock in freeze_super (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 445cb1277e10d7e19b631ef8a64aa3f055df377d
fix_commit: b66f723bb552ad59c2acb5d45ea45c890f84498b
datetime: '2023-01-31T22:40:24+01:00'
fix_commit_message: 'gfs2: Improve gfs2_make_fs_rw error handling


  In gfs2_make_fs_rw(), make sure to call gfs2_consist() to report an

  inconsistency and mark the filesystem as withdrawn when

  gfs2_find_jhead() fails.


  At the end of gfs2_make_fs_rw(), when we discover that the filesystem

  has been withdrawn, make sure we report an error.  This also replaces

  the gfs2_withdrawn() check after gfs2_find_jhead().


  Reported-by: Tetsuo Handa <penguin-kernel@i-love.sakura.ne.jp>

  Cc: syzbot+f51cb4b9afbd87ec06f2@syzkaller.appspotmail.com

  Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>

  '
submodule:
- fs/gfs2
hunk_count: 2
covered_count: 0
