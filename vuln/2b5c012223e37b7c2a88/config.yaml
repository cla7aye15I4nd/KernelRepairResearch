id: 2b5c012223e37b7c2a88
bug_link: https://syzkaller.appspot.com/bug?extid=2b5c012223e37b7c2a88
title: 'KASAN: use-after-free Read in reiserfs_fill_super'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 8fca3c8a3451514c6f20dd26d5e66e78220d16e3
fix_commit: d24396c5290ba8ab04ba505176874c4e04a2d53c
datetime: '2020-11-26T16:57:28+01:00'
fix_commit_message: 'reiserfs: add check for an invalid ih_entry_count


  when directory item has an invalid value set for ih_entry_count it might

  trigger use-after-free or out-of-bounds read in bin_search_in_dir_item()


  ih_entry_count * IH_SIZE for directory item should not be larger than

  ih_item_len


  Link: https://lore.kernel.org/r/20201101140958.3650143-1-rkovhaev@gmail.com

  Reported-and-tested-by: syzbot+83b6f7cf9922cae5c4d7@syzkaller.appspotmail.com

  Link: https://syzkaller.appspot.com/bug?extid=83b6f7cf9922cae5c4d7

  Signed-off-by: Rustam Kovhaev <rkovhaev@gmail.com>

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/reiserfs
hunk_count: 1
covered_count: 0
