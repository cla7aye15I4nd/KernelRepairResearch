id: 3a030a73b6c1e9833815
bug_link: https://syzkaller.appspot.com/bug?extid=3a030a73b6c1e9833815
title: memory leak in v9fs_cache_session_get_cookie
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0ce772fe79b68f83df40f07f28207b292785c677
fix_commit: 962a991c5de18452d6c429d99f3039387cf5cbb0
datetime: '2019-09-03T11:07:39+00:00'
fix_commit_message: '9p/cache.c: Fix memory leak in v9fs_cache_session_get_cookie


  v9fs_cache_session_get_cookie assigns a random cachetag to v9ses->cachetag,

  if the cachetag is not assigned previously.


  v9fs_random_cachetag allocates memory to v9ses->cachetag with kmalloc and uses

  scnprintf to fill it up with a cachetag.


  But if scnprintf fails, v9ses->cachetag is not freed in the current

  code causing a memory leak.


  Fix this by freeing v9ses->cachetag it v9fs_random_cachetag fails.


  This was reported by syzbot, the link to the report is below:

  https://syzkaller.appspot.com/bug?id=f012bdf297a7a4c860c38a88b44fbee43fd9bbf3


  Link: http://lkml.kernel.org/r/20190522194519.GA5313@bharath12345-Inspiron-5559

  Reported-by: syzbot+3a030a73b6c1e9833815@syzkaller.appspotmail.com

  Signed-off-by: Bharath Vedartham <linux.bhar@gmail.com>

  Signed-off-by: Dominique Martinet <dominique.martinet@cea.fr>

  '
submodule:
- fs/9p
hunk_count: 1
covered_count: 1
