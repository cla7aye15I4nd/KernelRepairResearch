id: b055b1a6b2b958707a21
bug_link: https://syzkaller.appspot.com/bug?extid=b055b1a6b2b958707a21
title: 'KASAN: stack-out-of-bounds Write in mpol_to_str'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d888fb2b189be07df1656a31930b11a62ae88e58
fix_commit: aa9f7d5172fac9bf1f09e678c35e287a40a7b7dd
datetime: '2020-04-02T09:35:32-07:00'
fix_commit_message: 'mm: mempolicy: require at least one nodeid for MPOL_PREFERRED


  Using an empty (malformed) nodelist that is not caught during mount option

  parsing leads to a stack-out-of-bounds access.


  The option string that was used was: "mpol=prefer:,".  However,

  MPOL_PREFERRED requires a single node number, which is not being provided

  here.


  Add a check that ''nodes'' is not empty after parsing for MPOL_PREFERRED''s

  nodeid.


  Fixes: 095f1fc4ebf3 ("mempolicy: rework shmem mpol parsing and display")

  Reported-by: Entropy Moe <3ntr0py1337@gmail.com>

  Reported-by: syzbot+b055b1a6b2b958707a21@syzkaller.appspotmail.com

  Signed-off-by: Randy Dunlap <rdunlap@infradead.org>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  Tested-by: syzbot+b055b1a6b2b958707a21@syzkaller.appspotmail.com

  Cc: Lee Schermerhorn <lee.schermerhorn@hp.com>

  Link: http://lkml.kernel.org/r/89526377-7eb6-b662-e1d8-4430928abde9@infradead.org

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 2
covered_count: 2
