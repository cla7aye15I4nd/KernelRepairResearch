id: 2643e825238d7aabb37f
bug_link: https://syzkaller.appspot.com/bug?extid=2643e825238d7aabb37f
title: 'UBSAN: array-index-out-of-bounds in dquot_resume'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d24396c5290ba8ab04ba505176874c4e04a2d53c
fix_commit: e51d68e76d604c6d5d1eb13ae1d6da7f6c8c0dfc
datetime: '2020-12-09T10:07:10+01:00'
fix_commit_message: 'fs: quota: fix array-index-out-of-bounds bug by passing correct
  argument to vfs_cleanup_quota_inode()


  When dquot_resume() was last updated, the argument that got passed

  to vfs_cleanup_quota_inode was incorrectly set.


  If type = -1 and dquot_load_quota_sb() returns a negative value,

  then vfs_cleanup_quota_inode() gets called with -1 passed as an

  argument, and this leads to an array-index-out-of-bounds bug.


  Fix this issue by correctly passing the arguments.


  Fixes: ae45f07d47cc ("quota: Simplify dquot_resume()")

  Link: https://lore.kernel.org/r/20201208194338.7064-1-anant.thazhemadam@gmail.com

  Reported-by: syzbot+2643e825238d7aabb37f@syzkaller.appspotmail.com

  Tested-by: syzbot+2643e825238d7aabb37f@syzkaller.appspotmail.com

  CC: stable@vger.kernel.org

  Signed-off-by: Anant Thazhemadam <anant.thazhemadam@gmail.com>

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/quota
hunk_count: 1
covered_count: 1
