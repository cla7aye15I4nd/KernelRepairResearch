id: 96523fb438937cd01220
bug_link: https://syzkaller.appspot.com/bug?extid=96523fb438937cd01220
title: 'UBSAN: shift-out-of-bounds in strset_parse_request'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f87675b836b324d270fd52f1f5e6d6bb9f4bd1d5
fix_commit: efb796f5571f030743e1d9c662cdebdad724f8c5
datetime: '2020-12-16T11:15:11-08:00'
fix_commit_message: 'ethtool: fix string set id check


  Syzbot reported a shift of a u32 by more than 31 in strset_parse_request()

  which is undefined behavior. This is caused by range check of string set id

  using variable ret (which is always 0 at this point) instead of id (string

  set id from request).


  Fixes: 71921690f974 ("ethtool: provide string sets with STRSET_GET request")

  Reported-by: syzbot+96523fb438937cd01220@syzkaller.appspotmail.com

  Signed-off-by: Michal Kubecek <mkubecek@suse.cz>

  Link: https://lore.kernel.org/r/b54ed5c5fd972a59afea3e1badfb36d86df68799.1607952208.git.mkubecek@suse.cz

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- net/ethtool
hunk_count: 1
covered_count: 1
