id: cdb9a427d1bc08815104
bug_link: https://syzkaller.appspot.com/bug?extid=cdb9a427d1bc08815104
title: memory leak in virtual_ncidev_write
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 8427fd100c7b7793650e212a81e42f1cf124613d
fix_commit: 53270fb0fd77fe786d8c07a0793981d797836b93
datetime: '2022-11-22T12:42:23+01:00'
fix_commit_message: "NFC: nci: fix memory leak in nci_rx_data_packet()\n\nSyzbot reported\
  \ a memory leak about skb:\n\nunreferenced object 0xffff88810e144e00 (size 240):\n\
  \  comm \"syz-executor284\", pid 3701, jiffies 4294952403 (age 12.620s)\n  hex dump\
  \ (first 32 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n\
  \    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n\
  \    [<ffffffff83ab79a9>] __alloc_skb+0x1f9/0x270 net/core/skbuff.c:497\n    [<ffffffff82a5cf64>]\
  \ alloc_skb include/linux/skbuff.h:1267 [inline]\n    [<ffffffff82a5cf64>] virtual_ncidev_write+0x24/0xe0\
  \ drivers/nfc/virtual_ncidev.c:116\n    [<ffffffff815f6503>] do_loop_readv_writev\
  \ fs/read_write.c:759 [inline]\n    [<ffffffff815f6503>] do_loop_readv_writev fs/read_write.c:743\
  \ [inline]\n    [<ffffffff815f6503>] do_iter_write+0x253/0x300 fs/read_write.c:863\n\
  \    [<ffffffff815f66ed>] vfs_writev+0xdd/0x240 fs/read_write.c:934\n    [<ffffffff815f68f6>]\
  \ do_writev+0xa6/0x1c0 fs/read_write.c:977\n    [<ffffffff848802d5>] do_syscall_x64\
  \ arch/x86/entry/common.c:50 [inline]\n    [<ffffffff848802d5>] do_syscall_64+0x35/0xb0\
  \ arch/x86/entry/common.c:80\n    [<ffffffff84a00087>] entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\
  \nIn nci_rx_data_packet(), if we don't get a valid conn_info, we will return\ndirectly\
  \ but forget to release the skb.\n\nReported-by: syzbot+cdb9a427d1bc08815104@syzkaller.appspotmail.com\n\
  Fixes: 4aeee6871e8c (\"NFC: nci: Add dynamic logical connections support\")\nSigned-off-by:\
  \ Liu Shixin <liushixin2@huawei.com>\nLink: https://lore.kernel.org/r/20221118082419.239475-1-liushixin2@huawei.com\n\
  Signed-off-by: Paolo Abeni <pabeni@redhat.com>\n"
submodule:
- net/nfc
hunk_count: 1
covered_count: 0
