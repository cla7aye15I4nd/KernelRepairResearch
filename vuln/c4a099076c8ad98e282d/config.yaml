id: c4a099076c8ad98e282d
bug_link: https://syzkaller.appspot.com/bug?extid=c4a099076c8ad98e282d
title: general protection fault in __nf_tables_chain_type_lookup
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c83de17dd6308fb74696923e5245de0e3c427206
fix_commit: 826035498ec14b77b62a44f0cb6b94d45530db6f
datetime: '2020-01-24T20:54:28+01:00'
fix_commit_message: 'netfilter: nf_tables: add __nft_chain_type_get()


  This new helper function validates that unknown family and chain type

  coming from userspace do not trigger an out-of-bound array access. Bail

  out in case __nft_chain_type_get() returns NULL from

  nft_chain_parse_hook().


  Fixes: 9370761c56b6 ("netfilter: nf_tables: convert built-in tables/chains to chain
  types")

  Reported-by: syzbot+156a04714799b1d480bc@syzkaller.appspotmail.com

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 3
covered_count: 2
