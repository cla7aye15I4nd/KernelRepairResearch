id: 37b8770e6d5a8220a039
bug_link: https://syzkaller.appspot.com/bug?extid=37b8770e6d5a8220a039
title: 'KASAN: use-after-free Read in tcf_block_find'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a1fa80802cb02cb043fd61b87bc81c06a38b4bb1
fix_commit: 460b360104d51552a57f39e54b2589c9fd7fa0b3
datetime: '2018-10-01T23:09:41-07:00'
fix_commit_message: 'net_sched: fix a crash in tc_new_tfilter()


  When tcf_block_find() fails, it already rollbacks the qdisc refcnt,

  so its caller doesn''t need to clean up this again. Avoid calling

  qdisc_put() again by resetting qdisc to NULL for callers.


  Reported-by: syzbot+37b8770e6d5a8220a039@syzkaller.appspotmail.com

  Fixes: e368fdb61d8e ("net: sched: use Qdisc rcu API instead of relying on rtnl lock")

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/sched
hunk_count: 1
covered_count: 0
