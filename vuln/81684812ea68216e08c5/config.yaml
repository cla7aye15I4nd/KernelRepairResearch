id: 81684812ea68216e08c5
bug_link: https://syzkaller.appspot.com/bug?extid=81684812ea68216e08c5
title: kernel BUG in f2fs_init_xattr_caches
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0495e337b7039191dfce6e03f5f830454b1fae6b
fix_commit: 7e9c323c52b379d261a72dc7bd38120a761a93cd
datetime: '2022-09-08T23:27:01+02:00'
fix_commit_message: "mm/slub: fix to return errno if kmalloc() fails\n\nIn create_unique_id(),\
  \ kmalloc(, GFP_KERNEL) can fail due to\nout-of-memory, if it fails, return errno\
  \ correctly rather than\ntriggering panic via BUG_ON();\n\nkernel BUG at mm/slub.c:5893!\n\
  Internal error: Oops - BUG: 0 [#1] PREEMPT SMP\n\nCall trace:\n sysfs_slab_add+0x258/0x260\
  \ mm/slub.c:5973\n __kmem_cache_create+0x60/0x118 mm/slub.c:4899\n create_cache\
  \ mm/slab_common.c:229 [inline]\n kmem_cache_create_usercopy+0x19c/0x31c mm/slab_common.c:335\n\
  \ kmem_cache_create+0x1c/0x28 mm/slab_common.c:390\n f2fs_kmem_cache_create fs/f2fs/f2fs.h:2766\
  \ [inline]\n f2fs_init_xattr_caches+0x78/0xb4 fs/f2fs/xattr.c:808\n f2fs_fill_super+0x1050/0x1e0c\
  \ fs/f2fs/super.c:4149\n mount_bdev+0x1b8/0x210 fs/super.c:1400\n f2fs_mount+0x44/0x58\
  \ fs/f2fs/super.c:4512\n legacy_get_tree+0x30/0x74 fs/fs_context.c:610\n vfs_get_tree+0x40/0x140\
  \ fs/super.c:1530\n do_new_mount+0x1dc/0x4e4 fs/namespace.c:3040\n path_mount+0x358/0x914\
  \ fs/namespace.c:3370\n do_mount fs/namespace.c:3383 [inline]\n __do_sys_mount fs/namespace.c:3591\
  \ [inline]\n __se_sys_mount fs/namespace.c:3568 [inline]\n __arm64_sys_mount+0x2f8/0x408\
  \ fs/namespace.c:3568\n\nCc: <stable@kernel.org>\nFixes: 81819f0fc8285 (\"SLUB core\"\
  )\nReported-by: syzbot+81684812ea68216e08c5@syzkaller.appspotmail.com\nReviewed-by:\
  \ Muchun Song <songmuchun@bytedance.com>\nReviewed-by: Hyeonggon Yoo <42.hyeyoo@gmail.com>\n\
  Signed-off-by: Chao Yu <chao.yu@oppo.com>\nAcked-by: David Rientjes <rientjes@google.com>\n\
  Signed-off-by: Vlastimil Babka <vbabka@suse.cz>\n"
submodule:
- mm
hunk_count: 2
covered_count: 2
