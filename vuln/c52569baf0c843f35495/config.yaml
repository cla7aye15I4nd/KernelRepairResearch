id: c52569baf0c843f35495
bug_link: https://syzkaller.appspot.com/bug?extid=c52569baf0c843f35495
title: 'UBSAN: array-index-out-of-bounds in usbhid_parse'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 5e06802b426baa2d3c2a5d7784a6d4c2a9338c3e
fix_commit: fe7f7ac8e0c708446ff017453add769ffc15deed
datetime: '2025-04-24T11:31:25+02:00'
fix_commit_message: 'HID: usbhid: Eliminate recurrent out-of-bounds bug in usbhid_parse()


  Update struct hid_descriptor to better reflect the mandatory and

  optional parts of the HID Descriptor as per USB HID 1.11 specification.

  Note: the kernel currently does not parse any optional HID class

  descriptors, only the mandatory report descriptor.


  Update all references to member element desc[0] to rpt_desc.


  Add test to verify bLength and bNumDescriptors values are valid.


  Replace the for loop with direct access to the mandatory HID class

  descriptor member for the report descriptor. This eliminates the

  possibility of getting an out-of-bounds fault.


  Add a warning message if the HID descriptor contains any unsupported

  optional HID class descriptors.


  Reported-by: syzbot+c52569baf0c843f35495@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=c52569baf0c843f35495

  Fixes: f043bfc98c19 ("HID: usbhid: fix out-of-bounds bug")

  Cc: stable@vger.kernel.org

  Signed-off-by: Terry Junge <linuxhid@cosmicgizmosystems.com>

  Reviewed-by: Michael Kelley <mhklinux@outlook.com>

  Signed-off-by: Jiri Kosina <jkosina@suse.com>

  '
submodule:
- drivers/hid
- drivers/hid/usbhid
- drivers/usb/gadget/function
- include/linux
hunk_count: 9
covered_count: 3
