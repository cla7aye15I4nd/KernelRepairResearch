id: 221cc24572a2fed23b6b
bug_link: https://syzkaller.appspot.com/bug?extid=221cc24572a2fed23b6b
title: 'BUG: unable to handle kernel paging request in io_wq_cancel_all'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 842f96124c5617b060cc0f071dcfb6ab24bdd042
fix_commit: 975c99a570967dd48e917dd7853867fee3febabd
datetime: '2019-10-30T08:42:56-06:00'
fix_commit_message: 'io_uring: io_wq_create() returns an error pointer, not NULL


  syzbot reported an issue where we crash at setup time if failslab is

  used. The issue is that io_wq_create() returns an error pointer on

  failure, not NULL. Hence io_uring thought the io-wq was setup just

  fine, but in reality it''s a garbage error pointer.


  Use IS_ERR() instead of a NULL check, and assign ret appropriately.


  Reported-by: syzbot+221cc24572a2fed23b6b@syzkaller.appspotmail.com

  Fixes: 561fb04a6a22 ("io_uring: replace workqueue usage with io-wq")

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 1
covered_count: 0
