id: 576cc007eb9f2c968200
bug_link: https://syzkaller.appspot.com/bug?extid=576cc007eb9f2c968200
title: 'KCSAN: data-race in __snd_rawmidi_transmit_ack / snd_rawmidi_write'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dc7497795e014d84699c3b8809ed6df35352dd74
fix_commit: dfa9a5efe8b932a84b3b319250aa3ac60c20f876
datetime: '2020-02-14T15:53:19+01:00'
fix_commit_message: 'ALSA: rawmidi: Avoid bit fields for state flags


  The rawmidi state flags (opened, append, active_sensing) are stored in

  bit fields that can be potentially racy when concurrently accessed

  without any locks.  Although the current code should be fine, there is

  also no any real benefit by keeping the bitfields for this kind of

  short number of members.


  This patch changes those bit fields flags to the simple bool fields.

  There should be no size increase of the snd_rawmidi_substream by this

  change.


  Reported-by: syzbot+576cc007eb9f2c968200@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20200214111316.26939-4-tiwai@suse.de

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  '
submodule:
- include/sound
hunk_count: 1
covered_count: 0
