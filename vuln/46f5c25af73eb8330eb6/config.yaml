id: 46f5c25af73eb8330eb6
bug_link: https://syzkaller.appspot.com/bug?extid=46f5c25af73eb8330eb6
title: divide error in dbNextAG
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b47d5a4f6b8d42f8a8fbe891b36215e4fddc53be
fix_commit: 2cc7cc01c15f57d056318c33705647f87dcd4aab
datetime: '2022-03-22T10:09:13-05:00'
fix_commit_message: 'jfs: fix divide error in dbNextAG


  Syzbot reported divide error in dbNextAG(). The problem was in missing

  validation check for malicious image.


  Syzbot crafted an image with bmp->db_numag equal to 0. There wasn''t any

  validation checks, but dbNextAG() blindly use bmp->db_numag in divide

  expression


  Fix it by validating bmp->db_numag in dbMount() and return an error if

  image is malicious


  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Reported-and-tested-by: syzbot+46f5c25af73eb8330eb6@syzkaller.appspotmail.com

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Dave Kleikamp <dave.kleikamp@oracle.com>

  '
submodule:
- fs/jfs
hunk_count: 2
covered_count: 0
