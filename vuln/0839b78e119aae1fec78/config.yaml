id: 0839b78e119aae1fec78
bug_link: https://syzkaller.appspot.com/bug?extid=0839b78e119aae1fec78
title: 'UBSAN: shift-out-of-bounds in nci_activate_target'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e2bca4870fdaf855651ee80b083d892599c5d982
fix_commit: 354a6e707e29cb0c007176ee5b8db8be7bd2dee0
datetime: '2023-10-12T09:32:10+02:00'
fix_commit_message: 'nfc: nci: assert requested protocol is valid


  The protocol is used in a bit mask to determine if the protocol is

  supported. Assert the provided protocol is less than the maximum

  defined so it doesn''t potentially perform a shift-out-of-bounds and

  provide a clearer error for undefined protocols vs unsupported ones.


  Fixes: 6a2968aaf50c ("NFC: basic NCI protocol implementation")

  Reported-and-tested-by: syzbot+0839b78e119aae1fec78@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=0839b78e119aae1fec78

  Signed-off-by: Jeremy Cline <jeremy@jcline.org>

  Reviewed-by: Simon Horman <horms@kernel.org>

  Link: https://lore.kernel.org/r/20231009200054.82557-1-jeremy@jcline.org

  Signed-off-by: Paolo Abeni <pabeni@redhat.com>

  '
submodule:
- net/nfc
hunk_count: 1
covered_count: 1
