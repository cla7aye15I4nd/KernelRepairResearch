id: 1f53a30781af65d2c955
bug_link: https://syzkaller.appspot.com/bug?extid=1f53a30781af65d2c955
title: 'KMSAN: uninit-value in mii_nway_restart'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ad98426a88aa8b982b4785760bc56970b3f58281
fix_commit: 8f8abb863fa5a4cc18955c6a0e17af0ded3e4a76
datetime: '2023-10-10T20:08:11-07:00'
fix_commit_message: 'net: usb: dm9601: fix uninitialized variable use in dm9601_mdio_read


  syzbot has found an uninit-value bug triggered by the dm9601 driver [1].


  This error happens because the variable res is not updated if the call

  to dm_read_shared_word returns an error. In this particular case -EPROTO

  was returned and res stayed uninitialized.


  This can be avoided by checking the return value of dm_read_shared_word

  and propagating the error if the read operation failed.


  [1] https://syzkaller.appspot.com/bug?extid=1f53a30781af65d2c955


  Cc: stable@vger.kernel.org

  Signed-off-by: Javier Carrasco <javier.carrasco.cruz@gmail.com>

  Reported-and-tested-by: syzbot+1f53a30781af65d2c955@syzkaller.appspotmail.com

  Acked-by: Peter Korsgaard <peter@korsgaard.com>

  Fixes: d0374f4f9c35cdfbee0 ("USB: Davicom DM9601 usbnet driver")

  Link: https://lore.kernel.org/r/20231009-topic-dm9601_uninit_mdio_read-v2-1-f2fe39739b6c@gmail.com

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- drivers/net/usb
hunk_count: 1
covered_count: 1
