id: ae4dc916da3ce51f284f
bug_link: https://syzkaller.appspot.com/bug?extid=ae4dc916da3ce51f284f
title: 'UBSAN: shift-out-of-bounds in __bch2_bkey_invalid'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f39055220f6f98a180e3503fe05bbf9921c425c8
fix_commit: 2bb9600d5d4735953c47dd1ee99382c68dd04caa
datetime: '2024-05-06T10:58:17-04:00'
fix_commit_message: 'bcachefs: Guard against unknown k.k->type in __bkey_invalid()


  For forwards compatibility we have to allow unknown key types, and only

  run the checks that make sense against them.


  Fix a missing guard on k.k->type being known.


  Reported-by: syzbot+ae4dc916da3ce51f284f@syzkaller.appspotmail.com

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 1
covered_count: 1
