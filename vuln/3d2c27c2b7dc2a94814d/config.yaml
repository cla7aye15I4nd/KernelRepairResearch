id: 3d2c27c2b7dc2a94814d
bug_link: https://syzkaller.appspot.com/bug?extid=3d2c27c2b7dc2a94814d
title: WARNING in iov_iter_revert (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2c405d1ab8b3103df2df541aaacc2113dc6c9fac
fix_commit: 3342ff2698e9720f4040cc458a2744b2b32f5c3a
datetime: '2021-02-20T21:15:00-08:00'
fix_commit_message: 'tty: protect tty_write from odd low-level tty disciplines


  Al root-caused a new warning from syzbot to the ttyprintk tty driver

  returning a write count larger than the data the tty layer actually gave

  it.  Which confused the tty write code mightily, and with the new

  iov_iter based code, caused a WARNING in iov_iter_revert().


  syzbot correctly bisected the source of the new warning to commit

  9bb48c82aced ("tty: implement write_iter"), but the oddity goes back

  much further, it just didn''t get caught by anything before.


  Reported-by: syzbot+3d2c27c2b7dc2a94814d@syzkaller.appspotmail.com

  Fixes: 9bb48c82aced ("tty: implement write_iter")

  Debugged-by: Al Viro <viro@zeniv.linux.org.uk>

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- drivers/tty
hunk_count: 1
covered_count: 1
