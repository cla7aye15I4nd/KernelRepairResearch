id: d9aab50b1154e3d163f5
bug_link: https://syzkaller.appspot.com/bug?extid=d9aab50b1154e3d163f5
title: memory leak in erase_aeb (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: fcf44196305788b173748356a4f3ac2630454ba0
fix_commit: 3b185255bb2f34fa6927619b9ef27f192a3d9f5a
datetime: '2020-08-02T23:56:13+02:00'
fix_commit_message: "ubi: fastmap: Don't produce the initial next anchor PEB when\
  \ fastmap is disabled\n\nFollowing process triggers a memleak caused by forgetting\
  \ to release the\ninitial next anchor PEB (CONFIG_MTD_UBI_FASTMAP is disabled):\n\
  1. attach -> __erase_worker -> produce the initial next anchor PEB\n2. detach ->\
  \ ubi_fastmap_close (Do nothing, it should have released the\n   initial next anchor\
  \ PEB)\n\nDon't produce the initial next anchor PEB in __erase_worker() when fastmap\n\
  is disabled.\n\nSigned-off-by: Zhihao Cheng <chengzhihao1@huawei.com>\nSuggested-by:\
  \ Sascha Hauer <s.hauer@pengutronix.de>\nFixes: f9c34bb529975fe (\"ubi: Fix producing\
  \ anchor PEBs\")\nReported-by: syzbot+d9aab50b1154e3d163f5@syzkaller.appspotmail.com\n\
  Signed-off-by: Richard Weinberger <richard@nod.at>\n"
submodule:
- drivers/mtd/ubi
hunk_count: 1
covered_count: 0
