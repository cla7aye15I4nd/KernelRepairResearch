id: 7022ab7c383875c17eff
bug_link: https://syzkaller.appspot.com/bug?extid=7022ab7c383875c17eff
title: general protection fault in macsec_upd_offload
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: db1f00fb8ff793889e83f2e37e0c7bbb6fc9934e
fix_commit: aa81700cf2326e288c9ca1fe7b544039617f1fc2
datetime: '2020-04-06T10:26:08-07:00'
fix_commit_message: 'macsec: fix NULL dereference in macsec_upd_offload()


  macsec_upd_offload() gets the value of MACSEC_OFFLOAD_ATTR_TYPE

  without checking its presence in the request message, and this causes

  a NULL dereference. Fix it rejecting any configuration that does not

  include this attribute.


  Reported-and-tested-by: syzbot+7022ab7c383875c17eff@syzkaller.appspotmail.com

  Fixes: dcb780fb2795 ("net: macsec: add nla support for changing the offloading selection")

  Signed-off-by: Davide Caratti <dcaratti@redhat.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net
hunk_count: 1
covered_count: 1
