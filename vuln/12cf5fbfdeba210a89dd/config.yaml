id: 12cf5fbfdeba210a89dd
bug_link: https://syzkaller.appspot.com/bug?extid=12cf5fbfdeba210a89dd
title: general protection fault in crypto_destroy_tfm
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 98b5ef3e97b16eaeeedb936f8bda3594ff84a70e
fix_commit: 83681f2bebb34dbb3f03fecd8f570308ab8b7c2c
datetime: '2021-03-13T00:04:01+11:00'
fix_commit_message: 'crypto: api - check for ERR pointers in crypto_destroy_tfm()


  Given that crypto_alloc_tfm() may return ERR pointers, and to avoid

  crashes on obscure error paths where such pointers are presented to

  crypto_destroy_tfm() (such as [0]), add an ERR_PTR check there

  before dereferencing the second argument as a struct crypto_tfm

  pointer.


  [0] https://lore.kernel.org/linux-crypto/000000000000de949705bc59e0f6@google.com/


  Reported-by: syzbot+12cf5fbfdeba210a89dd@syzkaller.appspotmail.com

  Reviewed-by: Eric Biggers <ebiggers@google.com>

  Signed-off-by: Ard Biesheuvel <ardb@kernel.org>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
- include/crypto
hunk_count: 9
covered_count: 2
