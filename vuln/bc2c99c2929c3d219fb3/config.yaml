id: bc2c99c2929c3d219fb3
bug_link: https://syzkaller.appspot.com/bug?extid=bc2c99c2929c3d219fb3
title: WARNING in hashtab_init
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 951b2de06a0bd64930949c7d3bd5a113cdf24189
fix_commit: 9ab71d9204c32a9814d38528d066fdf6fa128604
datetime: '2025-06-19T17:24:57-04:00'
fix_commit_message: 'selinux: add __GFP_NOWARN to hashtab_init() allocations


  As reported by syzbot, hashtab_init() can be affected by abnormally

  large policy loads which would cause the kernel''s allocator to emit

  a warning in some configurations.  Since the SELinux hashtab_init()

  code handles the case where the allocation fails, due to a large

  request or some other reason, we can safely add the __GFP_NOWARN flag

  to squelch these abnormally large allocation warnings.


  Reported-by: syzbot+bc2c99c2929c3d219fb3@syzkaller.appspotmail.com

  Tested-by: syzbot+bc2c99c2929c3d219fb3@syzkaller.appspotmail.com

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  '
submodule:
- security/selinux/ss
hunk_count: 1
covered_count: 1
