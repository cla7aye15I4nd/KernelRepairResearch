id: a4055c78774bbf3498bb
bug_link: https://syzkaller.appspot.com/bug?extid=a4055c78774bbf3498bb
title: general protection fault in ovl_dentry_upper
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: eb7081409f94a9a8608593d0fb63a1aa3d6f95d8
fix_commit: 672e4268b2863d7e4978dfed29552b31c2f9bd4e
datetime: '2022-11-28T11:33:05+01:00'
fix_commit_message: 'ovl: fix use inode directly in rcu-walk mode


  ovl_dentry_revalidate_common() can be called in rcu-walk mode.  As document

  said, "in rcu-walk mode, d_parent and d_inode should not be used without

  care".


  Check inode here to protect access under rcu-walk mode.


  Fixes: bccece1ead36 ("ovl: allow remote upper")

  Reported-and-tested-by: syzbot+a4055c78774bbf3498bb@syzkaller.appspotmail.com

  Signed-off-by: Chen Zhongjin <chenzhongjin@huawei.com>

  Cc: <stable@vger.kernel.org> # v5.7

  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  '
submodule:
- fs/overlayfs
hunk_count: 1
covered_count: 1
