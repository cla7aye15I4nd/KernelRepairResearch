id: 9de458f6a5e713ee8c1a
bug_link: https://syzkaller.appspot.com/bug?extid=9de458f6a5e713ee8c1a
title: 'WARNING: inconsistent lock state'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d848e5f8e1ebdb227d045db55fe4f825e82965fa
fix_commit: 6c1e851c4edc13a43adb3ea4044e3fc8f43ccf7d
datetime: '2018-04-24T12:00:08-04:00'
fix_commit_message: 'random: fix possible sleeping allocation from irq context


  We can do a sleeping allocation from an irq context when CONFIG_NUMA

  is enabled.  Fix this by initializing the NUMA crng instances in a

  workqueue.


  Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Reported-by: syzbot+9de458f6a5e713ee8c1a@syzkaller.appspotmail.com

  Fixes: 8ef35c866f8862df ("random: set up the NUMA crng instances...")

  Cc: stable@vger.kernel.org

  Signed-off-by: Theodore Ts''o <tytso@mit.edu>

  '
submodule:
- drivers/char
hunk_count: 2
covered_count: 2
