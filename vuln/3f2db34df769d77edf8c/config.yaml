id: 3f2db34df769d77edf8c
bug_link: https://syzkaller.appspot.com/bug?extid=3f2db34df769d77edf8c
title: 'INFO: rcu detected stall in __se_sys_mount'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 286377f6bdf71568a4cf07104fe44006ae0dba6d
fix_commit: 1d0e850a49a5b56f8f3cb51e74a11e2fedb96be6
datetime: '2020-10-16T14:38:26+01:00'
fix_commit_message: 'afs: Fix cell removal


  Fix cell removal by inserting a more final state than AFS_CELL_FAILED that

  indicates that the cell has been unpublished in case the manager is already

  requeued and will go through again.  The new AFS_CELL_REMOVED state will

  just immediately leave the manager function.


  Going through a second time in the AFS_CELL_FAILED state will cause it to

  try to remove the cell again, potentially leading to the proc list being

  removed.


  Fixes: 989782dcdc91 ("afs: Overhaul cell database management")

  Reported-by: syzbot+b994ecf2b023f14832c1@syzkaller.appspotmail.com

  Reported-by: syzbot+0e0db88e1eb44a91ae8d@syzkaller.appspotmail.com

  Reported-by: syzbot+2d0585e5efcd43d113c2@syzkaller.appspotmail.com

  Reported-by: syzbot+1ecc2f9d3387f1d79d42@syzkaller.appspotmail.com

  Reported-by: syzbot+18d51774588492bf3f69@syzkaller.appspotmail.com

  Reported-by: syzbot+a5e4946b04d6ca8fa5f3@syzkaller.appspotmail.com

  Suggested-by: Hillf Danton <hdanton@sina.com>

  Signed-off-by: David Howells <dhowells@redhat.com>

  cc: Hillf Danton <hdanton@sina.com>

  '
submodule:
- fs/afs
hunk_count: 5
covered_count: 1
