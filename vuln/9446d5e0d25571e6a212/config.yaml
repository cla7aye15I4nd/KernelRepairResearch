id: 9446d5e0d25571e6a212
bug_link: https://syzkaller.appspot.com/bug?extid=9446d5e0d25571e6a212
title: WARNING in uvc_status_unregister
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c6ef3a7fa97ec823a1e1af9085cf13db9f7b3bac
fix_commit: a67f75c2b5ecf534eab416ce16c11fe780c4f8f6
datetime: '2024-12-19T14:44:43+00:00'
fix_commit_message: 'media: uvcvideo: Fix deadlock during uvc_probe


  If uvc_probe() fails, it can end up calling uvc_status_unregister() before

  uvc_status_init() is called.


  Fix this by checking if dev->status is NULL or not in

  uvc_status_unregister().


  Reported-by: syzbot+9446d5e0d25571e6a212@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/linux-media/20241020160249.GD7770@pendragon.ideasonboard.com/T/#m506744621d72a2ace5dd2ab64055be9898112dbd

  Fixes: c5fe3ed618f9 ("media: uvcvideo: Avoid race condition during unregister")

  Signed-off-by: Ricardo Ribalda <ribalda@chromium.org>

  Reviewed-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>

  Link: https://lore.kernel.org/r/20241022-race-unreg-v1-1-2212f364d9de@chromium.org

  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

  '
submodule:
- drivers/media/usb/uvc
hunk_count: 1
covered_count: 1
