id: bccc1fe10b70fadc78d0
bug_link: https://syzkaller.appspot.com/bug?extid=bccc1fe10b70fadc78d0
title: 'KASAN: slab-out-of-bounds Read in vhci_hub_control'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4b0aaacee51eb6592a03fdefd5ce97558518e291
fix_commit: 81f7567c51ad97668d1c3a48e8ecc482e64d4161
datetime: '2018-10-09T16:13:42+02:00'
fix_commit_message: 'usb: usbip: Fix BUG: KASAN: slab-out-of-bounds in vhci_hub_control()


  vhci_hub_control() accesses port_status array with out of bounds port

  value. Fix it to reference port_status[] only with a valid rhport value

  when invalid_rhport flag is true.


  The invalid_rhport flag is set early on after detecting in port value

  is within the bounds or not.


  The following is used reproduce the problem and verify the fix:

  C reproducer:   https://syzkaller.appspot.com/x/repro.c?x=14ed8ab6400000


  Reported-by: syzbot+bccc1fe10b70fadc78d0@syzkaller.appspotmail.com

  Cc: stable <stable@vger.kernel.org>

  Signed-off-by: Shuah Khan (Samsung OSG) <shuah@kernel.org>

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/usb/usbip
hunk_count: 11
covered_count: 1
