id: e1a1577ca8bcb47b769a
bug_link: https://syzkaller.appspot.com/bug?extid=e1a1577ca8bcb47b769a
title: 'KASAN: stack-out-of-bounds Read in xfrm_state_find (4)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 743ffffefac1c670c6618742c923f6275d819604
fix_commit: 19d7df69fdb2636856dc8919de72fc1bf8f79598
datetime: '2018-02-02T09:23:23+01:00'
fix_commit_message: 'xfrm: Refuse to insert 32 bit userspace socket policies on 64
  bit systems


  We don''t have a compat layer for xfrm, so userspace and kernel

  structures have different sizes in this case. This results in

  a broken configuration, so refuse to configure socket policies

  when trying to insert from 32 bit userspace as we do it already

  with policies inserted via netlink.


  Reported-and-tested-by: syzbot+e1a1577ca8bcb47b769a@syzkaller.appspotmail.com

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 1
covered_count: 0
