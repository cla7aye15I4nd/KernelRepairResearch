id: 1ab0ab6049e3e38c56d313bd2982bbf6b007ad6c
bug_link: https://syzkaller.appspot.com/bug?extid=1ab0ab6049e3e38c56d313bd2982bbf6b007ad6c
title: 'KASAN: use-after-free Read in __schedule'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d2b9b2079e23c1ab80ce1d7670d5e1994468a881
fix_commit: 8dbfb2bf1bb3848a8069164e205635b2675c24fe
datetime: '2018-02-02T17:49:55+01:00'
fix_commit_message: 'KVM: x86: don''t forget vcpu_put() in kvm_arch_vcpu_ioctl_set_sregs()


  Due to a bad merge resolution between commit f29810335965 ("KVM/x86:

  Check input paging mode when cs.l is set") and commit b4ef9d4e8cb8

  ("KVM: Move vcpu_load to arch-specific kvm_arch_vcpu_ioctl_set_sregs"),

  there is a case in kvm_arch_vcpu_ioctl_set_sregs() where vcpu_put() is

  not called after vcpu_get().  Fix it.


  Reported-by: syzbot <syzkaller@googlegroups.com>

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>

  '
submodule:
- arch/x86/kvm
hunk_count: 1
covered_count: 0
