id: 35eebd505e97d315d01c
bug_link: https://syzkaller.appspot.com/bug?extid=35eebd505e97d315d01c
title: 'KASAN: slab-out-of-bounds Read in thrustmaster_probe'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ac89895213d8950dba6ab342863a0959f73142a7
fix_commit: fc3ef2e3297b3c0e2006b5d7b3d66965e3392036
datetime: '2022-02-21T09:15:10+01:00'
fix_commit_message: 'HID: hid-thrustmaster: fix OOB read in thrustmaster_interrupts


  Syzbot reported an slab-out-of-bounds Read in thrustmaster_probe() bug.

  The root case is in missing validation check of actual number of endpoints.


  Code should not blindly access usb_host_interface::endpoint array, since

  it may contain less endpoints than code expects.


  Fix it by adding missing validaion check and print an error if

  number of endpoints do not match expected number


  Fixes: c49c33637802 ("HID: support for initialization of some Thrustmaster wheels")

  Reported-and-tested-by: syzbot+35eebd505e97d315d01c@syzkaller.appspotmail.com

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Jiri Kosina <jkosina@suse.cz>

  '
submodule:
- drivers/hid
hunk_count: 1
covered_count: 1
