id: 405843667e93b9790fc1
bug_link: https://syzkaller.appspot.com/bug?extid=405843667e93b9790fc1
title: WARNING in cfg80211_inform_single_bss_frame_data
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b90f51e8e1f5014c01c82a7bf4c611643d0a8bcb
fix_commit: e298aa358f0ca658406d524b6639fe389cb6e11e
datetime: '2021-05-31T21:39:10+02:00'
fix_commit_message: 'mac80211: fix skb length check in ieee80211_scan_rx()


  Replace hard-coded compile-time constants for header length check

  with dynamic determination based on the frame type. Otherwise, we

  hit a validation WARN_ON in cfg80211 later.


  Fixes: cd418ba63f0c ("mac80211: convert S1G beacon to scan results")

  Reported-by: syzbot+405843667e93b9790fc1@syzkaller.appspotmail.com

  Signed-off-by: Du Cheng <ducheng2@gmail.com>

  Link: https://lore.kernel.org/r/20210510041649.589754-1-ducheng2@gmail.com

  [style fixes, reword commit message]

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/mac80211
hunk_count: 1
covered_count: 1
