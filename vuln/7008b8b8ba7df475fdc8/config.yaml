id: 7008b8b8ba7df475fdc8
bug_link: https://syzkaller.appspot.com/bug?extid=7008b8b8ba7df475fdc8
title: 'BUG: Dentry still in use [unmount of tmpfs tmpfs]'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9e0babf2c06c73cda2c0cd37a1653d823adb40ec
fix_commit: 1b0b9cc8d3793e31b313e6c9685513b08cd883c4
datetime: '2019-06-17T17:36:07-04:00'
fix_commit_message: 'vfs: fsmount: add missing mntget()


  sys_fsmount() needs to take a reference to the new mount when adding it

  to the anonymous mount namespace.  Otherwise the filesystem can be

  unmounted while it''s still in use, as found by syzkaller.


  Reported-by: Mark Rutland <mark.rutland@arm.com>

  Reported-by: syzbot+99de05d099a170867f22@syzkaller.appspotmail.com

  Reported-by: syzbot+7008b8b8ba7df475fdc8@syzkaller.appspotmail.com

  Fixes: 93766fbd2696 ("vfs: syscall: Add fsmount() to create a mount for a superblock")

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

  '
submodule:
- fs
hunk_count: 1
covered_count: 0
