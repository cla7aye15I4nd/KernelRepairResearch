id: d882d57193079e379309
bug_link: https://syzkaller.appspot.com/bug?extid=d882d57193079e379309
title: 'KASAN: slab-out-of-bounds Read in indx_insert_into_buffer'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: db2a3cc6a3481076da6344cc62a80a4e2525f36f
fix_commit: b8c44949044e5f7f864525fdffe8e95135ce9ce5
datetime: '2023-03-27T16:59:10+04:00'
fix_commit_message: "fs/ntfs3: Fix OOB read in indx_insert_into_buffer\n\nSyzbot reported\
  \ a OOB read bug:\n\nBUG: KASAN: slab-out-of-bounds in indx_insert_into_buffer+0xaa3/0x13b0\n\
  fs/ntfs3/index.c:1755\nRead of size 17168 at addr ffff8880255e06c0 by task syz-executor308/3630\n\
  \nCall Trace:\n <TASK>\n memmove+0x25/0x60 mm/kasan/shadow.c:54\n indx_insert_into_buffer+0xaa3/0x13b0\
  \ fs/ntfs3/index.c:1755\n indx_insert_entry+0x446/0x6b0 fs/ntfs3/index.c:1863\n\
  \ ntfs_create_inode+0x1d3f/0x35c0 fs/ntfs3/inode.c:1548\n ntfs_create+0x3e/0x60\
  \ fs/ntfs3/namei.c:100\n lookup_open fs/namei.c:3413 [inline]\n\nIf the member struct\
  \ INDEX_BUFFER *index of struct indx_node is\nincorrect, that is, the value of __le32\
  \ used is greater than the value\nof __le32 total in struct INDEX_HDR. Therefore,\
  \ OOB read occurs when\nmemmove is called in indx_insert_into_buffer().\nFix this\
  \ by adding a check in hdr_find_e().\n\nFixes: 82cae269cfa9 (\"fs/ntfs3: Add initialization\
  \ of super block\")\nReported-by: syzbot+d882d57193079e379309@syzkaller.appspotmail.com\n\
  Signed-off-by: ZhangPeng <zhangpeng362@huawei.com>\nSigned-off-by: Konstantin Komarov\
  \ <almaz.alexandrovich@paragon-software.com>\n"
submodule:
- fs/ntfs3
hunk_count: 1
covered_count: 0
