diff --git a/net/core/devlink.c b/net/core/devlink.c
index f38ef4b26f70..4dac53c77842 100644
--- a/net/core/devlink.c
+++ b/net/core/devlink.c
@@ -10754,7 +10754,8 @@ devlink_trap_group_notify(struct devlink *devlink,
 
 	WARN_ON_ONCE(cmd != DEVLINK_CMD_TRAP_GROUP_NEW &&
 		     cmd != DEVLINK_CMD_TRAP_GROUP_DEL);
-	ASSERT_DEVLINK_REGISTERED(devlink);
+	if (!xa_get_mark(&devlinks, devlink->index, DEVLINK_REGISTERED))
+		return;
 
 	msg = nlmsg_new(NLMSG_DEFAULT_SIZE, GFP_KERNEL);
 	if (!msg)
@@ -11081,6 +11082,9 @@ devlink_trap_group_register(struct devlink *devlink,
 	}
 
 	list_add_tail(&group_item->list, &devlink->trap_group_list);
+	devlink_trap_group_notify(devlink, group_item,
+				  DEVLINK_CMD_TRAP_GROUP_NEW);
+
 	return 0;
 
 err_group_init:
@@ -11101,6 +11105,8 @@ devlink_trap_group_unregister(struct devlink *devlink,
 	if (WARN_ON_ONCE(!group_item))
 		return;
 
+	devlink_trap_group_notify(devlink, group_item,
+				  DEVLINK_CMD_TRAP_GROUP_DEL);
 	list_del(&group_item->list);
 	free_percpu(group_item->stats);
 	kfree(group_item);
@@ -11120,8 +11126,6 @@ int devlink_trap_groups_register(struct devlink *devlink,
 {
 	int i, err;
 
-	ASSERT_DEVLINK_NOT_REGISTERED(devlink);
-
 	mutex_lock(&devlink->lock);
 	for (i = 0; i < groups_count; i++) {
 		const struct devlink_trap_group *group = &groups[i];
@@ -11159,8 +11163,6 @@ void devlink_trap_groups_unregister(struct devlink *devlink,
 {
 	int i;
 
-	ASSERT_DEVLINK_NOT_REGISTERED(devlink);
-
 	mutex_lock(&devlink->lock);
 	for (i = groups_count - 1; i >= 0; i--)
 		devlink_trap_group_unregister(devlink, &groups[i]);
