id: 5f682cd029581f9edfd1
bug_link: https://syzkaller.appspot.com/bug?extid=5f682cd029581f9edfd1
title: kernel BUG in submit_bh_wbc (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 27ab33854873e6fb958cb074681a0107cc2ecc4c
fix_commit: a90d4471146de21745980cba51ce88e7926bcc4f
datetime: '2024-06-26T12:54:08+02:00'
fix_commit_message: 'udf: Avoid using corrupted block bitmap buffer


  When the filesystem block bitmap is corrupted, we detect the corruption

  while loading the bitmap and fail the allocation with error. However the

  next allocation from the same bitmap will notice the bitmap buffer is

  already loaded and tries to allocate from the bitmap with mixed results

  (depending on the exact nature of the bitmap corruption). Fix the

  problem by using BH_verified bit to indicate whether the bitmap is valid

  or not.


  Reported-by: syzbot+5f682cd029581f9edfd1@syzkaller.appspotmail.com

  CC: stable@vger.kernel.org

  Link: https://patch.msgid.link/20240617154201.29512-2-jack@suse.cz

  Fixes: 1e0d4adf17e7 ("udf: Check consistency of Space Bitmap Descriptor")

  Signed-off-by: Jan Kara <jack@suse.cz>

  '
submodule:
- fs/udf
hunk_count: 3
covered_count: 0
