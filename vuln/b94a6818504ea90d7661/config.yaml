id: b94a6818504ea90d7661
bug_link: https://syzkaller.appspot.com/bug?extid=b94a6818504ea90d7661
title: general protection fault in nf_tproxy_laddr4
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 33c563ebf8d3deed7d8addd20d77398ac737ef9a
fix_commit: 21a673bddc8fd4873c370caf9ae70ffc6d47e8d3
datetime: '2024-05-29T00:37:51+02:00'
fix_commit_message: "netfilter: tproxy: bail out if IP has been disabled on the device\n\
  \nsyzbot reports:\ngeneral protection fault, probably for non-canonical address\
  \ 0xdffffc0000000003: 0000 [#1] PREEMPT SMP KASAN PTI\nKASAN: null-ptr-deref in\
  \ range [0x0000000000000018-0x000000000000001f]\n[..]\nRIP: 0010:nf_tproxy_laddr4+0xb7/0x340\
  \ net/ipv4/netfilter/nf_tproxy_ipv4.c:62\nCall Trace:\n nft_tproxy_eval_v4 net/netfilter/nft_tproxy.c:56\
  \ [inline]\n nft_tproxy_eval+0xa9a/0x1a00 net/netfilter/nft_tproxy.c:168\n\n__in_dev_get_rcu()\
  \ can return NULL, so check for this.\n\nReported-and-tested-by: syzbot+b94a6818504ea90d7661@syzkaller.appspotmail.com\n\
  Fixes: cc6eb4338569 (\"tproxy: use the interface primary IP address as a default\
  \ value for --on-ip\")\nSigned-off-by: Florian Westphal <fw@strlen.de>\nSigned-off-by:\
  \ Pablo Neira Ayuso <pablo@netfilter.org>\n"
submodule:
- net/ipv4
hunk_count: 1
covered_count: 1
