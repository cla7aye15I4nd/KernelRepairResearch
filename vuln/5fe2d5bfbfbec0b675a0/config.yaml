id: 5fe2d5bfbfbec0b675a0
bug_link: https://syzkaller.appspot.com/bug?extid=5fe2d5bfbfbec0b675a0
title: 'KASAN: slab-out-of-bounds Read in hci_cmd_sync_alloc'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d3faab9b5a6a0477d69c38bd11c43aa5e936f929
fix_commit: 03f1700b9b4d4f2fed3165370f3c23db76553178
datetime: '2025-05-30T13:29:30-04:00'
fix_commit_message: 'Bluetooth: MGMT: reject malformed HCI_CMD_SYNC commands


  In ''mgmt_hci_cmd_sync()'', check whether the size of parameters passed

  in ''struct mgmt_cp_hci_cmd_sync'' matches the total size of the data

  (i.e. ''sizeof(struct mgmt_cp_hci_cmd_sync)'' plus trailing bytes).

  Otherwise, large invalid ''params_len'' will cause ''hci_cmd_sync_alloc()''

  to do ''skb_put_data()'' from an area beyond the one actually passed to

  ''mgmt_hci_cmd_sync()''.


  Reported-by: syzbot+5fe2d5bfbfbec0b675a0@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=5fe2d5bfbfbec0b675a0

  Fixes: 827af4787e74 ("Bluetooth: MGMT: Add initial implementation of MGMT_OP_HCI_CMD_SYNC")

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

  '
submodule:
- net/bluetooth
hunk_count: 1
covered_count: 1
