id: 75eab84fd0af9e8bf66b
bug_link: https://syzkaller.appspot.com/bug?extid=75eab84fd0af9e8bf66b
title: WARNING in ovl_create_real
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9a254403760041528bc8f69fe2f5e1ef86950991
fix_commit: 1f5573cfe7a7056e80a92c7a037a3e69f3a13d1c
datetime: '2021-11-04T10:55:34+01:00'
fix_commit_message: "ovl: fix warning in ovl_create_real()\n\nSyzbot triggered the\
  \ following warning in ovl_workdir_create() ->\novl_create_real():\n\n\tif (!err\
  \ && WARN_ON(!newdentry->d_inode)) {\n\nThe reason is that the cgroup2 filesystem\
  \ returns from mkdir without\ninstantiating the new dentry.\n\nWeird filesystems\
  \ such as this will be rejected by overlayfs at a later\nstage during setup, but\
  \ to prevent such a warning, call ovl_mkdir_real()\ndirectly from ovl_workdir_create()\
  \ and reject this case early.\n\nReported-and-tested-by: syzbot+75eab84fd0af9e8bf66b@syzkaller.appspotmail.com\n\
  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>\n"
submodule:
- fs/overlayfs
hunk_count: 3
covered_count: 1
