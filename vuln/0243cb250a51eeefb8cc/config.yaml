id: 0243cb250a51eeefb8cc
bug_link: https://syzkaller.appspot.com/bug?extid=0243cb250a51eeefb8cc
title: 'KASAN: use-after-free Read in adu_disconnect'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9816144313d33974bbd4599d4e8e554c11cae27e
fix_commit: 44efc269db7929f6275a1fa927ef082e533ecde0
datetime: '2019-10-04T11:02:59+02:00'
fix_commit_message: 'USB: adutux: fix use-after-free on disconnect


  The driver was clearing its struct usb_device pointer, which it used as

  an inverted disconnected flag, before deregistering the character device

  and without serialising against racing release().


  This could lead to a use-after-free if a racing release() callback

  observes the cleared pointer and frees the driver data before

  disconnect() is finished with it.


  This could also lead to NULL-pointer dereferences in a racing open().


  Fixes: f08812d5eb8f ("USB: FIx locks and urb->status in adutux (updated)")

  Cc: stable <stable@vger.kernel.org>     # 2.6.24

  Reported-by: syzbot+0243cb250a51eeefb8cc@syzkaller.appspotmail.com

  Tested-by: syzbot+0243cb250a51eeefb8cc@syzkaller.appspotmail.com

  Signed-off-by: Johan Hovold <johan@kernel.org>

  Link: https://lore.kernel.org/r/20190925092913.8608-1-johan@kernel.org

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/usb/misc
hunk_count: 1
covered_count: 1
