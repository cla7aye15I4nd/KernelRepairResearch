id: 71f1e64501a309fcc012
bug_link: https://syzkaller.appspot.com/bug?extid=71f1e64501a309fcc012
title: 'KASAN: slab-out-of-bounds Write in usb_get_bos_descriptor'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a188339ca5a396acc588e5851ed7e19f66b0ebd9
fix_commit: a03ff54460817c76105f81f3aa8ef655759ccc9a
datetime: '2019-05-21T10:08:55+02:00'
fix_commit_message: 'USB: Fix slab-out-of-bounds write in usb_get_bos_descriptor


  The syzkaller USB fuzzer found a slab-out-of-bounds write bug in the

  USB core, caused by a failure to check the actual size of a BOS

  descriptor.  This patch adds a check to make sure the descriptor is at

  least as large as it is supposed to be, so that the code doesn''t

  inadvertently access memory beyond the end of the allocated region

  when assigning to dev->bos->desc->bNumDeviceCaps later on.


  Signed-off-by: Alan Stern <stern@rowland.harvard.edu>

  Reported-and-tested-by: syzbot+71f1e64501a309fcc012@syzkaller.appspotmail.com

  CC: <stable@vger.kernel.org>

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/usb/core
hunk_count: 1
covered_count: 1
