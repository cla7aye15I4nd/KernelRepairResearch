id: 9738c8815b375ce482a1
bug_link: https://syzkaller.appspot.com/bug?extid=9738c8815b375ce482a1
title: possible deadlock in cgroup_rstat_updated
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 519d81956ee277b4419c723adfb154603c2565ba
fix_commit: 3c08b0931eedd04c530040499fadeccab50ed646
datetime: '2021-10-18T06:17:01-06:00'
fix_commit_message: 'blk-cgroup: blk_cgroup_bio_start() should use irq-safe operations
  on blkg->iostat_cpu


  c3df5fb57fe8 ("cgroup: rstat: fix A-A deadlock on 32bit around

  u64_stats_sync") made u64_stats updates irq-safe to avoid A-A deadlocks.

  Unfortunately, the conversion missed one in blk_cgroup_bio_start(). Fix it.


  Fixes: 2d146aa3aa84 ("mm: memcontrol: switch to rstat")

  Cc: stable@vger.kernel.org # v5.13+

  Reported-by: syzbot+9738c8815b375ce482a1@syzkaller.appspotmail.com

  Signed-off-by: Tejun Heo <tj@kernel.org>

  Link: https://lore.kernel.org/r/YWi7NrQdVlxD6J9W@slm.duckdns.org

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- block
hunk_count: 2
covered_count: 2
