id: 4c0d0c4cde787116d465
bug_link: https://syzkaller.appspot.com/bug?extid=4c0d0c4cde787116d465
title: 'KASAN: slab-use-after-free Write in sco_sock_timeout'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 989fa5171f005ecf63440057218d8aeb1795287d
fix_commit: 1bf4470a3939c678fb822073e9ea77a0560bc6bb
datetime: '2024-10-23T10:20:29-04:00'
fix_commit_message: 'Bluetooth: SCO: Fix UAF on sco_sock_timeout


  conn->sk maybe have been unlinked/freed while waiting for sco_conn_lock

  so this checks if the conn->sk is still valid by checking if it part of

  sco_sk_list.


  Reported-by: syzbot+4c0d0c4cde787116d465@syzkaller.appspotmail.com

  Tested-by: syzbot+4c0d0c4cde787116d465@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=4c0d0c4cde787116d465

  Fixes: ba316be1b6a0 ("Bluetooth: schedule SCO timeouts with delayed_work")

  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

  '
submodule:
- include/net/bluetooth
- net/bluetooth
hunk_count: 5
covered_count: 3
