id: b974bd41515f770c608b
bug_link: https://syzkaller.appspot.com/bug?extid=b974bd41515f770c608b
title: 'UBSAN: array-index-out-of-bounds in add_missing_indices'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a4685408ff6c3e2af366ad9a7274f45ff3f394ee
fix_commit: 5dff41a86377563f7a2b968aae00d25b4ceb37c9
datetime: '2025-04-03T09:11:43-05:00'
fix_commit_message: 'jfs: fix array-index-out-of-bounds read in add_missing_indices


  stbl is s8 but it must contain offsets into slot which can go from 0 to

  127.


  Added a bound check for that error and return -EIO if the check fails.

  Also make jfs_readdir return with error if add_missing_indices returns

  with an error.


  Reported-by: syzbot+b974bd41515f770c608b@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com./bug?extid=b974bd41515f770c608b

  Signed-off-by: Aditya Dutt <duttaditya18@gmail.com>

  Signed-off-by: Dave Kleikamp <dave.kleikamp@oracle.com>

  '
submodule:
- fs/jfs
hunk_count: 5
covered_count: 5
