id: 64fe47118b53a051c3d7
bug_link: https://syzkaller.appspot.com/bug?extid=64fe47118b53a051c3d7
title: WARNING in bch2_opt_check_may_set
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c6c6a391097a6367cdbc663957010f03d9dbb361
fix_commit: 2dd202dbaf0acfa4af7fcdf258f35866e31f7425
datetime: '2025-03-28T11:13:25-04:00'
fix_commit_message: 'bcachefs: Recovery no longer holds state_lock


  state_lock guards against devices coming or leaving, changing state, or

  the filesystem changing between ro <-> rw.


  But it''s not necessary for running recovery passes, and holding it

  blocks asynchronous events that would cause us to go RO or kick out

  devices.


  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 14
covered_count: 1
