id: ff59dc711f2cff879a05
bug_link: https://syzkaller.appspot.com/bug?extid=ff59dc711f2cff879a05
title: 'KASAN: use-after-free Read in tipc_nl_publ_dump'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 48423dd7e683dadcfacc2bfb3bc0e57e7c8b9cb2
fix_commit: ab5b526da0485ac4af3d395e5ce1c04b1bfbb89c
datetime: '2019-10-08T18:00:08-07:00'
fix_commit_message: 'net: genetlink: always allocate separate attrs for dumpit ops


  Individual dumpit ops (start, dumpit, done) are locked by genl_lock

  if !family->parallel_ops. However, multiple

  genl_family_rcv_msg_dumpit() calls may in in flight in parallel.

  Each has a separate struct genl_dumpit_info allocated

  but they share the same family->attrbuf. Fix this by allocating separate

  memory for attrs for dumpit ops, for non-parallel_ops (for parallel_ops

  it is done already).


  Reported-by: syzbot+495688b736534bb6c6ad@syzkaller.appspotmail.com

  Reported-by: syzbot+ff59dc711f2cff879a05@syzkaller.appspotmail.com

  Reported-by: syzbot+dbe02e13bcce52bcf182@syzkaller.appspotmail.com

  Reported-by: syzbot+9cb7edb2906ea1e83006@syzkaller.appspotmail.com

  Fixes: bf813b0afeae ("net: genetlink: parse attrs and store in contect info struct
  during dumpit")

  Signed-off-by: Jiri Pirko <jiri@mellanox.com>

  Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>

  '
submodule:
- net/netlink
hunk_count: 10
covered_count: 10
