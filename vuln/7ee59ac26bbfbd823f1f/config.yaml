id: 7ee59ac26bbfbd823f1f
bug_link: https://syzkaller.appspot.com/bug?extid=7ee59ac26bbfbd823f1f
title: general protection fault in nf_tables_dump_obj_done
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 4c82fd0abb87e20d0d68ef5237e74732352806c8
fix_commit: 8bea728dce8972e534e6b99fd550f7b5cc3864e8
datetime: '2017-12-26T17:16:47+01:00'
fix_commit_message: 'netfilter: nf_tables: fix potential NULL-ptr deref in nf_tables_dump_obj_done()


  If there is no NFTA_OBJ_TABLE and NFTA_OBJ_TYPE, the c.data will be NULL in

  nf_tables_getobj(). So before free filter->table in nf_tables_dump_obj_done(),

  we need to check if filter is NULL first.


  Fixes: e46abbcc05aa ("netfilter: nf_tables: Allow table names of up to 255 chars")

  Signed-off-by: Hangbin Liu <liuhangbin@gmail.com>

  Acked-by: Phil Sutter <phil@nwl.cc>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 1
covered_count: 1
