id: 16e72110feb2b653ef27
bug_link: https://syzkaller.appspot.com/bug?extid=16e72110feb2b653ef27
title: 'WARNING: still has locks held in tls_rx_reader_lock'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b945804d993072e24138741ab67e28f6b09b2502
fix_commit: dde06aaa89b76275407b78108b57f94838287dab
datetime: '2022-07-21T18:58:11-07:00'
fix_commit_message: 'tls: rx: release the sock lock on locking timeout


  Eric reports we should release the socket lock if the entire

  "grab reader lock" operation has failed. The callers assume

  they don''t have to release it or otherwise unwind.


  Reported-by: Eric Dumazet <edumazet@google.com>

  Reported-by: syzbot+16e72110feb2b653ef27@syzkaller.appspotmail.com

  Fixes: 4cbc325ed6b4 ("tls: rx: allow only one reader at a time")

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Link: https://lore.kernel.org/r/20220720203701.2179034-1-kuba@kernel.org

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- net/tls
hunk_count: 2
covered_count: 2
