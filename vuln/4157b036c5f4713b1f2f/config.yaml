id: 4157b036c5f4713b1f2f
bug_link: https://syzkaller.appspot.com/bug?extid=4157b036c5f4713b1f2f
title: 'KASAN: global-out-of-bounds Read in validate_nla'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f9d672f1c2ca36b788511bbd773d650c744e109a
fix_commit: a8b5c6d69261889e022e9d64ac7ee8741db730bf
datetime: '2019-01-25T09:26:32+01:00'
fix_commit_message: 'nl80211: fix NLA_POLICY_NESTED() arguments


  syzbot reported an out-of-bounds read when passing certain

  malformed messages into nl80211. The specific place where

  this happened isn''t interesting, the problem is that nested

  policy parsing was referring to the wrong maximum attribute

  and thus the policy wasn''t long enough.


  Fix this by referring to the correct attribute. Since this

  is really not necessary, I''ll come up with a separate patch

  to just pass the policy instead of both, in the common case

  we can infer the maxattr from the size of the policy array.


  Reported-by: syzbot+4157b036c5f4713b1f2f@syzkaller.appspotmail.com

  Cc: stable@vger.kernel.org

  Fixes: 9bb7e0f24e7e ("cfg80211: add peer measurement with FTM initiator API")

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/wireless
hunk_count: 1
covered_count: 0
