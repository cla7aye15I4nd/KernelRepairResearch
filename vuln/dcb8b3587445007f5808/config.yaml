id: dcb8b3587445007f5808
bug_link: https://syzkaller.appspot.com/bug?extid=dcb8b3587445007f5808
title: 'KASAN: use-after-free Read in gfs2_log_flush'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e54c78a27fcdef406af799f360a93e6754adeefe
fix_commit: 4c62bd9cea7bcf10292f7e4c57a2bca332942697
datetime: '2018-10-08T07:52:43-05:00'
fix_commit_message: 'gfs2: Don''t leave s_fs_info pointing to freed memory in init_sbd


  When alloc_percpu() fails, sdp gets freed but sb->s_fs_info still points

  to the same address. Move the assignment after that error check so that

  s_fs_info can only point to a valid sdp or NULL, which is checked for

  later in the error path, in gfs2_kill_super().


  Reported-by: syzbot+dcb8b3587445007f5808@syzkaller.appspotmail.com

  Signed-off-by: Andrew Price <anprice@redhat.com>

  Signed-off-by: Bob Peterson <rpeterso@redhat.com>

  '
submodule:
- fs/gfs2
hunk_count: 1
covered_count: 1
