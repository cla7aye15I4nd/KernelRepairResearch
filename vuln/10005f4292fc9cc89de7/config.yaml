id: 10005f4292fc9cc89de7
bug_link: https://syzkaller.appspot.com/bug?extid=10005f4292fc9cc89de7
title: 'KASAN: use-after-free Write in nf_nat_ipv6_manip_pkt'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1a9da5937386dbe553ffcf6c65d985bd48c347c5
fix_commit: b078556aecd791b0e5cb3a59f4c3a14273b52121
datetime: '2018-02-25T20:03:54+01:00'
fix_commit_message: 'netfilter: ipv6: fix use-after-free Write in nf_nat_ipv6_manip_pkt


  l4proto->manip_pkt() can cause reallocation of skb head so pointer

  to the ipv6 header must be reloaded.


  Reported-and-tested-by: <syzbot+10005f4292fc9cc89de7@syzkaller.appspotmail.com>

  Fixes: 58a317f1061c89 ("netfilter: ipv6: add IPv6 NAT support")

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/ipv6
hunk_count: 1
covered_count: 1
