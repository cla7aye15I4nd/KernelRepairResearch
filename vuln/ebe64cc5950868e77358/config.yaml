id: ebe64cc5950868e77358
bug_link: https://syzkaller.appspot.com/bug?extid=ebe64cc5950868e77358
title: memory leak in corrupted
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 59f7ea703c38abc3f239068d49cc8897740e4c54
fix_commit: 0a186b49bba596b81de5a686ce5bfc9cd48ab3ef
datetime: '2024-01-27T09:13:39+01:00'
fix_commit_message: 'batman-adv: mcast: fix memory leak on deleting a batman-adv interface


  The batman-adv multicast tracker TVLV handler is registered for the

  new batman-adv multicast packet type upon creating a batman-adv interface,

  but not unregistered again upon the interface''s deletion, leading to a

  memory leak.


  Fix this memory leak by calling the according TVLV handler unregister

  routine for the multicast tracker TVLV upon batman-adv interface

  deletion.


  Fixes: 07afe1ba288c ("batman-adv: mcast: implement multicast packet reception and
  forwarding")

  Reported-and-tested-by: syzbot+ebe64cc5950868e77358@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/all/000000000000beadc4060f0cbc23@google.com/

  Signed-off-by: Linus LÃ¼ssing <linus.luessing@c0d3.blue>

  Signed-off-by: Sven Eckelmann <sven@narfation.org>

  Signed-off-by: Simon Wunderlich <sw@simonwunderlich.de>

  '
submodule:
- net/batman-adv
hunk_count: 1
covered_count: 0
