id: 62d7eef57b09bfebcd84
bug_link: https://syzkaller.appspot.com/bug?extid=62d7eef57b09bfebcd84
title: WARNING in rate_control_rate_init (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: fb768d3b13ffa325b7e84480d488ac799c9d2cd7
fix_commit: c1393c132b906fbdf91f6d1c9eb2ef7a00cce64e
datetime: '2023-12-12T10:14:57+01:00'
fix_commit_message: "wifi: mac80211: check if the existing link config remains unchanged\n\
  \n[Syz report]\nWARNING: CPU: 1 PID: 5067 at net/mac80211/rate.c:48 rate_control_rate_init+0x540/0x690\
  \ net/mac80211/rate.c:48\nModules linked in:\nCPU: 1 PID: 5067 Comm: syz-executor413\
  \ Not tainted 6.7.0-rc3-syzkaller-00014-gdf60cee26a2e #0\nHardware name: Google\
  \ Google Compute Engine/Google Compute Engine, BIOS Google 11/10/2023\nRIP: 0010:rate_control_rate_init+0x540/0x690\
  \ net/mac80211/rate.c:48\nCode: 48 c7 c2 00 46 0c 8c be 08 03 00 00 48 c7 c7 c0\
  \ 45 0c 8c c6 05 70 79 0b 05 01 e8 1b a0 6f f7 e9 e0 fd ff ff e8 61 b3 8f f7 90\
  \ <0f> 0b 90 e9 36 ff ff ff e8 53 b3 8f f7 e8 5e 0b 78 f7 31 ff 89 c3\nRSP: 0018:ffffc90003c57248\
  \ EFLAGS: 00010293\nRAX: 0000000000000000 RBX: ffff888016bc4000 RCX: ffffffff89f7d519\n\
  RDX: ffff888076d43b80 RSI: ffffffff89f7d6df RDI: 0000000000000005\nRBP: ffff88801daaae20\
  \ R08: 0000000000000005 R09: 0000000000000000\nR10: 0000000000000001 R11: 0000000000000002\
  \ R12: 0000000000000001\nR13: 0000000000000000 R14: ffff888020030e20 R15: ffff888078f08000\n\
  FS:  0000555556b94380(0000) GS:ffff8880b9900000(0000) knlGS:0000000000000000\nCS:\
  \  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00000000005fdeb8 CR3: 0000000076d22000\
  \ CR4: 00000000003506f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n\
  DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n\
  \ <TASK>\n sta_apply_auth_flags.constprop.0+0x4b7/0x510 net/mac80211/cfg.c:1674\n\
  \ sta_apply_parameters+0xaf1/0x16c0 net/mac80211/cfg.c:2002\n ieee80211_add_station+0x3fa/0x6c0\
  \ net/mac80211/cfg.c:2068\n rdev_add_station net/wireless/rdev-ops.h:201 [inline]\n\
  \ nl80211_new_station+0x13ba/0x1a70 net/wireless/nl80211.c:7603\n genl_family_rcv_msg_doit+0x1fc/0x2e0\
  \ net/netlink/genetlink.c:972\n genl_family_rcv_msg net/netlink/genetlink.c:1052\
  \ [inline]\n genl_rcv_msg+0x561/0x800 net/netlink/genetlink.c:1067\n netlink_rcv_skb+0x16b/0x440\
  \ net/netlink/af_netlink.c:2545\n genl_rcv+0x28/0x40 net/netlink/genetlink.c:1076\n\
  \ netlink_unicast_kernel net/netlink/af_netlink.c:1342 [inline]\n netlink_unicast+0x53b/0x810\
  \ net/netlink/af_netlink.c:1368\n netlink_sendmsg+0x93c/0xe40 net/netlink/af_netlink.c:1910\n\
  \ sock_sendmsg_nosec net/socket.c:730 [inline]\n __sock_sendmsg+0xd5/0x180 net/socket.c:745\n\
  \ ____sys_sendmsg+0x6ac/0x940 net/socket.c:2584\n ___sys_sendmsg+0x135/0x1d0 net/socket.c:2638\n\
  \ __sys_sendmsg+0x117/0x1e0 net/socket.c:2667\n do_syscall_x64 arch/x86/entry/common.c:51\
  \ [inline]\n do_syscall_64+0x40/0x110 arch/x86/entry/common.c:82\n entry_SYSCALL_64_after_hwframe+0x63/0x6b\n\
  \n[Analysis]\nIt is inappropriate to make a link configuration change judgment on\
  \ an\nnon-existent and non new link.\n\n[Fix]\nQuickly exit when there is a existent\
  \ link and the link configuration has not\nchanged.\n\nFixes: b303835dabe0 (\"wifi:\
  \ mac80211: accept STA changes without link changes\")\nReported-and-tested-by:\
  \ syzbot+62d7eef57b09bfebcd84@syzkaller.appspotmail.com\nSigned-off-by: Edward Adam\
  \ Davis <eadavis@qq.com>\nLink: https://msgid.link/tencent_DE67FF86DB92ED465489A36ECD2EDDCC8C06@qq.com\n\
  Signed-off-by: Johannes Berg <johannes.berg@intel.com>\n"
submodule:
- net/mac80211
hunk_count: 1
covered_count: 0
