id: 028366e52c9ace67deb3
bug_link: https://syzkaller.appspot.com/bug?extid=028366e52c9ace67deb3
title: 'KASAN: slab-out-of-bounds Read in kvm_clear_dirty_log_protect'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d14eff1bc53e6a268c3b48da5cdb469f26832d1a
fix_commit: 98938aa8edd66dc95024d7c936a4bc315f6615ff
datetime: '2019-01-11T18:38:07+01:00'
fix_commit_message: 'KVM: validate userspace input in kvm_clear_dirty_log_protect()


  The function at issue does not fully validate the content of the

  structure pointed by the log parameter, though its content has just been

  copied from userspace and lacks validation. Fix that.


  Moreover, change the type of n to unsigned long as that is the type

  returned by kvm_dirty_bitmap_bytes().


  Signed-off-by: Tomas Bortoli <tomasbortoli@gmail.com>

  Reported-by: syzbot+028366e52c9ace67deb3@syzkaller.appspotmail.com

  [Squashed the fix from Paolo. - Radim.]

  Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>

  '
submodule:
- virt/kvm
hunk_count: 2
covered_count: 2
