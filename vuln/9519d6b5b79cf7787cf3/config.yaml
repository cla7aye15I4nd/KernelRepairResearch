id: 9519d6b5b79cf7787cf3
bug_link: https://syzkaller.appspot.com/bug?extid=9519d6b5b79cf7787cf3
title: 'WARNING: bad unlock balance in l2cap_recv_frame'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 000c2fa2c144c499c881a101819cf1936a1f7cf2
fix_commit: 25e97f7b1866e6b8503be349eeea44bb52d661ce
datetime: '2023-04-23T22:05:23-07:00'
fix_commit_message: 'Bluetooth: L2CAP: fix "bad unlock balance" in l2cap_disconnect_rsp


  conn->chan_lock isn''t acquired before l2cap_get_chan_by_scid,

  if l2cap_get_chan_by_scid returns NULL, then ''bad unlock balance''

  is triggered.


  Reported-by: syzbot+9519d6b5b79cf7787cf3@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/all/000000000000894f5f05f95e9f4d@google.com/

  Signed-off-by: Min Li <lm0963hack@gmail.com>

  Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

  '
submodule:
- net/bluetooth
hunk_count: 1
covered_count: 1
