id: 92968395eedbdbd3617d
bug_link: https://syzkaller.appspot.com/bug?extid=92968395eedbdbd3617d
title: 'KASAN: slab-out-of-bounds Read in cttimeout_net_exit'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 56b14ecec97f39118bf85c9ac2438c5a949509ed
fix_commit: aeed55a08d0b2bf2e3986b110b04d2a5aca192a6
datetime: '2022-05-27T11:16:38+02:00'
fix_commit_message: "netfilter: cttimeout: fix slab-out-of-bounds read in cttimeout_net_exit\n\
  \nsyzbot reports:\nBUG: KASAN: slab-out-of-bounds in __list_del_entry_valid+0xcc/0xf0\
  \ lib/list_debug.c:42\n[..]\n list_del include/linux/list.h:148 [inline]\n cttimeout_net_exit+0x211/0x540\
  \ net/netfilter/nfnetlink_cttimeout.c:617\n\nNo reproducer so far. Looking at recent\
  \ changes in this area\nits clear that the free_head must not be at the end of the\n\
  structure because nf_ct_timeout structure has variable size.\n\nReported-by: <syzbot+92968395eedbdbd3617d@syzkaller.appspotmail.com>\n\
  Fixes: 78222bacfca9 (\"netfilter: cttimeout: decouple unlink and free on netns destruction\"\
  )\nSigned-off-by: Florian Westphal <fw@strlen.de>\nSigned-off-by: Pablo Neira Ayuso\
  \ <pablo@netfilter.org>\n"
submodule:
- net/netfilter
hunk_count: 1
covered_count: 1
