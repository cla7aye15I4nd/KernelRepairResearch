id: 59875ffef5cb9c9b29e9
bug_link: https://syzkaller.appspot.com/bug?extid=59875ffef5cb9c9b29e9
title: 'KASAN: slab-out-of-bounds Read in imon_probe'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 462e108bac18419f17c6a34eb348b600a614aa4f
fix_commit: a1766a4fd83befa0b34d932d532e7ebb7fab1fa7
datetime: '2023-10-07T10:55:48+02:00'
fix_commit_message: 'media: imon: fix access to invalid resource for the second interface


  imon driver probes two USB interfaces, and at the probe of the second

  interface, the driver assumes blindly that the first interface got

  bound with the same imon driver.  It''s usually true, but it''s still

  possible that the first interface is bound with another driver via a

  malformed descriptor.  Then it may lead to a memory corruption, as

  spotted by syzkaller; imon driver accesses the data from drvdata as

  struct imon_context object although it''s a completely different one

  that was assigned by another driver.


  This patch adds a sanity check -- whether the first interface is

  really bound with the imon driver or not -- for avoiding the problem

  above at the probe time.


  Reported-by: syzbot+59875ffef5cb9c9b29e9@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/all/000000000000a838aa0603cc74d6@google.com/

  Tested-by: Ricardo B. Marliere <ricardo@marliere.net>

  Link: https://lore.kernel.org/r/20230922005152.163640-1-ricardo@marliere.net

  Signed-off-by: Takashi Iwai <tiwai@suse.de>

  Signed-off-by: Sean Young <sean@mess.org>

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  '
submodule:
- drivers/media/rc
hunk_count: 1
covered_count: 1
