id: 253cd2d2491df77c93ac
bug_link: https://syzkaller.appspot.com/bug?extid=253cd2d2491df77c93ac
title: 'KASAN: slab-out-of-bounds Read in cfg80211_wext_freq'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0941772342d59e48733131ac3a202fa1a4d832e9
fix_commit: 6ef09cdc5ba0f93826c09d810c141a8d103a80fc
datetime: '2024-06-12T10:07:56+02:00'
fix_commit_message: 'wifi: cfg80211: wext: add extra SIOCSIWSCAN data check


  In ''cfg80211_wext_siwscan()'', add extra check whether number of

  channels passed via ''ioctl(sock, SIOCSIWSCAN, ...)'' doesn''t exceed

  IW_MAX_FREQUENCIES and reject invalid request with -EINVAL otherwise.


  Reported-by: syzbot+253cd2d2491df77c93ac@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=253cd2d2491df77c93ac

  Signed-off-by: Dmitry Antipov <dmantipov@yandex.ru>

  Link: https://msgid.link/20240531032010.451295-1-dmantipov@yandex.ru

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/wireless
hunk_count: 1
covered_count: 1
