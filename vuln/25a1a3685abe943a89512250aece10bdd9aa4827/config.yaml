id: 25a1a3685abe943a89512250aece10bdd9aa4827
bug_link: https://syzkaller.appspot.com/bug?extid=25a1a3685abe943a89512250aece10bdd9aa4827
title: general protection fault in strcmp
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3d1f0255426af7eeb88bf7221ff683b7ca9e4493
fix_commit: 18026d866801d0c52e5550210563222bd6c7191d
datetime: '2017-12-08T15:13:29+00:00'
fix_commit_message: 'KEYS: reject NULL restriction string when type is specified


  keyctl_restrict_keyring() allows through a NULL restriction when the

  "type" is non-NULL, which causes a NULL pointer dereference in

  asymmetric_lookup_restriction() when it calls strcmp() on the

  restriction string.


  But no key types actually use a "NULL restriction" to mean anything, so

  update keyctl_restrict_keyring() to reject it with EINVAL.


  Reported-by: syzbot <syzkaller@googlegroups.com>

  Fixes: 97d3aa0f3134 ("KEYS: Add a lookup_restriction function for the asymmetric
  key type")

  Cc: <stable@vger.kernel.org> # v4.12+

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Signed-off-by: David Howells <dhowells@redhat.com>

  '
submodule:
- security/keys
hunk_count: 3
covered_count: 3
