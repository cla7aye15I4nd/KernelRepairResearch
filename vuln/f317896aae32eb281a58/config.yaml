id: f317896aae32eb281a58
bug_link: https://syzkaller.appspot.com/bug?extid=f317896aae32eb281a58
title: memory leak in erase_aeb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 927cc5cec35f01fe4f8af0ba80830a90b0533983
fix_commit: c16f39d14a7e0ec59881fbdb22ae494907534384
datetime: '2020-03-30T23:02:35+02:00'
fix_commit_message: 'ubi: fastmap: Free unused fastmap anchor peb during detach


  When CONFIG_MTD_UBI_FASTMAP is enabled, fm_anchor will be assigned

  a free PEB during ubi_wl_init() or ubi_update_fastmap(). However

  if fastmap is not used or disabled on the MTD device, ubi_wl_entry

  related with the PEB will not be freed during detach.


  So Fix it by freeing the unused fastmap anchor during detach.


  Fixes: f9c34bb52997 ("ubi: Fix producing anchor PEBs")

  Reported-by: syzbot+f317896aae32eb281a58@syzkaller.appspotmail.com

  Reviewed-by: Sascha Hauer <s.hauer@pengutronix.de>

  Signed-off-by: Hou Tao <houtao1@huawei.com>

  Signed-off-by: Richard Weinberger <richard@nod.at>

  '
submodule:
- drivers/mtd/ubi
hunk_count: 3
covered_count: 0
