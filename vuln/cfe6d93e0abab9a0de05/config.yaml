id: cfe6d93e0abab9a0de05
bug_link: https://syzkaller.appspot.com/bug?extid=cfe6d93e0abab9a0de05
title: 'KASAN: use-after-free Read in iowarrior_disconnect'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 93ddb1f56ae102f14f9e46a9a9c8017faa970003
fix_commit: edc4746f253d907d048de680a621e121517f484b
datetime: '2019-10-10T12:45:06+02:00'
fix_commit_message: "USB: iowarrior: fix use-after-free on disconnect\n\nA recent\
  \ fix addressing a deadlock on disconnect introduced a new bug\nby moving the present\
  \ flag out of the critical section protected by the\ndriver-data mutex. This could\
  \ lead to a racing release() freeing the\ndriver data before disconnect() is done\
  \ with it.\n\nDue to insufficient locking a related use-after-free could be triggered\n\
  also before the above mentioned commit. Specifically, the driver needs\nto hold\
  \ the driver-data mutex also while checking the opened flag at\ndisconnect().\n\n\
  Fixes: c468a8aa790e (\"usb: iowarrior: fix deadlock on disconnect\")\nFixes: 946b960d13c1\
  \ (\"USB: add driver for iowarrior devices.\")\nCc: stable <stable@vger.kernel.org>\t\
  # 2.6.21\nReported-by: syzbot+0761012cebf7bdb38137@syzkaller.appspotmail.com\nSigned-off-by:\
  \ Johan Hovold <johan@kernel.org>\nLink: https://lore.kernel.org/r/20191009104846.5925-2-johan@kernel.org\n\
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n"
submodule:
- drivers/usb/misc
hunk_count: 3
covered_count: 3
