id: 705c61d60b091ef42c04
bug_link: https://syzkaller.appspot.com/bug?extid=705c61d60b091ef42c04
title: possible deadlock in team_del_slave (3)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ab4eb6a25de2a20c6d1d7244f8e9ad7a06cde1b0
fix_commit: bfb4fb77f9a8ce33ce357224569eae5564eec573
datetime: '2025-06-25T15:23:06-07:00'
fix_commit_message: 'team: replace team lock with rtnl lock


  syszbot reports various ordering issues for lower instance locks and

  team lock. Switch to using rtnl lock for protecting team device,

  similar to bonding. Based on the patch by Tetsuo Handa.


  Cc: Jiri Pirko <jiri@resnulli.us>

  Cc: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Reported-by: syzbot+705c61d60b091ef42c04@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=705c61d60b091ef42c04

  Reported-by: syzbot+71fd22ae4b81631e22fd@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=71fd22ae4b81631e22fd

  Fixes: 6b1d3c5f675c ("team: grab team lock during team_change_rx_flags")

  Link: https://lkml.kernel.org/r/ZoZ2RH9BcahEB9Sb@nanopsycho.orion

  Signed-off-by: Stanislav Fomichev <sdf@fomichev.me>

  Link: https://patch.msgid.link/20250623153147.3413631-1-sdf@fomichev.me

  Signed-off-by: Jakub Kicinski <kuba@kernel.org>

  '
submodule:
- drivers/net/team
- include/linux
hunk_count: 31
covered_count: 7
