id: 0849c524d9c634f5ae66
bug_link: https://syzkaller.appspot.com/bug?extid=0849c524d9c634f5ae66
title: 'KMSAN: uninit-value in capi_write'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1c2977c094998de032fee6e898c88b4a05483d08
fix_commit: fe163e534e5eecdfd7b5920b0dfd24c458ee85d6
datetime: '2019-09-07T17:44:25+02:00'
fix_commit_message: "isdn/capi: check message length in capi_write()\n\nsyzbot reported:\n\
  \n    BUG: KMSAN: uninit-value in capi_write+0x791/0xa90 drivers/isdn/capi/capi.c:700\n\
  \    CPU: 0 PID: 10025 Comm: syz-executor379 Not tainted 4.20.0-rc7+ #2\n    Hardware\
  \ name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\n\
  \    Call Trace:\n      __dump_stack lib/dump_stack.c:77 [inline]\n      dump_stack+0x173/0x1d0\
  \ lib/dump_stack.c:113\n      kmsan_report+0x12e/0x2a0 mm/kmsan/kmsan.c:613\n  \
  \    __msan_warning+0x82/0xf0 mm/kmsan/kmsan_instr.c:313\n      capi_write+0x791/0xa90\
  \ drivers/isdn/capi/capi.c:700\n      do_loop_readv_writev fs/read_write.c:703 [inline]\n\
  \      do_iter_write+0x83e/0xd80 fs/read_write.c:961\n      vfs_writev fs/read_write.c:1004\
  \ [inline]\n      do_writev+0x397/0x840 fs/read_write.c:1039\n      __do_sys_writev\
  \ fs/read_write.c:1112 [inline]\n      __se_sys_writev+0x9b/0xb0 fs/read_write.c:1109\n\
  \      __x64_sys_writev+0x4a/0x70 fs/read_write.c:1109\n      do_syscall_64+0xbc/0xf0\
  \ arch/x86/entry/common.c:291\n      entry_SYSCALL_64_after_hwframe+0x63/0xe7\n\
  \    [...]\n\nThe problem is that capi_write() is reading past the end of the message.\n\
  Fix it by checking the message's length in the needed places.\n\nReported-and-tested-by:\
  \ syzbot+0849c524d9c634f5ae66@syzkaller.appspotmail.com\nSigned-off-by: Eric Biggers\
  \ <ebiggers@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n"
submodule:
- drivers/isdn/capi
- include/uapi/linux/isdn
hunk_count: 4
covered_count: 3
