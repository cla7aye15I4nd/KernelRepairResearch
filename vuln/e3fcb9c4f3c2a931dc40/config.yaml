id: e3fcb9c4f3c2a931dc40
bug_link: https://syzkaller.appspot.com/bug?extid=e3fcb9c4f3c2a931dc40
title: 'KASAN: slab-out-of-bounds Read in hci_le_meta_evt (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dd2ac1d6d4954522c67279e42e7069b91f67f151
fix_commit: 3a56ef719f0b9682afb8a86d64b2399e36faa4e6
datetime: '2021-11-16T13:59:20+01:00'
fix_commit_message: 'Bluetooth: stop proccessing malicious adv data


  Syzbot reported slab-out-of-bounds read in hci_le_adv_report_evt(). The

  problem was in missing validaion check.


  We should check if data is not malicious and we can read next data block.

  If we won''t check ptr validness, code can read a way beyond skb->end and

  it can cause problems, of course.


  Fixes: e95beb414168 ("Bluetooth: hci_le_adv_report_evt code refactoring")

  Reported-and-tested-by: syzbot+e3fcb9c4f3c2a931dc40@syzkaller.appspotmail.com

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

  '
submodule:
- net/bluetooth
hunk_count: 2
covered_count: 0
