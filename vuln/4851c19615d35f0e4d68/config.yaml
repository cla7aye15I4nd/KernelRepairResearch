id: 4851c19615d35f0e4d68
bug_link: https://syzkaller.appspot.com/bug?extid=4851c19615d35f0e4d68
title: 'KASAN: use-after-free Write in __crypto_shash_import'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2297554f01df6d3d4e98a3915c183ce3e491740a
fix_commit: 0a84874c7e7dde5cdddc80a82093120e924a348b
datetime: '2025-05-27T13:43:32+08:00'
fix_commit_message: 'crypto: shash - Fix buffer overrun in import function


  Only set the partial block length to zero if the algorithm is

  block-only.  Otherwise the descriptor context could be empty,

  e.g., for digest_null.


  Reported-by: syzbot+4851c19615d35f0e4d68@syzkaller.appspotmail.com

  Fixes: 7650f826f7b2 ("crypto: shash - Handle partial blocks in API")

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 1
covered_count: 1
