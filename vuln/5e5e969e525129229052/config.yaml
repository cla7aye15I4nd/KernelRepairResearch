id: 5e5e969e525129229052
bug_link: https://syzkaller.appspot.com/bug?extid=5e5e969e525129229052
title: 'KASAN: invalid-free in x25_asy_free'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c433570458e49bccea5c551df628d058b3526289
fix_commit: d5c7c745f254c6cb98b3b3f15fe789b8bd770c72
datetime: '2018-12-30T20:22:48-08:00'
fix_commit_message: 'net/wan: fix a double free in x25_asy_open_tty()


  When x25_asy_open() fails, it already cleans up by itself,

  so its caller doesn''t need to free the memory again.


  It seems we still have to call x25_asy_free() to clear the SLF_INUSE

  bit, so just set these pointers to NULL after kfree().


  Reported-and-tested-by: syzbot+5e5e969e525129229052@syzkaller.appspotmail.com

  Fixes: 3b780bed3138 ("x25_asy: Free x25_asy on x25_asy_open() failure.")

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net/wan
hunk_count: 1
covered_count: 1
