id: b69368fd933c6c592f4c
bug_link: https://syzkaller.appspot.com/bug?extid=b69368fd933c6c592f4c
title: general protection fault in xfrmi_decode_session
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b805d78d300bcf2c83d6df7da0c818b0fee41427
fix_commit: 6ed69184ed9c43873b8a1ee721e3bf3c08c2c6be
datetime: '2019-03-08T07:32:16+01:00'
fix_commit_message: 'xfrm: Reset secpath in xfrm failure


  In esp4_gro_receive() and esp6_gro_receive(), secpath can be allocated

  without adding xfrm state to xvec. Then, sp->xvec[sp->len - 1] would

  fail and result in dereferencing invalid pointer in esp4_gso_segment()

  and esp6_gso_segment(). Reset secpath if xfrm function returns error.


  Fixes: 7785bba299a8 ("esp: Add a software GRO codepath")

  Reported-by: syzbot+b69368fd933c6c592f4c@syzkaller.appspotmail.com

  Signed-off-by: Myungho Jung <mhjungk@gmail.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/ipv4
- net/ipv6
hunk_count: 6
covered_count: 0
