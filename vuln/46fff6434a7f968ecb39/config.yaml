id: 46fff6434a7f968ecb39
bug_link: https://syzkaller.appspot.com/bug?extid=46fff6434a7f968ecb39
title: 'BUG: sleeping function called from invalid context in binder_ioctl'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dafa5e9ab8b5b31d64c0ded188d95f8bb6be9746
fix_commit: aed86f8add0e3f63a033861f247c9ae956b72c92
datetime: '2022-05-19T18:41:33+02:00'
fix_commit_message: 'binder: fix atomic sleep when get extended error


  binder_inner_proc_lock(thread->proc) is a spin lock, copy_to_user can''t

  be called with in this lock.


  Copy it as a local variable to fix it.


  Fixes: bd32889e841c ("binder: add BINDER_GET_EXTENDED_ERROR ioctl")

  Reported-by: syzbot+46fff6434a7f968ecb39@syzkaller.appspotmail.com

  Reviewed-by: Carlos Llamas <cmllamas@google.com>

  Signed-off-by: Schspa Shi <schspa@gmail.com>

  Link: https://lore.kernel.org/r/20220518011754.49348-1-schspa@gmail.com

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/android
hunk_count: 1
covered_count: 1
