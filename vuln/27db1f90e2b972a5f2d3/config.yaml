id: 27db1f90e2b972a5f2d3
bug_link: https://syzkaller.appspot.com/bug?extid=27db1f90e2b972a5f2d3
title: 'KASAN: use-after-free Read in perf_trace_rpc_stats_latency'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 054f155721d7af1f343ed52bea246626d8450ca8
fix_commit: 98eb6cf25f0317395d9a799d18f3d46ba26a00d3
datetime: '2018-05-01T13:46:14-04:00'
fix_commit_message: 'sunrpc: Fix latency trace point crashes


  If the rpc_task survived longer than the transport, task->tk_xprt

  points to freed memory by the time rpc_count_iostats_metrics runs.

  Replace the references to task->tk_xprt with references to the

  task''s tk_client.


  Reported-by: syzbot+27db1f90e2b972a5f2d3@syzkaller.appspotmail.com

  Fixes: 40bf7eb304b5 (''sunrpc: Add static trace point to report ...'')

  Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

  Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>

  '
submodule:
- include/trace/events
hunk_count: 3
covered_count: 3
