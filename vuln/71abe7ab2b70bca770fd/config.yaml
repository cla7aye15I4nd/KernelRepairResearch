id: 71abe7ab2b70bca770fd
bug_link: https://syzkaller.appspot.com/bug?extid=71abe7ab2b70bca770fd
title: general protection fault in put_page (3)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d47de6ac8842327ae1c782670283450159c55d5b
fix_commit: 341468e0ab4bb1b26ad0b0cee7c6db4bf283043a
datetime: '2024-11-01T20:18:21-06:00'
fix_commit_message: 'lib/iov_iter: fix bvec iterator setup


  .bi_size of bvec iterator should be initialized as real max size for

  walking, and .bi_bvec_done just counts how many bytes need to be

  skipped in the 1st bvec, so .bi_size isn''t related with .bi_bvec_done.


  This patch fixes bvec iterator initialization, and the inner `size`

  check isn''t needed any more, so revert Eric Dumazet''s commit

  7bc802acf193 ("iov-iter: do not return more bytes than requested in

  iov_iter_extract_bvec_pages()").


  Cc: Eric Dumazet <edumazet@google.com>

  Fixes: e4e535bff2bc ("iov_iter: don''t require contiguous pages in iov_iter_extract_bvec_pages")

  Reported-by: syzbot+71abe7ab2b70bca770fd@syzkaller.appspotmail.com

  Tested-by: syzbot+71abe7ab2b70bca770fd@syzkaller.appspotmail.com

  Signed-off-by: Ming Lei <ming.lei@redhat.com>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- lib
hunk_count: 1
covered_count: 0
