id: b8e8c01c8ade4fe6e48f
bug_link: https://syzkaller.appspot.com/bug?extid=b8e8c01c8ade4fe6e48f
title: 'KASAN: use-after-free Read in put_pmu_ctx'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 08245672cdc6505550d1a5020603b0a8d4a6dcc7
fix_commit: a551844e345ba2a1c533dee4b55cb0efddb1bcda
datetime: '2022-12-27T12:44:01+01:00'
fix_commit_message: 'perf: Fix use-after-free in error path


  The syscall error path has a use-after-free; put_pmu_ctx() will

  reference ctx, therefore we must ensure ctx is destroyed after pmu_ctx

  is.


  Fixes: bd2756811766 ("perf: Rewrite core context handling")

  Reported-by: syzbot+b8e8c01c8ade4fe6e48f@syzkaller.appspotmail.com

  Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>

  Tested-by: Chengming Zhou <zhouchengming@bytedance.com>

  Link: https://lkml.kernel.org/r/Y6B3xEgkbmFUCeni@hirez.programming.kicks-ass.net

  '
submodule:
- kernel/events
hunk_count: 2
covered_count: 1
