id: 49056626fe41e01f2ba7
bug_link: https://syzkaller.appspot.com/bug?extid=49056626fe41e01f2ba7
title: possible deadlock in move_pages
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0a69b6b3a026543bc215ccc866d0aea5579e6ce2
fix_commit: 30af24facf0aed12dec23bdf6eac6a907f88306a
datetime: '2024-03-26T11:07:23-07:00'
fix_commit_message: 'userfaultfd: fix deadlock warning when locking src and dst VMAs


  Use down_read_nested() to avoid the warning.


  Link: https://lkml.kernel.org/r/20240321235818.125118-1-lokeshgidra@google.com

  Fixes: 867a43a34ff8 ("userfaultfd: use per-vma locks in userfaultfd operations")

  Reported-by: syzbot+49056626fe41e01f2ba7@syzkaller.appspotmail.com

  Signed-off-by: Lokesh Gidra <lokeshgidra@google.com>

  Cc: Andrea Arcangeli <aarcange@redhat.com>

  Cc: Axel Rasmussen <axelrasmussen@google.com>

  Cc: Brian Geffon <bgeffon@google.com>

  Cc: David Hildenbrand <david@redhat.com>

  Cc: Hillf Danton <hdanton@sina.com>

  Cc: Jann Horn <jannh@google.com> [Bug #2]

  Cc: Kalesh Singh <kaleshsingh@google.com>

  Cc: Lokesh Gidra <lokeshgidra@google.com>

  Cc: Mike Rapoport (IBM) <rppt@kernel.org>

  Cc: Nicolas Geoffray <ngeoffray@google.com>

  Cc: Peter Xu <peterx@redhat.com>

  Cc: Suren Baghdasaryan <surenb@google.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 1
covered_count: 1
