id: 53bb24d476ef8368a7f0
bug_link: https://syzkaller.appspot.com/bug?extid=53bb24d476ef8368a7f0
title: kernel BUG in __journal_res_get (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9c32cda43eb78f78c73aee4aa344b777714e259b
fix_commit: 4c0d2c67ac6d54ba71bb3438147b144c25fdee2c
datetime: '2025-04-20T19:41:38-04:00'
fix_commit_message: 'bcachefs: Fix early startup error path


  Don''t set JOURNAL_running until we''re also calling

  journal_space_available() for the first time.


  If JOURNAL_running is set, shutdown will write an empty journal entry -

  but this will hit an assert in journal_entry_open() if we''ve never

  called journal_space_available().


  Reported-by: syzbot+53bb24d476ef8368a7f0@syzkaller.appspotmail.com

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 6
covered_count: 2
