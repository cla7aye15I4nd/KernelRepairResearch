id: eba992608adf3d796bcc
bug_link: https://syzkaller.appspot.com/bug?extid=eba992608adf3d796bcc
title: 'KASAN: use-after-free Write in hci_sock_bind'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 18f81241b74fb49d576c83fbbab9a0b6e3bb20d4
fix_commit: 11eb85ec42dc8c7a7ec519b90ccf2eeae9409de8
datetime: '2020-01-26T10:34:17+02:00'
fix_commit_message: 'Bluetooth: Fix race condition in hci_release_sock()


  Syzbot managed to trigger a use after free "KASAN: use-after-free Write

  in hci_sock_bind".  I have reviewed the code manually and one possibly

  cause I have found is that we are not holding lock_sock(sk) when we do

  the hci_dev_put(hdev) in hci_sock_release().  My theory is that the bind

  and the release are racing against each other which results in this use

  after free.


  Reported-by: syzbot+eba992608adf3d796bcc@syzkaller.appspotmail.com

  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>

  Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>

  '
submodule:
- net/bluetooth
hunk_count: 2
covered_count: 0
