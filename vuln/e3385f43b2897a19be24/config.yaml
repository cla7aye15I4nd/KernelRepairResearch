id: e3385f43b2897a19be24
bug_link: https://syzkaller.appspot.com/bug?extid=e3385f43b2897a19be24
title: general protection fault in sys_mremap
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 25601e85441dd91cf7973b002f27af4c5b8691ea
fix_commit: 36eed5400805b294f1df39b0e3ebc5b7971b3c16
datetime: '2025-04-01T15:17:09-07:00'
fix_commit_message: 'mm/mremap: do not set vrm->vma NULL immediately prior to checking
  it


  This seems rather unwise.  If we cannot merge, extend, then we need to

  recall the original VMA to see if we need to uncharge.


  If we do need to, do so.


  Link: https://lkml.kernel.org/r/b2fb6b9c-376d-4e9b-905e-26d847fd3865@lucifer.local

  Fixes: d5c8aec0542e ("mm/mremap: initial refactor of move_vma()")

  Signed-off-by: Lorenzo Stoakes <lorenzo.stoakes@oracle.com>

  Reported-=by: "Lai, Yi" <yi1.lai@linux.intel.com>

  Closes: https://lore.kernel.org/linux-mm/Z+lcvEIHMLiKVR1i@ly-workstation/

  Cc: Liam R. Howlett <Liam.Howlett@Oracle.com>

  Cc: Vlastimil Babka <vbabka@suse.cz>

  Cc: Harry Yoo <harry.yoo@oracle.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 1
covered_count: 1
