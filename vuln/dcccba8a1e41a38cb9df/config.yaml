id: dcccba8a1e41a38cb9df
bug_link: https://syzkaller.appspot.com/bug?extid=dcccba8a1e41a38cb9df
title: 'linux-next test error: WARNING in __nf_unregister_net_hook'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c7d13358b6a2f49f81a34aa323a2d0878a0532a2
fix_commit: 43016d02cf6e46edfc4696452251d34bba0c0435
datetime: '2021-05-03T23:04:01+02:00'
fix_commit_message: "netfilter: arptables: use pernet ops struct during unregister\n\
  \nLike with iptables and ebtables, hook unregistration has to use the\npernet ops\
  \ struct, not the template.\n\nThis triggered following splat:\n  hook not found,\
  \ pf 3 num 0\n  WARNING: CPU: 0 PID: 224 at net/netfilter/core.c:480 __nf_unregister_net_hook+0x1eb/0x610\
  \ net/netfilter/core.c:480\n[..]\n nf_unregister_net_hook net/netfilter/core.c:502\
  \ [inline]\n nf_unregister_net_hooks+0x117/0x160 net/netfilter/core.c:576\n arpt_unregister_table_pre_exit+0x67/0x80\
  \ net/ipv4/netfilter/arp_tables.c:1565\n\nFixes: f9006acc8dfe5 (\"netfilter: arp_tables:\
  \ pass table pointer via nf_hook_ops\")\nReported-by: syzbot+dcccba8a1e41a38cb9df@syzkaller.appspotmail.com\n\
  Signed-off-by: Florian Westphal <fw@strlen.de>\nSigned-off-by: Pablo Neira Ayuso\
  \ <pablo@netfilter.org>\n"
submodule:
- include/linux/netfilter_arp
- net/ipv4
hunk_count: 3
covered_count: 1
