id: 56029fd3642567f395f0
bug_link: https://syzkaller.appspot.com/bug?extid=56029fd3642567f395f0
title: 'KASAN: use-after-free Read in ip6_xmit'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 55ea874306ea28e6be9e07b7e89bbb9fb674e8eb
fix_commit: c113187d38ff85dc302a1bb55864b203ebb2ba10
datetime: '2018-02-27T14:41:48-05:00'
fix_commit_message: 'tls: Use correct sk->sk_prot for IPV6


  The tls ulp overrides sk->prot with a new tls specific proto structs.

  The tls specific structs were previously based on the ipv4 specific

  tcp_prot sturct.

  As a result, attaching the tls ulp to an ipv6 tcp socket replaced

  some ipv6 callback with the ipv4 equivalents.


  This patch adds ipv6 tls proto structs and uses them when

  attached to ipv6 sockets.


  Fixes: 3c4d7559159b (''tls: kernel TLS support'')

  Signed-off-by: Boris Pismenny <borisp@mellanox.com>

  Signed-off-by: Ilya Lesokhin <ilyal@mellanox.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/tls
hunk_count: 4
covered_count: 0
