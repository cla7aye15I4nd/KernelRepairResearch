id: 636c58f40a86b4a879e7
bug_link: https://syzkaller.appspot.com/bug?extid=636c58f40a86b4a879e7
title: memory leak in hub_event (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 25dda9fc56bd90d45f9a4516bcfa5211e61b4290
fix_commit: dcb4b8ad6a448532d8b681b5d1a7036210b622de
datetime: '2021-05-21T14:25:53+02:00'
fix_commit_message: "misc/uss720: fix memory leak in uss720_probe\n\nuss720_probe\
  \ forgets to decrease the refcount of usbdev in uss720_probe.\nFix this by decreasing\
  \ the refcount of usbdev by usb_put_dev.\n\nBUG: memory leak\nunreferenced object\
  \ 0xffff888101113800 (size 2048):\n  comm \"kworker/0:1\", pid 7, jiffies 4294956777\
  \ (age 28.870s)\n  hex dump (first 32 bytes):\n    ff ff ff ff 31 00 00 00 00 00\
  \ 00 00 00 00 00 00  ....1...........\n    00 00 00 00 00 00 00 00 00 00 00 00 03\
  \ 00 00 00  ................\n  backtrace:\n    [<ffffffff82b8e822>] kmalloc include/linux/slab.h:554\
  \ [inline]\n    [<ffffffff82b8e822>] kzalloc include/linux/slab.h:684 [inline]\n\
  \    [<ffffffff82b8e822>] usb_alloc_dev+0x32/0x450 drivers/usb/core/usb.c:582\n\
  \    [<ffffffff82b98441>] hub_port_connect drivers/usb/core/hub.c:5129 [inline]\n\
  \    [<ffffffff82b98441>] hub_port_connect_change drivers/usb/core/hub.c:5363 [inline]\n\
  \    [<ffffffff82b98441>] port_event drivers/usb/core/hub.c:5509 [inline]\n    [<ffffffff82b98441>]\
  \ hub_event+0x1171/0x20c0 drivers/usb/core/hub.c:5591\n    [<ffffffff81259229>]\
  \ process_one_work+0x2c9/0x600 kernel/workqueue.c:2275\n    [<ffffffff81259b19>]\
  \ worker_thread+0x59/0x5d0 kernel/workqueue.c:2421\n    [<ffffffff81261228>] kthread+0x178/0x1b0\
  \ kernel/kthread.c:292\n    [<ffffffff8100227f>] ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:294\n\
  \nFixes: 0f36163d3abe (\"[PATCH] usb: fix uss720 schedule with interrupts off\"\
  )\nCc: stable <stable@vger.kernel.org>\nReported-by: syzbot+636c58f40a86b4a879e7@syzkaller.appspotmail.com\n\
  Signed-off-by: Dongliang Mu <mudongliangabcd@gmail.com>\nLink: https://lore.kernel.org/r/20210514124348.6587-1-mudongliangabcd@gmail.com\n\
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n"
submodule:
- drivers/usb/misc
hunk_count: 1
covered_count: 0
