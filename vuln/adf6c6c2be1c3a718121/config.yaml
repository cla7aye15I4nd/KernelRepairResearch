id: adf6c6c2be1c3a718121
bug_link: https://syzkaller.appspot.com/bug?extid=adf6c6c2be1c3a718121
title: 'INFO: task hung in hashlimit_mt_check_common'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c4a3922d2d20c710f827d3a115ee338e8d0467df
fix_commit: 8d0015a7ab76b8b1e89a3e5f5710a6e5103f2dd5
datetime: '2020-02-07T15:53:31+01:00'
fix_commit_message: 'netfilter: xt_hashlimit: limit the max size of hashtable


  The user-specified hashtable size is unbound, this could

  easily lead to an OOM or a hung task as we hold the global

  mutex while allocating and initializing the new hashtable.


  Add a max value to cap both cfg->size and cfg->max, as

  suggested by Florian.


  Reported-and-tested-by: syzbot+adf6c6c2be1c3a718121@syzkaller.appspotmail.com

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Reviewed-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 2
covered_count: 2
