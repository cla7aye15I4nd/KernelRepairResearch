id: 808f3f84407f08a93022
bug_link: https://syzkaller.appspot.com/bug?extid=808f3f84407f08a93022
title: 'UBSAN: array-index-out-of-bounds in dbNextAG (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b0b2fc815e514221f01384f39fbfbff65d897e1c
fix_commit: e63866a475562810500ea7f784099bfe341e761a
datetime: '2024-08-23T14:15:00-05:00'
fix_commit_message: 'jfs: fix out-of-bounds in dbNextAG() and diAlloc()


  In dbNextAG() , there is no check for the case where bmp->db_numag is

  greater or same than MAXAG due to a polluted image, which causes an

  out-of-bounds. Therefore, a bounds check should be added in dbMount().


  And in dbNextAG(), a check for the case where agpref is greater than

  bmp->db_numag should be added, so an out-of-bounds exception should be

  prevented.


  Additionally, a check for the case where agno is greater or same than

  MAXAG should be added in diAlloc() to prevent out-of-bounds.


  Reported-by: Jeongjun Park <aha310510@gmail.com>

  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Signed-off-by: Jeongjun Park <aha310510@gmail.com>

  Signed-off-by: Dave Kleikamp <dave.kleikamp@oracle.com>

  '
submodule:
- fs/jfs
hunk_count: 3
covered_count: 2
