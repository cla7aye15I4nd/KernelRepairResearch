id: f5378bcf0f0cab45c1c6
bug_link: https://syzkaller.appspot.com/bug?extid=f5378bcf0f0cab45c1c6
title: WARNING in hif_usb_send/usb_submit_urb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: dd95f2239fc846795fc926787c3ae0ca701c9840
fix_commit: 16ef02bad239f11f322df8425d302be62f0443ce
datetime: '2022-10-11T07:43:51+03:00'
fix_commit_message: "wifi: ath9k: verify the expected usb_endpoints are present\n\n\
  The bug arises when a USB device claims to be an ATH9K but doesn't\nhave the expected\
  \ endpoints. (In this case there was an interrupt\nendpoint where the driver expected\
  \ a bulk endpoint.) The kernel\nneeds to be able to handle such devices without\
  \ getting an internal error.\n\nusb 1-1: BOGUS urb xfer, pipe 3 != type 1\nWARNING:\
  \ CPU: 3 PID: 500 at drivers/usb/core/urb.c:493 usb_submit_urb+0xce2/0x1430 drivers/usb/core/urb.c:493\n\
  Modules linked in:\nCPU: 3 PID: 500 Comm: kworker/3:2 Not tainted 5.10.135-syzkaller\
  \ #0\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.12.0-1 04/01/2014\n\
  Workqueue: events request_firmware_work_func\nRIP: 0010:usb_submit_urb+0xce2/0x1430\
  \ drivers/usb/core/urb.c:493\nCall Trace:\n ath9k_hif_usb_alloc_rx_urbs drivers/net/wireless/ath/ath9k/hif_usb.c:908\
  \ [inline]\n ath9k_hif_usb_alloc_urbs+0x75e/0x1010 drivers/net/wireless/ath/ath9k/hif_usb.c:1019\n\
  \ ath9k_hif_usb_dev_init drivers/net/wireless/ath/ath9k/hif_usb.c:1109 [inline]\n\
  \ ath9k_hif_usb_firmware_cb+0x142/0x530 drivers/net/wireless/ath/ath9k/hif_usb.c:1242\n\
  \ request_firmware_work_func+0x12e/0x240 drivers/base/firmware_loader/main.c:1097\n\
  \ process_one_work+0x9af/0x1600 kernel/workqueue.c:2279\n worker_thread+0x61d/0x12f0\
  \ kernel/workqueue.c:2425\n kthread+0x3b4/0x4a0 kernel/kthread.c:313\n ret_from_fork+0x22/0x30\
  \ arch/x86/entry/entry_64.S:299\n\nFound by Linux Verification Center (linuxtesting.org)\
  \ with Syzkaller.\n\nSuggested-by: Alan Stern <stern@rowland.harvard.edu>\nSigned-off-by:\
  \ Fedor Pchelkin <pchelkin@ispras.ru>\nSigned-off-by: Alexey Khoroshilov <khoroshilov@ispras.ru>\n\
  Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>\nSigned-off-by: Kalle Valo <quic_kvalo@quicinc.com>\n\
  Link: https://lore.kernel.org/r/20221008211532.74583-1-pchelkin@ispras.ru\n"
submodule:
- drivers/net/wireless/ath/ath9k
hunk_count: 1
covered_count: 0
