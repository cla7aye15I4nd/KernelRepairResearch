id: 114b15f2be420a8886c3
bug_link: https://syzkaller.appspot.com/bug?extid=114b15f2be420a8886c3
title: kernel BUG at net/l2tp/l2tp_ppp.c:LINE!
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 581e7226a5d43f629eb6399a121f85f6a15f81be
fix_commit: e5571240236c5652f3e079b1d5866716a7ad819c
datetime: '2018-01-24T15:54:30-05:00'
fix_commit_message: 'kcm: Check if sk_user_data already set in kcm_attach


  This is needed to prevent sk_user_data being overwritten.

  The check is done under the callback lock. This should prevent

  a socket from being attached twice to a KCM mux. It also prevents

  a socket from being attached for other use cases of sk_user_data

  as long as the other cases set sk_user_data under the lock.

  Followup work is needed to unify all the use cases of sk_user_data

  to use the same locking.


  Reported-by: syzbot+114b15f2be420a8886c3@syzkaller.appspotmail.com

  Fixes: ab7ac4eb9832 ("kcm: Kernel Connection Multiplexor module")

  Signed-off-by: Tom Herbert <tom@quantonium.net>

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/kcm
hunk_count: 2
covered_count: 0
