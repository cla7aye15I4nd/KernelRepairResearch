id: 9cd5837a045bbee5b810
bug_link: https://syzkaller.appspot.com/bug?extid=9cd5837a045bbee5b810
title: 'UBSAN: shift-out-of-bounds in xfrm_set_default'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2d151d39073aff498358543801fca0f670fea981
fix_commit: 5d8dbb7fb82b8661c16d496644b931c0e2e3a12e
datetime: '2021-07-29T08:04:10+02:00'
fix_commit_message: 'net: xfrm: fix shift-out-of-bounce


  We need to check up->dirmask to avoid shift-out-of-bounce bug,

  since up->dirmask comes from userspace.


  Also, added XFRM_USERPOLICY_DIRMASK_MAX constant to uapi to inform

  user-space that up->dirmask has maximum possible value


  Fixes: 2d151d39073a ("xfrm: Add possibility to set the default to block if we have
  no policy")

  Reported-and-tested-by: syzbot+9cd5837a045bbee5b810@syzkaller.appspotmail.com

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- include/uapi/linux
- net/xfrm
hunk_count: 2
covered_count: 1
