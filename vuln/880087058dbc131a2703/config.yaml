id: 880087058dbc131a2703
bug_link: https://syzkaller.appspot.com/bug?extid=880087058dbc131a2703
title: general protection fault in get_work_pool
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 25432eba9cd8f2ef5afef55be811b010a004b5fa
fix_commit: 07bf7908950a8b14e81aa1807e3c667eab39287a
datetime: '2018-08-03T10:23:07+02:00'
fix_commit_message: 'xfrm: Validate address prefix lengths in the xfrm selector.


  We don''t validate the address prefix lengths in the xfrm

  selector we got from userspace. This can lead to undefined

  behaviour in the address matching functions if the prefix

  is too big for the given address family. Fix this by checking

  the prefixes and refuse SA/policy insertation when a prefix

  is invalid.


  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Reported-by: Air Icy <icytxw@gmail.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 2
covered_count: 1
