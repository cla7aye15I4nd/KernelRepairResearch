id: 9c2811fd56591639ff5f
bug_link: https://syzkaller.appspot.com/bug?extid=9c2811fd56591639ff5f
title: 'KASAN: slab-out-of-bounds Read in hdr_delete_de'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 98bea253aa28ad8be2ce565a9ca21beb4a9419e5
fix_commit: ab84eee4c7ab929996602eda7832854c35a6dda2
datetime: '2023-03-27T16:59:12+04:00'
fix_commit_message: "fs/ntfs3: Fix slab-out-of-bounds read in hdr_delete_de()\n\n\
  Here is a BUG report from syzbot:\n\nBUG: KASAN: slab-out-of-bounds in hdr_delete_de+0xe0/0x150\
  \ fs/ntfs3/index.c:806\nRead of size 16842960 at addr ffff888079cc0600 by task syz-executor934/3631\n\
  \nCall Trace:\n memmove+0x25/0x60 mm/kasan/shadow.c:54\n hdr_delete_de+0xe0/0x150\
  \ fs/ntfs3/index.c:806\n indx_delete_entry+0x74f/0x3670 fs/ntfs3/index.c:2193\n\
  \ ni_remove_name+0x27a/0x980 fs/ntfs3/frecord.c:2910\n ntfs_unlink_inode+0x3d4/0x720\
  \ fs/ntfs3/inode.c:1712\n ntfs_rename+0x41a/0xcb0 fs/ntfs3/namei.c:276\n\nBefore\
  \ using the meta-data in struct INDEX_HDR, we need to\ncheck index header valid\
  \ or not. Otherwise, the corruptedi\n(or malicious) fs image can cause out-of-bounds\
  \ access which\ncould make kernel panic.\n\nFixes: 82cae269cfa9 (\"fs/ntfs3: Add\
  \ initialization of super block\")\nReported-by: syzbot+9c2811fd56591639ff5f@syzkaller.appspotmail.com\n\
  Signed-off-by: Zeng Heng <zengheng4@huawei.com>\nSigned-off-by: Konstantin Komarov\
  \ <almaz.alexandrovich@paragon-software.com>\n"
submodule:
- fs/ntfs3
hunk_count: 3
covered_count: 1
