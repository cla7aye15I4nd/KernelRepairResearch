id: 8bca99e91de7e060e4ea
bug_link: https://syzkaller.appspot.com/bug?extid=8bca99e91de7e060e4ea
title: WARNING in free_ruleset
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0af2f6be1b4281385b618cb86ad946eded089ac8
fix_commit: fe81536af3978f26a1383e4da7f135b973eb4209
datetime: '2025-04-08T19:18:20+02:00'
fix_commit_message: 'landlock: Remove incorrect warning


  landlock_put_hierarchy() can be called when an error occurs in

  landlock_merge_ruleset() due to insufficient memory.  In this case, the

  domain''s audit details might not have been allocated yet, which would

  cause landlock_free_hierarchy_details() to print a warning (but still

  safely handle this case).


  We could keep the WARN_ON_ONCE(!hierarchy) but it''s not worth it for

  this kind of function, so let''s remove it entirely.


  Cc: Paul Moore <paul@paul-moore.com>

  Reported-by: syzbot+8bca99e91de7e060e4ea@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20250331104709.897062-1-mic@digikod.net

  Reviewed-by: Günther Noack <gnoack@google.com>

  Signed-off-by: Mickaël Salaün <mic@digikod.net>

  '
submodule:
- security/landlock
hunk_count: 1
covered_count: 1
