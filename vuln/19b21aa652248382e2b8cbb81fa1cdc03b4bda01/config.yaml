id: 19b21aa652248382e2b8cbb81fa1cdc03b4bda01
bug_link: https://syzkaller.appspot.com/bug?extid=19b21aa652248382e2b8cbb81fa1cdc03b4bda01
title: 'KASAN: stack-out-of-bounds Read in xfrm_state_find (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cf37966751747727629fe51fd4a1d4edd8457c60
fix_commit: c9f3f813d462c72dbe412cee6a5cbacf13c4ad5e
datetime: '2017-11-03T13:02:41+01:00'
fix_commit_message: 'xfrm: Fix stack-out-of-bounds read in xfrm_state_find.


  When we do tunnel or beet mode, we pass saddr and daddr from the

  template to xfrm_state_find(), this is ok. On transport mode,

  we pass the addresses from the flowi, assuming that the IP

  addresses (and address family) don''t change during transformation.

  This assumption is wrong in the IPv4 mapped IPv6 case, packet

  is IPv4 and template is IPv6. Fix this by using the addresses

  from the template unconditionally.


  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 1
covered_count: 1
