id: a24c5252f3e3ab733464
bug_link: https://syzkaller.appspot.com/bug?extid=a24c5252f3e3ab733464
title: memory leak in do_replace
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9a4d6dd554b86e65581ef6b6638a39ae079b17ac
fix_commit: 62ce44c4fff947eebdf10bb582267e686e6835c9
datetime: '2022-09-20T23:50:03+02:00'
fix_commit_message: 'netfilter: ebtables: fix memory leak when blob is malformed


  The bug fix was incomplete, it "replaced" crash with a memory leak.

  The old code had an assignment to "ret" embedded into the conditional,

  restore this.


  Fixes: 7997eff82828 ("netfilter: ebtables: reject blobs that don''t provide all
  entry points")

  Reported-and-tested-by: syzbot+a24c5252f3e3ab733464@syzkaller.appspotmail.com

  Signed-off-by: Florian Westphal <fw@strlen.de>

  '
submodule:
- net/bridge
hunk_count: 1
covered_count: 0
