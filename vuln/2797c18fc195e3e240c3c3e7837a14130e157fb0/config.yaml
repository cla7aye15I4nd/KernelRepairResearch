id: 2797c18fc195e3e240c3c3e7837a14130e157fb0
bug_link: https://syzkaller.appspot.com/bug?extid=2797c18fc195e3e240c3c3e7837a14130e157fb0
title: WARNING in kmalloc_slab (3)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9c4e6b1a7027f102990c0395296015a812525f4d
fix_commit: 88913bd8ea2a75d7e460a4bed5f75e1c32660d7e
datetime: '2018-02-21T15:35:43-08:00'
fix_commit_message: 'kernel/relay.c: limit kmalloc size to KMALLOC_MAX_SIZE


  chan->n_subbufs is set by the user and relay_create_buf() does a kmalloc()

  of chan->n_subbufs * sizeof(size_t *).


  kmalloc_slab() will generate a warning when this fails if

  chan->subbufs * sizeof(size_t *) > KMALLOC_MAX_SIZE.


  Limit chan->n_subbufs to the maximum allowed kmalloc() size.


  Link: http://lkml.kernel.org/r/alpine.DEB.2.10.1802061216100.122576@chino.kir.corp.google.com

  Fixes: f6302f1bcd75 ("relay: prevent integer overflow in relay_open()")

  Signed-off-by: David Rientjes <rientjes@google.com>

  Reviewed-by: Andrew Morton <akpm@linux-foundation.org>

  Cc: Jens Axboe <axboe@kernel.dk>

  Cc: Dave Jiang <dave.jiang@intel.com>

  Cc: Al Viro <viro@zeniv.linux.org.uk>

  Cc: Dan Carpenter <dan.carpenter@oracle.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- kernel
hunk_count: 1
covered_count: 0
