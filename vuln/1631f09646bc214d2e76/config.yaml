id: 1631f09646bc214d2e76
bug_link: https://syzkaller.appspot.com/bug?extid=1631f09646bc214d2e76
title: 'UBSAN: shift-out-of-bounds in ntfs_fill_super'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: cd290a9839cee2f6641558877e707bd373c8f6f1
fix_commit: a3b774342fa752a5290c0de36375289dfcf4a260
datetime: '2022-05-12T20:38:37-07:00'
fix_commit_message: "fs/ntfs3: validate BOOT sectors_per_clusters\n\nWhen the NTFS\
  \ BOOT sectors_per_clusters field is > 0x80, it represents a\nshift value.  Make\
  \ sure that the shift value is not too large before using\nit (NTFS max cluster\
  \ size is 2MB).  Return -EVINVAL if it too large.\n\nThis prevents negative shift\
  \ values and shift values that are larger than\nthe field size.\n\nPrevents this\
  \ UBSAN error:\n\n UBSAN: shift-out-of-bounds in ../fs/ntfs3/super.c:673:16\n shift\
  \ exponent -192 is negative\n\nLink: https://lkml.kernel.org/r/20220502175342.20296-1-rdunlap@infradead.org\n\
  Fixes: 82cae269cfa9 (\"fs/ntfs3: Add initialization of super block\")\nSigned-off-by:\
  \ Randy Dunlap <rdunlap@infradead.org>\nReported-by: syzbot+1631f09646bc214d2e76@syzkaller.appspotmail.com\n\
  Reviewed-by: Namjae Jeon <linkinjeon@kernel.org>\nCc: Konstantin Komarov <almaz.alexandrovich@paragon-software.com>\n\
  Cc: Alexander Viro <viro@zeniv.linux.org.uk>\nCc: Kari Argillander <kari.argillander@stargateuniverse.net>\n\
  Cc: Namjae Jeon <linkinjeon@kernel.org>\nCc: Matthew Wilcox <willy@infradead.org>\n\
  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>\n"
submodule:
- fs/ntfs3
hunk_count: 2
covered_count: 1
