id: 1f2eb3e8cd123ffce499
bug_link: https://syzkaller.appspot.com/bug?extid=1f2eb3e8cd123ffce499
title: 'UBSAN: array-index-out-of-bounds in FSE_decompress_wksp_body_bmi2'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ffc253263a1375a65fa6c9f62a893e9767fbebfa
fix_commit: 77618db346455129424fadbbaec596a09feaf3bb
datetime: '2023-11-14T17:12:52-08:00'
fix_commit_message: 'zstd: Fix array-index-out-of-bounds UBSAN warning


  Zstd used an array of length 1 to mean a flexible array for C89

  compatibility. Switch to a C99 flexible array to fix the UBSAN warning.


  Tested locally by booting the kernel and writing to and reading from a

  BtrFS filesystem with zstd compression enabled. I was unable to reproduce

  the issue before the fix, however it is a trivial change.


  Link: https://lkml.kernel.org/r/20231012213428.1390905-1-nickrterrell@gmail.com

  Reported-by: syzbot+1f2eb3e8cd123ffce499@syzkaller.appspotmail.com

  Reported-by: Eric Biggers <ebiggers@kernel.org>

  Reported-by: Kees Cook <keescook@chromium.org>

  Signed-off-by: Nick Terrell <terrelln@fb.com>

  Reviewed-by: Kees Cook <keescook@chromium.org>

  '
submodule:
- lib/zstd/common
hunk_count: 1
covered_count: 1
