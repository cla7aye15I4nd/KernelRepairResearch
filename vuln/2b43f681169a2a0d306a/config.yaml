id: 2b43f681169a2a0d306a
bug_link: https://syzkaller.appspot.com/bug?extid=2b43f681169a2a0d306a
title: WARNING in ebt_do_table
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9e8c8dabb78e886ace989729e763d28c76f5169e
fix_commit: 11ff7288beb2b7da889a014aff0a7b80bf8efcf3
datetime: '2018-06-06T15:04:04+02:00'
fix_commit_message: 'netfilter: ebtables: reject non-bridge targets


  the ebtables evaluation loop expects targets to return

  positive values (jumps), or negative values (absolute verdicts).


  This is completely different from what xtables does.

  In xtables, targets are expected to return the standard netfilter

  verdicts, i.e. NF_DROP, NF_ACCEPT, etc.


  ebtables will consider these as jumps.


  Therefore reject any target found due to unspec fallback.

  v2: also reject watchers.  ebtables ignores their return value, so

  a target that assumes skb ownership (and returns NF_STOLEN) causes

  use-after-free.


  The only watchers in the ''ebtables'' front-end are log and nflog;

  both have AF_BRIDGE specific wrappers on kernel side.


  Reported-by: syzbot+2b43f681169a2a0d306a@syzkaller.appspotmail.com

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/bridge
hunk_count: 2
covered_count: 0
