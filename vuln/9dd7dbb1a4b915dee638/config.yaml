id: 9dd7dbb1a4b915dee638
bug_link: https://syzkaller.appspot.com/bug?extid=9dd7dbb1a4b915dee638
title: possible deadlock in blk_mq_freeze_queue_nomemsave
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6f65947a1e684db28b9407ea51927ed5157caf41
fix_commit: 4bb08cf974c54adc321b8505ce82720c2a15c451
datetime: '2025-06-11T06:41:45-06:00'
fix_commit_message: 'loop: move lo_set_size() out of queue freeze


  It isn''t necessary to freeze queue for updating disk size given submit_bio()

  doesn''t grab queue usage counter for checking eod.


  Also many driver won''t freeze queue for calling set_capacity_and_notify().


  Move lo_set_size() out of queue freeze for fixing many lockdep warning

  report.


  Link: https://lore.kernel.org/linux-block/67ea99e0.050a0220.3c3d88.0042.GAE@google.com/

  Reported-by: syzbot+9dd7dbb1a4b915dee638@syzkaller.appspotmail.com

  Signed-off-by: Ming Lei <ming.lei@redhat.com>

  Link: https://lore.kernel.org/r/20250611084938.108829-1-ming.lei@redhat.com

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- drivers/block
hunk_count: 2
covered_count: 2
