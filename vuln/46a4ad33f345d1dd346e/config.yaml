id: 46a4ad33f345d1dd346e
bug_link: https://syzkaller.appspot.com/bug?extid=46a4ad33f345d1dd346e
title: general protection fault in dccp_timeout_nlattr_to_obj
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: fb46f1b7806977e9135a83eb347e5d82e68233a2
fix_commit: 1d9a7acd3d1e74c2d150d8934f7f55bed6d70858
datetime: '2020-01-08T23:31:22+01:00'
fix_commit_message: "netfilter: conntrack: dccp, sctp: handle null timeout argument\n\
  \nThe timeout pointer can be NULL which means we should modify the\nper-nets timeout\
  \ instead.\n\nAll do this, except sctp and dccp which instead give:\n\ngeneral protection\
  \ fault: 0000 [#1] PREEMPT SMP KASAN\nnet/netfilter/nf_conntrack_proto_dccp.c:682\n\
  \ ctnl_timeout_parse_policy+0x150/0x1d0 net/netfilter/nfnetlink_cttimeout.c:67\n\
  \ cttimeout_default_set+0x150/0x1c0 net/netfilter/nfnetlink_cttimeout.c:368\n nfnetlink_rcv_msg+0xcf2/0xfb0\
  \ net/netfilter/nfnetlink.c:229\n netlink_rcv_skb+0x177/0x450 net/netlink/af_netlink.c:2477\n\
  \nReported-by: syzbot+46a4ad33f345d1dd346e@syzkaller.appspotmail.com\nFixes: c779e849608a8\
  \ (\"netfilter: conntrack: remove get_timeout() indirection\")\nSigned-off-by: Florian\
  \ Westphal <fw@strlen.de>\nSigned-off-by: Pablo Neira Ayuso <pablo@netfilter.org>\n"
submodule:
- net/netfilter
hunk_count: 2
covered_count: 1
