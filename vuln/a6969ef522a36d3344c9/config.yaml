id: a6969ef522a36d3344c9
bug_link: https://syzkaller.appspot.com/bug?extid=a6969ef522a36d3344c9
title: 'BUG: corrupted list in em28xx_init_extension'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9015fcc256d3a74d4fdc3d87877e270968550444
fix_commit: 2c98b8a3458df03abdc6945bbef67ef91d181938
datetime: '2021-09-30T10:07:38+02:00'
fix_commit_message: 'media: em28xx: add missing em28xx_close_extension


  If em28xx dev has ->dev_next pointer, we need to delete ->dev_next list

  node from em28xx_extension_devlist on disconnect to avoid UAF bugs and

  corrupted list bugs, since driver frees this pointer on disconnect.


  Reported-and-tested-by: syzbot+a6969ef522a36d3344c9@syzkaller.appspotmail.com


  Fixes: 1a23f81b7dc3 ("V4L/DVB (9979): em28xx: move usb probe code to a proper place")

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

  '
submodule:
- drivers/media/usb/em28xx
hunk_count: 1
covered_count: 0
