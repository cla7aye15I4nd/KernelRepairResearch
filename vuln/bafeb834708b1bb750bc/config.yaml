id: bafeb834708b1bb750bc
bug_link: https://syzkaller.appspot.com/bug?extid=bafeb834708b1bb750bc
title: 'INFO: task hung in scsi_remove_host'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: da6d507f5ff328f346b3c50e19e19993027b8ffd
fix_commit: 2b36209ca8182c5e0221dd416106d434de433d34
datetime: '2022-09-01T01:02:10-04:00'
fix_commit_message: 'scsi: core: Revert "Call blk_mq_free_tag_set() earlier"


  Revert the patch series "Call blk_mq_free_tag_set() earlier" because it

  introduces a deadlock if the scsi_remove_host() caller holds a reference on

  a device, target or host.


  Link: https://lore.kernel.org/r/20220821220502.13685-2-bvanassche@acm.org

  Fixes: f323896fe6fa ("scsi: core: Call blk_mq_free_tag_set() earlier")

  Reported-by: syzbot+bafeb834708b1bb750bc@syzkaller.appspotmail.com

  Tested-by: Kenneth R. Crudup <kenny@panix.com>

  Signed-off-by: Bart Van Assche <bvanassche@acm.org>

  Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

  '
submodule:
- drivers/scsi
hunk_count: 4
covered_count: 1
