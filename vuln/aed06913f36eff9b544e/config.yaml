id: aed06913f36eff9b544e
bug_link: https://syzkaller.appspot.com/bug?extid=aed06913f36eff9b544e
title: 'KASAN: slab-out-of-bounds Read in ntfs_attr_find'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d72e720a19393eb611a112e4c5c377785dbd645d
fix_commit: 4f8c94022f0bc3babd0a124c0a7dcdd7547bd94e
datetime: '2020-10-13T18:38:27-07:00'
fix_commit_message: 'ntfs: add check for mft record size in superblock


  Number of bytes allocated for mft record should be equal to the mft record

  size stored in ntfs superblock as reported by syzbot, userspace might

  trigger out-of-bounds read by dereferencing ctx->attr in ntfs_attr_find()


  Reported-by: syzbot+aed06913f36eff9b544e@syzkaller.appspotmail.com

  Signed-off-by: Rustam Kovhaev <rkovhaev@gmail.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  Tested-by: syzbot+aed06913f36eff9b544e@syzkaller.appspotmail.com

  Acked-by: Anton Altaparmakov <anton@tuxera.com>

  Link: https://syzkaller.appspot.com/bug?extid=aed06913f36eff9b544e

  Link: https://lkml.kernel.org/r/20200824022804.226242-1-rkovhaev@gmail.com

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- fs/ntfs
hunk_count: 1
covered_count: 1
