id: a730016dc0bdce4f6ff5
bug_link: https://syzkaller.appspot.com/bug?extid=a730016dc0bdce4f6ff5
title: memory leak in io_submit_sqes
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6d816e088c359866f9867057e04f244c608c42fe
fix_commit: a36da65c46565d2527eec3efdb546251e38253fd
datetime: '2020-08-12T08:29:40-06:00'
fix_commit_message: 'io_uring: fail poll arm on queue proc failure


  Check the ipt.error value, it must have been either cleared to zero or

  set to another error than the default -EINVAL if we don''t go through the

  waitqueue proc addition. Just give up on poll at that point and return

  failure, this will fallback to async work.


  io_poll_add() doesn''t suffer from this failure case, as it returns the

  error value directly.


  Cc: stable@vger.kernel.org # v5.7+

  Reported-by: syzbot+a730016dc0bdce4f6ff5@syzkaller.appspotmail.com

  Reviewed-by: Stefano Garzarella <sgarzare@redhat.com>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 1
covered_count: 0
