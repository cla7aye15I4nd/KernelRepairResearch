id: e27f3dbdab04e43b9f73
bug_link: https://syzkaller.appspot.com/bug?extid=e27f3dbdab04e43b9f73
title: 'UBSAN: shift-out-of-bounds in set_flicker'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6e481d52d363218a3e6feb31694da74b38b30fad
fix_commit: 099be1822d1f095433f4b08af9cc9d6308ec1953
datetime: '2023-09-27T09:39:55+02:00'
fix_commit_message: 'media: gspca: cpia1: shift-out-of-bounds in set_flicker


  Syzkaller reported the following issue:

  UBSAN: shift-out-of-bounds in drivers/media/usb/gspca/cpia1.c:1031:27

  shift exponent 245 is too large for 32-bit type ''int''


  When the value of the variable "sd->params.exposure.gain" exceeds the

  number of bits in an integer, a shift-out-of-bounds error is reported. It

  is triggered because the variable "currentexp" cannot be left-shifted by

  more than the number of bits in an integer. In order to avoid invalid

  range during left-shift, the conditional expression is added.


  Reported-by: syzbot+e27f3dbdab04e43b9f73@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/all/20230818164522.12806-1-coolrrsh@gmail.com

  Link: https://syzkaller.appspot.com/bug?extid=e27f3dbdab04e43b9f73

  Signed-off-by: Rajeshwar R Shinde <coolrrsh@gmail.com>

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  '
submodule:
- drivers/media/usb/gspca
hunk_count: 2
covered_count: 2
