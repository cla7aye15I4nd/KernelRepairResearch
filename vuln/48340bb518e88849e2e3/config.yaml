id: 48340bb518e88849e2e3
bug_link: https://syzkaller.appspot.com/bug?extid=48340bb518e88849e2e3
title: divide error in ___bpf_prog_run
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c366287ebd698ef5e3de300d90cd62ee9ee7373e
fix_commit: 68fda450a7df51cff9e5a4d4a4d9d0d5f2589153
datetime: '2018-01-14T23:05:33+01:00'
fix_commit_message: 'bpf: fix 32-bit divide by zero


  due to some JITs doing if (src_reg == 0) check in 64-bit mode

  for div/mod operations mask upper 32-bits of src register

  before doing the check


  Fixes: 622582786c9e ("net: filter: x86: internal BPF JIT")

  Fixes: 7a12b5031c6b ("sparc64: Add eBPF JIT.")

  Reported-by: syzbot+48340bb518e88849e2e3@syzkaller.appspotmail.com

  Signed-off-by: Alexei Starovoitov <ast@kernel.org>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  '
submodule:
- kernel/bpf
- net/core
hunk_count: 2
covered_count: 0
