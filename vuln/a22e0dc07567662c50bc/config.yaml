id: a22e0dc07567662c50bc
bug_link: https://syzkaller.appspot.com/bug?extid=a22e0dc07567662c50bc
title: general protection fault in keyctl_pkey_params_get
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e1ef035d272ef4dbfdda98e58699698305138856
fix_commit: 57b0e31453209d746c99e513d80b3d0c44a80891
datetime: '2019-01-01T13:13:19-08:00'
fix_commit_message: "KEYS: fix parsing invalid pkey info string\n\nWe need to check\
  \ the return value of match_token() for Opt_err before\ndoing anything with it.\n\
  \n[ Not only did the old \"-1\" value for Opt_err cause problems for the\n  __test_and_set_bit(),\
  \ as fixed in commit 94c13f66e13c (\"security:\n  don't use a negative Opt_err token\
  \ index\"), but accessing\n  \"args[0].from\" is invalid for the Opt_err case, as\
  \ pointed out by Eric\n  later.  - Linus ]\n\nReported-by: syzbot+a22e0dc07567662c50bc@syzkaller.appspotmail.com\n\
  Fixes: 00d60fd3b932 (\"KEYS: Provide keyctls to drive the new key type ops for asymmetric\
  \ keys [ver #2]\")\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nCc: stable@kernel.org\
  \ # 4.20\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n"
submodule:
- security/keys
hunk_count: 1
covered_count: 1
