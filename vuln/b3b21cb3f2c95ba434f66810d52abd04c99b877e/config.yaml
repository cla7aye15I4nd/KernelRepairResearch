id: b3b21cb3f2c95ba434f66810d52abd04c99b877e
bug_link: https://syzkaller.appspot.com/bug?extid=b3b21cb3f2c95ba434f66810d52abd04c99b877e
title: general protection fault in __list_del_entry_valid
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 10a7ef33679073d13bf1dd05e3f1b7912f999543
fix_commit: 1137b5e2529a8f5ca8ee709288ecba3e68044df2
datetime: '2017-10-23T09:35:48+02:00'
fix_commit_message: 'ipsec: Fix aborted xfrm policy dump crash


  An independent security researcher, Mohamed Ghannam, has reported

  this vulnerability to Beyond Security''s SecuriTeam Secure Disclosure

  program.


  The xfrm_dump_policy_done function expects xfrm_dump_policy to

  have been called at least once or it will crash.  This can be

  triggered if a dump fails because the target socket''s receive

  buffer is full.


  This patch fixes it by using the cb->start mechanism to ensure that

  the initialisation is always done regardless of the buffer situation.


  Fixes: 12a169e7d8f4 ("ipsec: Put dumpers on the dump list")

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 4
covered_count: 1
