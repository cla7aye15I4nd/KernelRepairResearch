id: 72ff2fa98097767b5a27
bug_link: https://syzkaller.appspot.com/bug?extid=72ff2fa98097767b5a27
title: 'KASAN: use-after-free Read in __xfrm6_tunnel_spi_lookup'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a8757147905ea5adee78c7a813fc080a4124f248
fix_commit: 8b404f46dd6ab845d0fa794679329d4089281ccb
datetime: '2020-07-14T11:46:32+02:00'
fix_commit_message: 'xfrm: interface: not xfrmi_ipv6/ipip_handler twice


  As we did in the last 2 patches for vti(6), this patch is to define a

  new xfrm_tunnel object ''xfrmi_ipip6_handler'' to register for AF_INET6,

  and a new xfrm6_tunnel object ''xfrmi_ip6ip_handler'' to register for

  AF_INET.


  Signed-off-by: Xin Long <lucien.xin@gmail.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 6
covered_count: 2
