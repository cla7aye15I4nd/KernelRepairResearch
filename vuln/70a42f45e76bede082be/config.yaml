id: 70a42f45e76bede082be
bug_link: https://syzkaller.appspot.com/bug?extid=70a42f45e76bede082be
title: 'KMSAN: uninit-value in sctp_inq_pop (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: aba0c94f61ec05315fa7815d21aefa4c87f6a9f4
fix_commit: fd60d8a086191fe33c2d719732d2482052fa6805
datetime: '2025-08-08T13:08:06-07:00'
fix_commit_message: "sctp: linearize cloned gso packets in sctp_rcv\n\nA cloned head\
  \ skb still shares these frag skbs in fraglist with the\noriginal head skb. It's\
  \ not safe to access these frag skbs.\n\nsyzbot reported two use-of-uninitialized-memory\
  \ bugs caused by this:\n\n  BUG: KMSAN: uninit-value in sctp_inq_pop+0x15b7/0x1920\
  \ net/sctp/inqueue.c:211\n   sctp_inq_pop+0x15b7/0x1920 net/sctp/inqueue.c:211\n\
  \   sctp_assoc_bh_rcv+0x1a7/0xc50 net/sctp/associola.c:998\n   sctp_inq_push+0x2ef/0x380\
  \ net/sctp/inqueue.c:88\n   sctp_backlog_rcv+0x397/0xdb0 net/sctp/input.c:331\n\
  \   sk_backlog_rcv+0x13b/0x420 include/net/sock.h:1122\n   __release_sock+0x1da/0x330\
  \ net/core/sock.c:3106\n   release_sock+0x6b/0x250 net/core/sock.c:3660\n   sctp_wait_for_connect+0x487/0x820\
  \ net/sctp/socket.c:9360\n   sctp_sendmsg_to_asoc+0x1ec1/0x1f00 net/sctp/socket.c:1885\n\
  \   sctp_sendmsg+0x32b9/0x4a80 net/sctp/socket.c:2031\n   inet_sendmsg+0x25a/0x280\
  \ net/ipv4/af_inet.c:851\n   sock_sendmsg_nosec net/socket.c:718 [inline]\n\nand\n\
  \n  BUG: KMSAN: uninit-value in sctp_assoc_bh_rcv+0x34e/0xbc0 net/sctp/associola.c:987\n\
  \   sctp_assoc_bh_rcv+0x34e/0xbc0 net/sctp/associola.c:987\n   sctp_inq_push+0x2a3/0x350\
  \ net/sctp/inqueue.c:88\n   sctp_backlog_rcv+0x3c7/0xda0 net/sctp/input.c:331\n\
  \   sk_backlog_rcv+0x142/0x420 include/net/sock.h:1148\n   __release_sock+0x1d3/0x330\
  \ net/core/sock.c:3213\n   release_sock+0x6b/0x270 net/core/sock.c:3767\n   sctp_wait_for_connect+0x458/0x820\
  \ net/sctp/socket.c:9367\n   sctp_sendmsg_to_asoc+0x223a/0x2260 net/sctp/socket.c:1886\n\
  \   sctp_sendmsg+0x3910/0x49f0 net/sctp/socket.c:2032\n   inet_sendmsg+0x269/0x2a0\
  \ net/ipv4/af_inet.c:851\n   sock_sendmsg_nosec net/socket.c:712 [inline]\n\nThis\
  \ patch fixes it by linearizing cloned gso packets in sctp_rcv().\n\nFixes: 90017accff61\
  \ (\"sctp: Add GSO support\")\nReported-by: syzbot+773e51afe420baaf0e2b@syzkaller.appspotmail.com\n\
  Reported-by: syzbot+70a42f45e76bede082be@syzkaller.appspotmail.com\nSigned-off-by:\
  \ Xin Long <lucien.xin@gmail.com>\nReviewed-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>\n\
  Link: https://patch.msgid.link/dd7dc337b99876d4132d0961f776913719f7d225.1754595611.git.lucien.xin@gmail.com\n\
  Signed-off-by: Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- net/sctp
hunk_count: 1
covered_count: 0
