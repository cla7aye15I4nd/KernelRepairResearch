id: 87678bcf753b44c39b67
bug_link: https://syzkaller.appspot.com/bug?extid=87678bcf753b44c39b67
title: general protection fault in tun_queue_purge
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 84328342a70a44379dd73011a44c5f5e00481a42
fix_commit: 9fb582b67072bea6cbfe1aefc2be13c62c7681bf
datetime: '2018-01-29T12:02:54-05:00'
fix_commit_message: 'Revert "net: ptr_ring: otherwise safe empty checks can overrun
  array bounds"


  This reverts commit bcecb4bbf88aa03171c30652bca761cf27755a6b.


  If we try to allocate an extra entry as the above commit did, and when

  the requested size is UINT_MAX, addition overflows causing zero size to

  be passed to kmalloc().


  kmalloc then returns ZERO_SIZE_PTR with a subsequent crash.


  Reported-by: syzbot+87678bcf753b44c39b67@syzkaller.appspotmail.com

  Cc: John Fastabend <john.fastabend@gmail.com>

  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

  Acked-by: John Fastabend <john.fastabend@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- include/linux
hunk_count: 1
covered_count: 0
