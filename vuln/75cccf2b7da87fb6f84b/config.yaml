id: 75cccf2b7da87fb6f84b
bug_link: https://syzkaller.appspot.com/bug?extid=75cccf2b7da87fb6f84b
title: WARNING in aiptek_open/usb_submit_urb
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e941dc13fd3717122207d74539ab95da07ef797f
fix_commit: 5600f6986628dde8881734090588474f54a540a8
datetime: '2022-03-14T18:15:11-07:00'
fix_commit_message: "Input: aiptek - properly check endpoint type\n\nSyzbot reported\
  \ warning in usb_submit_urb() which is caused by wrong\nendpoint type. There was\
  \ a check for the number of endpoints, but not\nfor the type of endpoint.\n\nFix\
  \ it by replacing old desc.bNumEndpoints check with\nusb_find_common_endpoints()\
  \ helper for finding endpoints\n\nFail log:\n\nusb 5-1: BOGUS urb xfer, pipe 1 !=\
  \ type 3\nWARNING: CPU: 2 PID: 48 at drivers/usb/core/urb.c:502 usb_submit_urb+0xed2/0x18a0\
  \ drivers/usb/core/urb.c:502\nModules linked in:\nCPU: 2 PID: 48 Comm: kworker/2:2\
  \ Not tainted 5.17.0-rc6-syzkaller-00226-g07ebd38a0da2 #0\nHardware name: QEMU Standard\
  \ PC (Q35 + ICH9, 2009), BIOS 1.14.0-2 04/01/2014\nWorkqueue: usb_hub_wq hub_event\n\
  ...\nCall Trace:\n <TASK>\n aiptek_open+0xd5/0x130 drivers/input/tablet/aiptek.c:830\n\
  \ input_open_device+0x1bb/0x320 drivers/input/input.c:629\n kbd_connect+0xfe/0x160\
  \ drivers/tty/vt/keyboard.c:1593\n\nFixes: 8e20cf2bce12 (\"Input: aiptek - fix crash\
  \ on detecting device without endpoints\")\nReported-and-tested-by: syzbot+75cccf2b7da87fb6f84b@syzkaller.appspotmail.com\n\
  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>\nLink: https://lore.kernel.org/r/20220308194328.26220-1-paskripkin@gmail.com\n\
  Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>\n"
submodule:
- drivers/input/tablet
hunk_count: 1
covered_count: 0
