id: d6b6d5e0ac5609c835098f88c893a7bb3cfa0900
bug_link: https://syzkaller.appspot.com/bug?extid=d6b6d5e0ac5609c835098f88c893a7bb3cfa0900
title: 'BUG: unable to handle kernel paging request in vsock_diag_dump'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3c91b0c1de8d013490bbc41ce9ee8810ea5baddd
fix_commit: c1eef220c1760762753b602c382127bfccee226d
datetime: '2017-10-26T17:45:58+09:00'
fix_commit_message: 'vsock: always call vsock_init_tables()


  Although CONFIG_VSOCKETS_DIAG depends on CONFIG_VSOCKETS,

  vsock_init_tables() is not always called, it is called only

  if other modules call its caller. Therefore if we only

  enable CONFIG_VSOCKETS_DIAG, it would crash kernel on uninitialized

  vsock_bind_table.


  This patch fixes it by moving vsock_init_tables() to its own

  module_init().


  Fixes: 413a4317aca7 ("VSOCK: add sock_diag interface")

  Reported-by: syzkaller bot

  Cc: Stefan Hajnoczi <stefanha@redhat.com>

  Cc: Jorgen Hansen <jhansen@vmware.com>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/vmw_vsock
hunk_count: 4
covered_count: 0
