id: ccac90e482b2a81d74aa
bug_link: https://syzkaller.appspot.com/bug?extid=ccac90e482b2a81d74aa
title: WARNING in convert_ctx_accesses
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 93acc0f43f58743737888985133809634e298753
fix_commit: ead3d7b2b6afa5ee7958620c4329982a7d9c2b78
datetime: '2025-08-01T09:22:44-07:00'
fix_commit_message: 'bpf: Check flow_dissector ctx accesses are aligned


  flow_dissector_is_valid_access doesn''t check that the context access is

  aligned. As a consequence, an unaligned access within one of the exposed

  field is considered valid and later rejected by

  flow_dissector_convert_ctx_access when we try to convert it.


  The later rejection is problematic because it''s reported as a verifier

  bug with a kernel warning and doesn''t point to the right instruction in

  verifier logs.


  Fixes: d58e468b1112 ("flow_dissector: implements flow dissector BPF hook")

  Reported-by: syzbot+ccac90e482b2a81d74aa@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=ccac90e482b2a81d74aa

  Signed-off-by: Paul Chaignon <paul.chaignon@gmail.com>

  Acked-by: Yonghong Song <yonghong.song@linux.dev>

  Acked-by: Eduard Zingerman <eddyz87@gmail.com>

  Link: https://lore.kernel.org/r/cc1b036be484c99be45eddf48bd78cc6f72839b1.1754039605.git.paul.chaignon@gmail.com

  Signed-off-by: Alexei Starovoitov <ast@kernel.org>


  '
submodule:
- net/core
hunk_count: 1
covered_count: 0
