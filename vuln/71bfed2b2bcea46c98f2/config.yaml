id: 71bfed2b2bcea46c98f2
bug_link: https://syzkaller.appspot.com/bug?extid=71bfed2b2bcea46c98f2
title: 'KMSAN: uninit-value in nci_ntf_packet (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: e9022b31db80019025967b03df1d059433e9f26d
fix_commit: 068648aab72c9ba7b0597354ef4d81ffaac7b979
datetime: '2024-05-29T13:08:31+01:00'
fix_commit_message: 'nfc/nci: Add the inconsistency check between the input data length
  and count


  write$nci(r0, &(0x7f0000000740)=ANY=[@ANYBLOB="610501"], 0xf)


  Syzbot constructed a write() call with a data length of 3 bytes but a count value

  of 15, which passed too little data to meet the basic requirements of the function

  nci_rf_intf_activated_ntf_packet().


  Therefore, increasing the comparison between data length and count value to avoid

  problems caused by inconsistent data length and count.


  Reported-and-tested-by: syzbot+71bfed2b2bcea46c98f2@syzkaller.appspotmail.com

  Signed-off-by: Edward Adam Davis <eadavis@qq.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/nfc
hunk_count: 1
covered_count: 1
