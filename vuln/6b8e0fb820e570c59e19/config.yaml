id: 6b8e0fb820e570c59e19
bug_link: https://syzkaller.appspot.com/bug?extid=6b8e0fb820e570c59e19
title: memory leak in process_preds
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 0c97bf863efce63d6ab7971dad811601e6171d2f
fix_commit: dfb4a6f2191a80c8b790117d0ff592fd712d3296
datetime: '2019-05-28T16:27:58-04:00'
fix_commit_message: 'tracing: Avoid memory leak in predicate_parse()


  In case of errors, predicate_parse() goes to the out_free label

  to free memory and to return an error code.


  However, predicate_parse() does not free the predicates of the

  temporary prog_stack array, thence leaking them.


  Link: http://lkml.kernel.org/r/20190528154338.29976-1-tomasbortoli@gmail.com


  Cc: stable@vger.kernel.org

  Fixes: 80765597bc587 ("tracing: Rewrite filter logic to be simpler and faster")

  Reported-by: syzbot+6b8e0fb820e570c59e19@syzkaller.appspotmail.com

  Signed-off-by: Tomas Bortoli <tomasbortoli@gmail.com>

  [ Added protection around freeing prog_stack[i].pred ]

  Signed-off-by: Steven Rostedt (VMware) <rostedt@goodmis.org>

  '
submodule:
- kernel/trace
hunk_count: 2
covered_count: 1
