id: 441582c1592938fccf09
bug_link: https://syzkaller.appspot.com/bug?extid=441582c1592938fccf09
title: possible deadlock in print_event_fields
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1be8e54a1e0f0a4bf70e3d65f94ca1738ee4f1f3
fix_commit: 0a8f11f8569e7ed16cbcedeb28c4350f6378fea6
datetime: '2025-05-01T22:44:52-04:00'
fix_commit_message: 'tracing: Do not take trace_event_sem in print_event_fields()


  On some paths in print_event_fields() it takes the trace_event_sem for

  read, even though it should always be held when the function is called.


  Remove the taking of that mutex and add a lockdep_assert_held_read() to

  make sure the trace_event_sem is held when print_event_fields() is called.


  Cc: stable@vger.kernel.org

  Cc: Masami Hiramatsu <mhiramat@kernel.org>

  Cc: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>

  Link: https://lore.kernel.org/20250501224128.0b1f0571@batman.local.home

  Fixes: 80a76994b2d88 ("tracing: Add "fields" option to show raw trace event fields")

  Reported-by: syzbot+441582c1592938fccf09@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/all/6813ff5e.050a0220.14dd7d.001b.GAE@google.com/

  Signed-off-by: Steven Rostedt (Google) <rostedt@goodmis.org>

  '
submodule:
- kernel/trace
hunk_count: 2
covered_count: 2
