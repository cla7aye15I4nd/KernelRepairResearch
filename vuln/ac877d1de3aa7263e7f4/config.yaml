id: ac877d1de3aa7263e7f4
bug_link: https://syzkaller.appspot.com/bug?extid=ac877d1de3aa7263e7f4
title: 'UBSAN: shift-out-of-bounds in fbcon_set_font'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ee9fffdc3887a46eab3209bc46b228b543c75fa6
fix_commit: 2b09d5d364986f724f17001ccfe4126b9b43a0be
datetime: '2023-02-04T14:29:19+01:00'
fix_commit_message: 'fbcon: Check font dimension limits


  blit_x and blit_y are u32, so fbcon currently cannot support fonts

  larger than 32x32.


  The 32x32 case also needs shifting an unsigned int, to properly set bit

  31, otherwise we get "UBSAN: shift-out-of-bounds in fbcon_set_font",

  as reported on:


  http://lore.kernel.org/all/IA1PR07MB98308653E259A6F2CE94A4AFABCE9@IA1PR07MB9830.namprd07.prod.outlook.com

  Kernel Branch: 6.2.0-rc5-next-20230124

  Kernel config: https://drive.google.com/file/d/1F-LszDAizEEH0ZX0HcSR06v5q8FPl2Uv/view?usp=sharing

  Reproducer: https://drive.google.com/file/d/1mP1jcLBY7vWCNM60OMf-ogw-urQRjNrm/view?usp=sharing


  Reported-by: Sanan Hasanov <sanan.hasanov@Knights.ucf.edu>

  Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org>

  Fixes: 2d2699d98492 ("fbcon: font setting should check limitation of driver")

  Cc: stable@vger.kernel.org

  Tested-by: Miko Larsson <mikoxyzzz@gmail.com>

  Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  Signed-off-by: Helge Deller <deller@gmx.de>

  '
submodule:
- drivers/video/fbdev/core
hunk_count: 1
covered_count: 1
