id: cf35b76f35e068a1107f
bug_link: https://syzkaller.appspot.com/bug?extid=cf35b76f35e068a1107f
title: WARNING in gpio_to_desc
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 5e5412c365a32e452daa762eac36121cb8a370bb
fix_commit: c3953a3c2d3175d2f9f0304c9a1ba89e7743c5e4
datetime: '2019-08-05T10:25:48-07:00'
fix_commit_message: 'NFC: nfcmrvl: fix gpio-handling regression


  Fix two reset-gpio sanity checks which were never converted to use

  gpio_is_valid(), and make sure to use -EINVAL to indicate a missing

  reset line also for the UART-driver module parameter and for the USB

  driver.


  This specifically prevents the UART and USB drivers from incidentally

  trying to request and use gpio 0, and also avoids triggering a WARN() in

  gpio_to_desc() during probe when no valid reset line has been specified.


  Fixes: e33a3f84f88f ("NFC: nfcmrvl: allow gpio 0 for reset signalling")

  Reported-by: syzbot+cf35b76f35e068a1107f@syzkaller.appspotmail.com

  Tested-by: syzbot+cf35b76f35e068a1107f@syzkaller.appspotmail.com

  Signed-off-by: Johan Hovold <johan@kernel.org>

  '
submodule:
- drivers/nfc/nfcmrvl
hunk_count: 5
covered_count: 3
