id: 609e63261638ff3d5436
bug_link: https://syzkaller.appspot.com/bug?extid=609e63261638ff3d5436
title: 'KASAN: slab-out-of-bounds Read in mt_validate_nulls'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f66066bc5136f25e36a2daff4896c768f18c211e
fix_commit: ae80b404198434e49e903dc3b1ba83e2c7bb3ee2
datetime: '2023-07-03T10:08:50-07:00'
fix_commit_message: 'mm: validate the mm before dropping the mmap lock


  Commit 408579cd627a ("mm: Update do_vmi_align_munmap() return

  semantics") made the return value and locking semantics of

  do_vmi_align_munmap() more straightforward, but in the process it ended

  up unlocking the mmap lock just a tad too early: the debug code doing

  the mmap layout validation still needs to run with the lock held, or

  things might change under it while it''s trying to validate things.


  So just move the unlocking to after the validate_mm() call.


  Reported-by: kernel test robot <oliver.sang@intel.com>

  Link: https://lore.kernel.org/lkml/ZKIsoMOT71uwCIZX@xsang-OptiPlex-9020/

  Fixes: 408579cd627a ("mm: Update do_vmi_align_munmap() return semantics")

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 1
covered_count: 1
