id: 19557374321ca3710990
bug_link: https://syzkaller.appspot.com/bug?extid=19557374321ca3710990
title: general protection fault in smc_ioctl (3)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: bd58c7e0860f54710907903ed6daff699d1fc5b9
fix_commit: 7311d665ca68907b9c43d6d1021f816f9a7bbd57
datetime: '2018-08-08T19:14:22-07:00'
fix_commit_message: 'net/smc: move sock lock in smc_ioctl()


  When an SMC socket is connecting it is decided whether fallback to

  TCP is needed. To avoid races between connect and ioctl move the

  sock lock before the use_fallback check.


  Reported-by: syzbot+5b2cece1a8ecb2ca77d8@syzkaller.appspotmail.com

  Reported-by: syzbot+19557374321ca3710990@syzkaller.appspotmail.com

  Fixes: 1992d99882af ("net/smc: take sock lock in smc_ioctl()")

  Signed-off-by: Ursula Braun <ubraun@linux.ibm.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/smc
hunk_count: 1
covered_count: 1
