id: c6167ec3de7def23d1e8
bug_link: https://syzkaller.appspot.com/bug?extid=c6167ec3de7def23d1e8
title: memory leak in hsr_create_self_node
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 619afef01f74f3572b5e9a266c1230dc83761eec
fix_commit: b9a1e627405d68d475a3c1f35e685ccfb5bbe668
datetime: '2019-07-05T15:22:27-07:00'
fix_commit_message: 'hsr: implement dellink to clean up resources


  hsr_link_ops implements ->newlink() but not ->dellink(),

  which leads that resources not released after removing the device,

  particularly the entries in self_node_db and node_db.


  So add ->dellink() implementation to replace the priv_destructor.

  This also makes the code slightly easier to understand.


  Reported-by: syzbot+c6167ec3de7def23d1e8@syzkaller.appspotmail.com

  Cc: Arvid Brodin <arvid.brodin@alten.se>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/hsr
hunk_count: 10
covered_count: 6
