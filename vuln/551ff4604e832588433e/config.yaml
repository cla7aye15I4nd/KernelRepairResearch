id: 551ff4604e832588433e
bug_link: https://syzkaller.appspot.com/bug?extid=551ff4604e832588433e
title: 'KASAN: use-after-free Write in xt_rateest_put'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 992cfc7c5d105094da7c21c9c74d97ac26bb1e56
fix_commit: 7dc68e98757a8eccf8ca7a53a29b896f1eef1f76
datetime: '2018-02-07T00:58:57+01:00'
fix_commit_message: 'netfilter: xt_RATEEST: acquire xt_rateest_mutex for hash insert


  rateest_hash is supposed to be protected by xt_rateest_mutex,

  and, as suggested by Eric, lookup and insert should be atomic,

  so we should acquire the xt_rateest_mutex once for both.


  So introduce a non-locking helper for internal use and keep the

  locking one for external.


  Reported-by: <syzbot+5cb189720978275e4c75@syzkaller.appspotmail.com>

  Fixes: 5859034d7eb8 ("[NETFILTER]: x_tables: add RATEEST target")

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Reviewed-by: Florian Westphal <fw@strlen.de>

  Reviewed-by: Eric Dumazet <edumazet@google.com>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/netfilter
hunk_count: 3
covered_count: 3
