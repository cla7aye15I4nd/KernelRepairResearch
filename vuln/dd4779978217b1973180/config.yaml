id: dd4779978217b1973180
bug_link: https://syzkaller.appspot.com/bug?extid=dd4779978217b1973180
title: WARNING in ieee80211_bss_info_change_notify (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b7198383ef2debe748118996f627452281cf27d7
fix_commit: f78c1375339a291cba492a70eaf12ec501d28a8e
datetime: '2024-02-15T11:00:37+01:00'
fix_commit_message: 'wifi: nl80211: reject iftype change with mesh ID change


  It''s currently possible to change the mesh ID when the

  interface isn''t yet in mesh mode, at the same time as

  changing it into mesh mode. This leads to an overwrite

  of data in the wdev->u union for the interface type it

  currently has, causing cfg80211_change_iface() to do

  wrong things when switching.


  We could probably allow setting an interface to mesh

  while setting the mesh ID at the same time by doing a

  different order of operations here, but realistically

  there''s no userspace that''s going to do this, so just

  disallow changes in iftype when setting mesh ID.


  Cc: stable@vger.kernel.org

  Fixes: 29cbe68c516a ("cfg80211/mac80211: add mesh join/leave commands")

  Reported-by: syzbot+dd4779978217b1973180@syzkaller.appspotmail.com

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- net/wireless
hunk_count: 1
covered_count: 1
