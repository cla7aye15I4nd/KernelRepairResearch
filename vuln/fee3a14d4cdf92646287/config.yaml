id: fee3a14d4cdf92646287
bug_link: https://syzkaller.appspot.com/bug?extid=fee3a14d4cdf92646287
title: memory leak in policydb_read
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: acbc372e6109c803cbee4733769d02008381740f
fix_commit: 45385237f65aeee73641f1ef737d7273905a233f
datetime: '2019-07-31T16:51:23-04:00'
fix_commit_message: 'selinux: fix memory leak in policydb_init()


  Since roles_init() adds some entries to the role hash table, we need to

  destroy also its keys/values on error, otherwise we get a memory leak in

  the error path.


  Cc: <stable@vger.kernel.org>

  Reported-by: syzbot+fee3a14d4cdf92646287@syzkaller.appspotmail.com

  Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")

  Signed-off-by: Ondrej Mosnacek <omosnace@redhat.com>

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  '
submodule:
- security/selinux/ss
hunk_count: 2
covered_count: 2
