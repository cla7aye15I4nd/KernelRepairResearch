id: 2074b1a3d447915c6f1c
bug_link: https://syzkaller.appspot.com/bug?extid=2074b1a3d447915c6f1c
title: general protection fault in __io_remove_buffers
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 24dce1c538a7ceac43f2f97aae8dfd4bb93ea9b9
fix_commit: bcc87d978b834c298bbdd9c52454c5d0a946e97e
datetime: '2024-07-20T11:04:57-06:00'
fix_commit_message: "io_uring: fix error pbuf checking\n\nSyz reports a problem, which\
  \ boils down to NULL vs IS_ERR inconsistent\nerror handling in io_alloc_pbuf_ring().\n\
  \nKASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]\nRIP: 0010:__io_remove_buffers+0xac/0x700\
  \ io_uring/kbuf.c:341\nCall Trace:\n <TASK>\n io_put_bl io_uring/kbuf.c:378 [inline]\n\
  \ io_destroy_buffers+0x14e/0x490 io_uring/kbuf.c:392\n io_ring_ctx_free+0xa00/0x1070\
  \ io_uring/io_uring.c:2613\n io_ring_exit_work+0x80f/0x8a0 io_uring/io_uring.c:2844\n\
  \ process_one_work kernel/workqueue.c:3231 [inline]\n process_scheduled_works+0xa2c/0x1830\
  \ kernel/workqueue.c:3312\n worker_thread+0x86d/0xd40 kernel/workqueue.c:3390\n\
  \ kthread+0x2f0/0x390 kernel/kthread.c:389\n ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147\n\
  \ ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244\n\nCc: stable@vger.kernel.org\n\
  Reported-by: syzbot+2074b1a3d447915c6f1c@syzkaller.appspotmail.com\nFixes: 87585b05757dc\
  \ (\"io_uring/kbuf: use vm_insert_pages() for mmap'ed pbuf ring\")\nSigned-off-by:\
  \ Pavel Begunkov <asml.silence@gmail.com>\nLink: https://lore.kernel.org/r/c5f9df20560bd9830401e8e48abc029e7cfd9f5e.1721329239.git.asml.silence@gmail.com\n\
  Signed-off-by: Jens Axboe <axboe@kernel.dk>\n"
submodule:
- io_uring
hunk_count: 1
covered_count: 0
