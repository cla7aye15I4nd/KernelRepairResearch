id: 1e0ed05798af62917464
bug_link: https://syzkaller.appspot.com/bug?extid=1e0ed05798af62917464
title: 'KMSAN: uninit-value in shrinker_alloc'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 5b8fbf50a54b02e09eb64679defdebd4bc7dfe8a
fix_commit: 7fba9420b726561966e1671004df60a08b39beb3
datetime: '2024-01-05T09:58:32-08:00'
fix_commit_message: 'mm: shrinker: use kvzalloc_node() from expand_one_shrinker_info()


  syzbot is reporting uninit-value at shrinker_alloc(), for commit

  307bececcd12 ("mm: shrinker: add a secondary array for

  shrinker_info::{map, nr_deferred}") which assumed that the ->unit was

  allocated with __GFP_ZERO forgot to replace kvmalloc_node() in

  expand_one_shrinker_info() with kvzalloc_node().


  Link: https://lkml.kernel.org/r/9226cc0a-10e0-4489-80c5-58c3b5b4359c@I-love.SAKURA.ne.jp

  Reported-by: syzbot <syzbot+1e0ed05798af62917464@syzkaller.appspotmail.com>

  Closes: https://syzkaller.appspot.com/bug?extid=1e0ed05798af62917464

  Fixes: 307bececcd12 ("mm: shrinker: add a secondary array for shrinker_info::{map,
  nr_deferred}")

  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Acked-by: Qi Zheng <zhengqi.arch@bytedance.com>

  Cc: Muchun Song <songmuchun@bytedance.com>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 1
covered_count: 1
