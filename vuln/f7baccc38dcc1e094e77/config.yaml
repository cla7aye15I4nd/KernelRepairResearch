id: f7baccc38dcc1e094e77
bug_link: https://syzkaller.appspot.com/bug?extid=f7baccc38dcc1e094e77
title: memory leak in mpihelp_mul_karatsuba_case
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7829a0c1cb9c80debfb4fdb49b4d90019f2ea1ac
fix_commit: c8ea9fce2baf7b643384f36f29e4194fa40d33a6
datetime: '2019-07-03T22:11:55+08:00'
fix_commit_message: 'lib/mpi: Fix karactx leak in mpi_powm


  Sometimes mpi_powm will leak karactx because a memory allocation

  failure causes a bail-out that skips the freeing of karactx.  This

  patch moves the freeing of karactx to the end of the function like

  everything else so that it can''t be skipped.


  Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com

  Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")

  Cc: <stable@vger.kernel.org>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  Reviewed-by: Eric Biggers <ebiggers@kernel.org>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- lib/mpi
hunk_count: 4
covered_count: 2
