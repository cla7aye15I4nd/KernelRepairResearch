id: 2a73a6ea9507b7112141
bug_link: https://syzkaller.appspot.com/bug?extid=2a73a6ea9507b7112141
title: possible deadlock in acct_pin_kill
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 79a3aaa7b82e3106be97842dedfd8429248896e6
fix_commit: 9419a3191dcb27f24478d288abaab697228d28e6
datetime: '2019-04-04T21:04:13-04:00'
fix_commit_message: 'acct_on(): don''t mess with freeze protection


  What happens there is that we are replacing file->path.mnt of

  a file we''d just opened with a clone and we need the write

  count contribution to be transferred from original mount to

  new one.  That''s it.  We do *NOT* want any kind of freeze

  protection for the duration of switchover.


  IOW, we should just use __mnt_{want,drop}_write() for that

  switchover; no need to bother with mnt_{want,drop}_write()

  there.


  Tested-by: Amir Goldstein <amir73il@gmail.com>

  Reported-by: syzbot+2a73a6ea9507b7112141@syzkaller.appspotmail.com

  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

  '
submodule:
- fs
- include/linux
- kernel
hunk_count: 4
covered_count: 2
