id: 2b9b4f0895be09a6dec3
bug_link: https://syzkaller.appspot.com/bug?extid=2b9b4f0895be09a6dec3
title: WARNING in change_protection
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 28c5609fb236807910ca347ad3e26c4567998526
fix_commit: 515778e2d790652a38a24554fdb7f21420d91efc
datetime: '2022-10-12T15:56:46-07:00'
fix_commit_message: 'mm/uffd: fix warning without PTE_MARKER_UFFD_WP compiled in


  When PTE_MARKER_UFFD_WP not configured, it''s still possible to reach pte

  marker code and trigger an warning. Add a few CONFIG_PTE_MARKER_UFFD_WP

  ifdefs to make sure the code won''t be reached when not compiled in.


  Link: https://lkml.kernel.org/r/YzeR+R6b4bwBlBHh@x1n

  Fixes: b1f9e876862d ("mm/uffd: enable write protection for shmem & hugetlbfs")

  Signed-off-by: Peter Xu <peterx@redhat.com>

  Reported-by: <syzbot+2b9b4f0895be09a6dec3@syzkaller.appspotmail.com>

  Cc: Axel Rasmussen <axelrasmussen@google.com>

  Cc: Brian Geffon <bgeffon@google.com>

  Cc: Edward Liaw <edliaw@google.com>

  Cc: Liu Shixin <liushixin2@huawei.com>

  Cc: Mike Kravetz <mike.kravetz@oracle.com>

  Cc: <stable@vger.kernel.org>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- mm
hunk_count: 6
covered_count: 2
