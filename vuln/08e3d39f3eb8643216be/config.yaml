id: 08e3d39f3eb8643216be
bug_link: https://syzkaller.appspot.com/bug?extid=08e3d39f3eb8643216be
title: possible deadlock in dev_mc_unsync
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 7dea927f702df030c02bd0c9e6e320a8315e3efa
fix_commit: be74294ffa24f5fbc0d6643842e3e095447e17a2
datetime: '2020-06-28T21:37:23-07:00'
fix_commit_message: 'net: get rid of lockdep_set_class_and_subclass()


  lockdep_set_class_and_subclass() is meant to reduce

  the _nested() annotations by assigning a default subclass.

  For addr_list_lock, we have to compute the subclass at

  run-time as the netdevice topology changes after creation.


  So, we should just get rid of these

  lockdep_set_class_and_subclass() and stick with our _nested()

  annotations.


  Fixes: 845e0ebb4408 ("net: change addr_list_lock back to static key")

  Suggested-by: Taehee Yoo <ap420073@gmail.com>

  Cc: Dmitry Vyukov <dvyukov@google.com>

  Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- drivers/net
- net/8021q
hunk_count: 4
covered_count: 0
