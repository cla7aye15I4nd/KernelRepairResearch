id: c52293513298e0fd9a94
bug_link: https://syzkaller.appspot.com/bug?extid=c52293513298e0fd9a94
title: 'UBSAN: shift-out-of-bounds in das16m1_attach'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ab705c8c35e18652abc6239c07cf3441f03e2cda
fix_commit: ed93c6f68a3be06e4e0c331c6e751f462dee3932
datetime: '2025-07-16T15:02:26+02:00'
fix_commit_message: "comedi: das16m1: Fix bit shift out of bounds\n\nWhen checking\
  \ for a supported IRQ number, the following test is used:\n\n\t/* only irqs 2, 3,\
  \ 4, 5, 6, 7, 10, 11, 12, 14, and 15 are valid */\n\tif ((1 << it->options[1]) &\
  \ 0xdcfc) {\n\nHowever, `it->options[i]` is an unchecked `int` value from userspace,\
  \ so\nthe shift amount could be negative or out of bounds.  Fix the test by\nrequiring\
  \ `it->options[1]` to be within bounds before proceeding with\nthe original test.\n\
  \nReported-by: syzbot+c52293513298e0fd9a94@syzkaller.appspotmail.com\nCloses: https://syzkaller.appspot.com/bug?extid=c52293513298e0fd9a94\n\
  Fixes: 729988507680 (\"staging: comedi: das16m1: tidy up the irq support in das16m1_attach()\"\
  )\nTested-by: syzbot+c52293513298e0fd9a94@syzkaller.appspotmail.com\nSuggested-by:\
  \ \"Enju, Kohei\" <enjuk@amazon.co.jp>\nCc: stable@vger.kernel.org # 5.13+\nSigned-off-by:\
  \ Ian Abbott <abbotti@mev.co.uk>\nLink: https://lore.kernel.org/r/20250707130908.70758-1-abbotti@mev.co.uk\n\
  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\n"
submodule:
- drivers/comedi/drivers
hunk_count: 1
covered_count: 1
