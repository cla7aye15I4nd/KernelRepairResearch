id: cfc0247ac173f597aaaa
bug_link: https://syzkaller.appspot.com/bug?extid=cfc0247ac173f597aaaa
title: 'KASAN: slab-out-of-bounds Write in xt_compat_target_from_user'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: d163a925ebbc6eb5b562b0f1d72c7e817aa75c40
fix_commit: b29c457a6511435960115c0f548c4360d5f4801d
datetime: '2021-04-13T00:18:57+02:00'
fix_commit_message: 'netfilter: x_tables: fix compat match/target pad out-of-bound
  write


  xt_compat_match/target_from_user doesn''t check that zeroing the area

  to start of next rule won''t write past end of allocated ruleset blob.


  Remove this code and zero the entire blob beforehand.


  Reported-by: syzbot+cfc0247ac173f597aaaa@syzkaller.appspotmail.com

  Reported-by: Andy Nguyen <theflow@google.com>

  Fixes: 9fa492cdc160c ("[NETFILTER]: x_tables: simplify compat API")

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/ipv4
- net/ipv6
- net/netfilter
hunk_count: 7
covered_count: 3
