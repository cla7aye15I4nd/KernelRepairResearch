id: 29c402e56c4760763cc0
bug_link: https://syzkaller.appspot.com/bug?extid=29c402e56c4760763cc0
title: memory leak in sctp_sched_prio_set
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b85f628aa158a653c006e9c1405a117baef8c868
fix_commit: 9ed7bfc79542119ac0a9e1ce8a2a5285e43433e9
datetime: '2022-11-29T08:30:50-08:00'
fix_commit_message: "sctp: fix memory leak in sctp_stream_outq_migrate()\n\nWhen sctp_stream_outq_migrate()\
  \ is called to release stream out resources,\nthe memory pointed to by prio_head\
  \ in stream out is not released.\n\nThe memory leak information is as follows:\n\
  \ unreferenced object 0xffff88801fe79f80 (size 64):\n   comm \"sctp_repo\", pid\
  \ 7957, jiffies 4294951704 (age 36.480s)\n   hex dump (first 32 bytes):\n     80\
  \ 9f e7 1f 80 88 ff ff 80 9f e7 1f 80 88 ff ff  ................\n     90 9f e7\
  \ 1f 80 88 ff ff 90 9f e7 1f 80 88 ff ff  ................\n   backtrace:\n    \
  \ [<ffffffff81b215c6>] kmalloc_trace+0x26/0x60\n     [<ffffffff88ae517c>] sctp_sched_prio_set+0x4cc/0x770\n\
  \     [<ffffffff88ad64f2>] sctp_stream_init_ext+0xd2/0x1b0\n     [<ffffffff88aa2604>]\
  \ sctp_sendmsg_to_asoc+0x1614/0x1a30\n     [<ffffffff88ab7ff1>] sctp_sendmsg+0xda1/0x1ef0\n\
  \     [<ffffffff87f765ed>] inet_sendmsg+0x9d/0xe0\n     [<ffffffff8754b5b3>] sock_sendmsg+0xd3/0x120\n\
  \     [<ffffffff8755446a>] __sys_sendto+0x23a/0x340\n     [<ffffffff87554651>] __x64_sys_sendto+0xe1/0x1b0\n\
  \     [<ffffffff89978b49>] do_syscall_64+0x39/0xb0\n     [<ffffffff89a0008b>] entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\
  \nLink: https://syzkaller.appspot.com/bug?exrid=29c402e56c4760763cc0\nFixes: 637784ade221\
  \ (\"sctp: introduce priority based stream scheduler\")\nReported-by: syzbot+29c402e56c4760763cc0@syzkaller.appspotmail.com\n\
  Signed-off-by: Zhengchao Shao <shaozhengchao@huawei.com>\nReviewed-by: Xin Long\
  \ <lucien.xin@gmail.com>\nLink: https://lore.kernel.org/r/20221126031720.378562-1-shaozhengchao@huawei.com\n\
  Signed-off-by: Jakub Kicinski <kuba@kernel.org>\n"
submodule:
- include/net/sctp
- net/sctp
hunk_count: 10
covered_count: 3
