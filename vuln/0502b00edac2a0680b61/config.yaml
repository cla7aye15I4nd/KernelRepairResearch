id: 0502b00edac2a0680b61
bug_link: https://syzkaller.appspot.com/bug?extid=0502b00edac2a0680b61
title: WARNING in __proc_create
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 932909d9b28d27e807ff8eecb68c7748f6701628
fix_commit: b1d0a5d0cba4597c0394997b2d5fced3e3841b4e
datetime: '2018-03-11T21:24:29+01:00'
fix_commit_message: 'netfilter: x_tables: add and use xt_check_proc_name


  recent and hashlimit both create /proc files, but only check that

  name is 0 terminated.


  This can trigger WARN() from procfs when name is "" or "/".

  Add helper for this and then use it for both.


  Cc: Eric Dumazet <eric.dumazet@gmail.com>

  Reported-by: Eric Dumazet <eric.dumazet@gmail.com>

  Reported-by: <syzbot+0502b00edac2a0680b61@syzkaller.appspotmail.com>

  Signed-off-by: Florian Westphal <fw@strlen.de>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- include/linux/netfilter
- net/netfilter
hunk_count: 6
covered_count: 4
