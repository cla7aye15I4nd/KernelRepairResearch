id: 0a3683a0a6fecf909244
bug_link: https://syzkaller.appspot.com/bug?extid=0a3683a0a6fecf909244
title: WARNING in iomap_iter (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a4217c6740dc64a3eb6815868a9260825e8c68c6
fix_commit: 0c12028aec837f5a002009bbf68d179d506510e8
datetime: '2024-05-03T09:05:11-06:00'
fix_commit_message: 'block: refine the EOF check in blkdev_iomap_begin


  blkdev_iomap_begin rounds down the offset to the logical block size

  before stashing it in iomap->offset and checking that it still is

  inside the inode size.


  Check the i_size check to the raw pos value so that we don''t try a

  zero size write if iter->pos is unaligned.


  Fixes: 487c607df790 ("block: use iomap for writes to block devices")

  Reported-by: syzbot+0a3683a0a6fecf909244@syzkaller.appspotmail.com

  Signed-off-by: Christoph Hellwig <hch@lst.de>

  Tested-by: syzbot+0a3683a0a6fecf909244@syzkaller.appspotmail.com

  Link: https://lore.kernel.org/r/20240503081042.2078062-1-hch@lst.de

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- block
hunk_count: 1
covered_count: 0
