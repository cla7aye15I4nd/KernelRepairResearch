id: 1115e79c8df6472c612b
bug_link: https://syzkaller.appspot.com/bug?extid=1115e79c8df6472c612b
title: memory leak in video_usercopy
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f7c7d6ccc503c0a5f4e5debb570b55bf2eb24c73
fix_commit: fb18802a338b36f675a388fc03d2aa504a0d0899
datetime: '2021-01-12T17:06:16+01:00'
fix_commit_message: 'media: v4l: ioctl: Fix memory leak in video_usercopy


  When an IOCTL with argument size larger than 128 that also used array

  arguments were handled, two memory allocations were made but alas, only

  the latter one of them was released. This happened because there was only

  a single local variable to hold such a temporary allocation.


  Fix this by adding separate variables to hold the pointers to the

  temporary allocations.


  Reported-by: Arnd Bergmann <arnd@kernel.org>

  Reported-by: syzbot+1115e79c8df6472c612b@syzkaller.appspotmail.com

  Fixes: d14e6d76ebf7 ("[media] v4l: Add multi-planar ioctl handling code")

  Cc: stable@vger.kernel.org

  Signed-off-by: Sakari Ailus <sakari.ailus@linux.intel.com>

  Acked-by: Arnd Bergmann <arnd@arndb.de>

  Acked-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  Reviewed-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

  '
submodule:
- drivers/media/v4l2-core
hunk_count: 4
covered_count: 2
