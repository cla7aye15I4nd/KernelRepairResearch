id: 6d38d558c25b53b8f4ed
bug_link: https://syzkaller.appspot.com/bug?extid=6d38d558c25b53b8f4ed
title: 'KASAN: slab-out-of-bounds Write in crypto_dh_encode_key'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: afb31cd2d1a1bc3ca055fb2519ec4e9ab969ffe0
fix_commit: 35f7d5225ffcbf1b759f641aec1735e3a89b1914
datetime: '2018-08-03T18:06:06+08:00'
fix_commit_message: 'crypto: dh - fix calculating encoded key size


  It was forgotten to increase DH_KPP_SECRET_MIN_SIZE to include ''q_size'',

  causing an out-of-bounds write of 4 bytes in crypto_dh_encode_key(), and

  an out-of-bounds read of 4 bytes in crypto_dh_decode_key().  Fix it, and

  fix the lengths of the test vectors to match this.


  Reported-by: syzbot+6d38d558c25b53b8f4ed@syzkaller.appspotmail.com

  Fixes: e3fe0ae12962 ("crypto: dh - add public key verification test")

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

  '
submodule:
- crypto
hunk_count: 5
covered_count: 1
