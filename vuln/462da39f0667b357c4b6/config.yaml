id: 462da39f0667b357c4b6
bug_link: https://syzkaller.appspot.com/bug?extid=462da39f0667b357c4b6
title: WARNING in notify_change (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: eb7081409f94a9a8608593d0fb63a1aa3d6f95d8
fix_commit: 44361e8cf9ddb23f17bdcc40ca944abf32e83e79
datetime: '2022-11-23T09:10:42+01:00'
fix_commit_message: 'fuse: lock inode unconditionally in fuse_fallocate()


  file_modified() must be called with inode lock held.  fuse_fallocate()

  didn''t lock the inode in case of just FALLOC_KEEP_SIZE flags value, which

  resulted in a kernel Warning in notify_change().


  Lock the inode unconditionally, like all other fallocate implementations

  do.


  Reported-by: Pengfei Xu <pengfei.xu@intel.com>

  Reported-and-tested-by: syzbot+462da39f0667b357c4b6@syzkaller.appspotmail.com

  Fixes: 4a6f278d4827 ("fuse: add file_modified() to fallocate")

  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>

  '
submodule:
- fs/fuse
hunk_count: 3
covered_count: 3
