id: fb347cf82c73a90efcca
bug_link: https://syzkaller.appspot.com/bug?extid=fb347cf82c73a90efcca
title: memory leak in xfrm_user_rcv_msg
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a118ff661889ecee3ca90f8125bad8fb5bbc07d5
fix_commit: 7c1a80e80cde008f271bae630d28cf684351e807
datetime: '2021-06-29T12:16:08+02:00'
fix_commit_message: 'net: xfrm: fix memory leak in xfrm_user_rcv_msg


  Syzbot reported memory leak in xfrm_user_rcv_msg(). The

  problem was is non-freed skb''s frag_list.


  In skb_release_all() skb_release_data() will be called only

  in case of skb->head != NULL, but netlink_skb_destructor()

  sets head to NULL. So, allocated frag_list skb should be

  freed manualy, since consume_skb() won''t take care of it


  Fixes: 5106f4a8acff ("xfrm/compat: Add 32=>64-bit messages translator")

  Reported-and-tested-by: syzbot+fb347cf82c73a90efcca@syzkaller.appspotmail.com

  Signed-off-by: Pavel Skripkin <paskripkin@gmail.com>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/xfrm
hunk_count: 1
covered_count: 1
