id: 4f0529365f7f2208d9f0
bug_link: https://syzkaller.appspot.com/bug?extid=4f0529365f7f2208d9f0
title: memory leak in pfkey_xfrm_policy2msg_prep
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: b38ff4075a80b4da5cb2202d7965332ca0efb213
fix_commit: 7c80eb1c7e2b8420477fbc998971d62a648035d9
datetime: '2019-05-28T09:20:52+02:00'
fix_commit_message: 'af_key: fix leaks in key_pol_get_resp and dump_sp.


  In both functions, if pfkey_xfrm_policy2msg failed we leaked the newly

  allocated sk_buff.  Free it on error.


  Fixes: 55569ce256ce ("Fix conversion between IPSEC_MODE_xxx and XFRM_MODE_xxx.")

  Reported-by: syzbot+4f0529365f7f2208d9f0@syzkaller.appspotmail.com

  Signed-off-by: Jeremy Sowden <jeremy@azazel.net>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- net/key
hunk_count: 2
covered_count: 1
