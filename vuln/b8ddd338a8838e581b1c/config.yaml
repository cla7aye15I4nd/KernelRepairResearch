id: b8ddd338a8838e581b1c
bug_link: https://syzkaller.appspot.com/bug?extid=b8ddd338a8838e581b1c
title: 'upstream test error: WARNING: ODEBUG bug in mgmt_index_removed'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9dfe1727b21927c6dd8d703e3a9618b505eb6224
fix_commit: 3f2893d3c142986aa935821460cb3adb77044722
datetime: '2022-08-08T17:06:23-07:00'
fix_commit_message: "Bluetooth: don't try to cancel uninitialized works at mgmt_index_removed()\n\
  \nsyzbot is reporting attempt to cancel uninitialized work at\nmgmt_index_removed()\
  \ [1], for calling cancel_delayed_work_sync() without\nINIT_DELAYED_WORK() is not\
  \ permitted.\n\nINIT_DELAYED_WORK() is called from mgmt_init_hdev() via chan->hdev_init()\n\
  \ from hci_mgmt_cmd(), but cancel_delayed_work_sync() is unconditionally\ncalled\
  \ from mgmt_index_removed().\n\nCall cancel_delayed_work_sync() only if HCI_MGMT\
  \ flag was set, for\nmgmt_init_hdev() sets HCI_MGMT flag when calling INIT_DELAYED_WORK().\n\
  \nLink: https://syzkaller.appspot.com/bug?extid=b8ddd338a8838e581b1c [1]\nReported-by:\
  \ syzbot <syzbot+b8ddd338a8838e581b1c@syzkaller.appspotmail.com>\nSigned-off-by:\
  \ Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>\nFixes: 0ef08313cefdd60d (\"\
  Bluetooth: Convert delayed discov_off to hci_sync\")\nSigned-off-by: Luiz Augusto\
  \ von Dentz <luiz.von.dentz@intel.com>\n"
submodule:
- net/bluetooth
hunk_count: 1
covered_count: 1
