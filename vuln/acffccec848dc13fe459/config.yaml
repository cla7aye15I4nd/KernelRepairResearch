id: acffccec848dc13fe459
bug_link: https://syzkaller.appspot.com/bug?extid=acffccec848dc13fe459
title: 'KASAN: slab-out-of-bounds Read in _decode_session6'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 5f78aec0d7e9f239d64b2cd1c9e671345ff92f94
fix_commit: 9f7e43da6ae4862b48bac233838ba808c1167a0d
datetime: '2018-10-11T13:24:46+02:00'
fix_commit_message: "net/xfrm: fix out-of-bounds packet access\n\nBUG: KASAN: slab-out-of-bounds\
  \ in _decode_session6+0x1331/0x14e0\nnet/ipv6/xfrm6_policy.c:161\nRead of size 1\
  \ at addr ffff8801d882eec7 by task syz-executor1/6667\nCall Trace:\n  __dump_stack\
  \ lib/dump_stack.c:77 [inline]\n  dump_stack+0x1c9/0x2b4 lib/dump_stack.c:113\n\
  \  print_address_description+0x6c/0x20b mm/kasan/report.c:256\n  kasan_report_error\
  \ mm/kasan/report.c:354 [inline]\n  kasan_report.cold.7+0x242/0x30d mm/kasan/report.c:412\n\
  \  __asan_report_load1_noabort+0x14/0x20 mm/kasan/report.c:430\n  _decode_session6+0x1331/0x14e0\
  \ net/ipv6/xfrm6_policy.c:161\n  __xfrm_decode_session+0x71/0x140 net/xfrm/xfrm_policy.c:2299\n\
  \  xfrm_decode_session include/net/xfrm.h:1232 [inline]\n  vti6_tnl_xmit+0x3c3/0x1bc1\
  \ net/ipv6/ip6_vti.c:542\n  __netdev_start_xmit include/linux/netdevice.h:4313 [inline]\n\
  \  netdev_start_xmit include/linux/netdevice.h:4322 [inline]\n  xmit_one net/core/dev.c:3217\
  \ [inline]\n  dev_hard_start_xmit+0x272/0xc10 net/core/dev.c:3233\n  __dev_queue_xmit+0x2ab2/0x3870\
  \ net/core/dev.c:3803\n  dev_queue_xmit+0x17/0x20 net/core/dev.c:3836\n\nReported-by:\
  \ syzbot+acffccec848dc13fe459@syzkaller.appspotmail.com\nReported-by: Eric Dumazet\
  \ <edumazet@google.com>\nSigned-off-by: Alexei Starovoitov <ast@kernel.org>\nSigned-off-by:\
  \ Steffen Klassert <steffen.klassert@secunet.com>\n"
submodule:
- net/ipv6
hunk_count: 1
covered_count: 1
