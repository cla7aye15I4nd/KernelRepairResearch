id: d2c5e6980bfc84513464
bug_link: https://syzkaller.appspot.com/bug?extid=d2c5e6980bfc84513464
title: 'KASAN: use-after-free Write in null_skcipher_crypt'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a3d9001b4e287fc043e5539d03d71a32ab114bcb
fix_commit: ebe48d368e97d007bfeb76fcb065d6cfc4c96645
datetime: '2022-03-07T13:14:03+01:00'
fix_commit_message: 'esp: Fix possible buffer overflow in ESP transformation


  The maximum message size that can be send is bigger than

  the  maximum site that skb_page_frag_refill can allocate.

  So it is possible to write beyond the allocated buffer.


  Fix this by doing a fallback to COW in that case.


  v2:


  Avoid get get_order() costs as suggested by Linus Torvalds.


  Fixes: cac2661c53f3 ("esp4: Avoid skb_cow_data whenever possible")

  Fixes: 03e2a30f6a27 ("esp6: Avoid skb_cow_data whenever possible")

  Reported-by: valis <sec@valis.email>

  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>

  '
submodule:
- include/net
- net/ipv4
- net/ipv6
hunk_count: 5
covered_count: 0
