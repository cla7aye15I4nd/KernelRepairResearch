id: eb8be6216b6b712efe5df541be1ad63a51f70008
bug_link: https://syzkaller.appspot.com/bug?extid=eb8be6216b6b712efe5df541be1ad63a51f70008
title: 'KASAN: double-free or invalid-free in relay_open'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 28f3a488ed83ac4a01406490941a6486806d1333
fix_commit: a1be1f3931bfe0a42b46fef77a04593c2b136e7f
datetime: '2018-02-06T18:32:46-08:00'
fix_commit_message: "kernel/relay.c: revert \"kernel/relay.c: fix potential memory\
  \ leak\"\n\nThis reverts commit ba62bafe942b (\"kernel/relay.c: fix potential memory\
  \ leak\").\n\nThis commit introduced a double free bug, because 'chan' is already\n\
  freed by the line:\n\n    kref_put(&chan->kref, relay_destroy_channel);\n\nThis\
  \ bug was found by syzkaller, using the BLKTRACESETUP ioctl.\n\nLink: http://lkml.kernel.org/r/20180127004759.101823-1-ebiggers3@gmail.com\n\
  Fixes: ba62bafe942b (\"kernel/relay.c: fix potential memory leak\")\nSigned-off-by:\
  \ Eric Biggers <ebiggers@google.com>\nReported-by: syzbot <syzkaller@googlegroups.com>\n\
  Reviewed-by: Andrew Morton <akpm@linux-foundation.org>\nCc: Zhouyi Zhou <yizhouzhou@ict.ac.cn>\n\
  Cc: Jens Axboe <axboe@kernel.dk>\nCc: <stable@vger.kernel.org>\t[4.7+]\nSigned-off-by:\
  \ Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n"
submodule:
- kernel
hunk_count: 1
covered_count: 1
