id: 0c90fc937c84f97d0aa6
bug_link: https://syzkaller.appspot.com/bug?extid=0c90fc937c84f97d0aa6
title: 'KASAN: use-after-free Read in cpia2_usb_disconnect'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a82c3149ad8b4a84f9737a633250815d5cf0cc5e
fix_commit: eff73de2b1600ad8230692f00bc0ab49b166512a
datetime: '2019-05-28T12:26:11-04:00'
fix_commit_message: 'media: cpia2_usb: first wake up, then free in disconnect


  Kasan reported a use after free in cpia2_usb_disconnect()

  It first freed everything and then woke up those waiting.

  The reverse order is correct.


  Fixes: 6c493f8b28c67 ("[media] cpia2: major overhaul to get it in a working state
  again")


  Signed-off-by: Oliver Neukum <oneukum@suse.com>

  Reported-by: syzbot+0c90fc937c84f97d0aa6@syzkaller.appspotmail.com

  Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

  Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

  '
submodule:
- drivers/media/usb/cpia2
hunk_count: 2
covered_count: 2
