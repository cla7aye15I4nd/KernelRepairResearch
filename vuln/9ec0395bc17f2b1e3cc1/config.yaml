id: 9ec0395bc17f2b1e3cc1
bug_link: https://syzkaller.appspot.com/bug?extid=9ec0395bc17f2b1e3cc1
title: general protection fault in io_sqe_files_unregister
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 170b3bbda08852277b97f4f0516df0785c939764
fix_commit: 3e2224c5867fead6c0b94b84727cc676ac6353a3
datetime: '2021-01-06T09:19:49-07:00'
fix_commit_message: 'io_uring: Fix return value from alloc_fixed_file_ref_node


  alloc_fixed_file_ref_node() currently returns an ERR_PTR on failure.

  io_sqe_files_unregister() expects it to return NULL and since it can only

  return -ENOMEM, it makes more sense to change alloc_fixed_file_ref_node()

  to behave that way.


  Fixes: 1ffc54220c44 ("io_uring: fix io_sqe_files_unregister() hangs")

  Reported-by: Dan Carpenter <dan.carpenter@oracle.com>

  Signed-off-by: Matthew Wilcox (Oracle) <willy@infradead.org>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 3
covered_count: 0
