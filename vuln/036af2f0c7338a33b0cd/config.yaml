id: 036af2f0c7338a33b0cd
bug_link: https://syzkaller.appspot.com/bug?extid=036af2f0c7338a33b0cd
title: 'INFO: rcu detected stall in do_vmi_munmap (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6dacd79d28842ff01f18b4900d897741aac5999e
fix_commit: f806de88d8f7f8191afd0fd9b94db4cd058e7d4f
datetime: '2024-09-01T17:59:01-07:00'
fix_commit_message: 'maple_tree: remove rcu_read_lock() from mt_validate()


  The write lock should be held when validating the tree to avoid updates

  racing with checks.  Holding the rcu read lock during a large tree

  validation may also cause a prolonged rcu read window and "rcu_preempt

  detected stalls" warnings.


  Link: https://lore.kernel.org/all/0000000000001d12d4062005aea1@google.com/

  Link: https://lkml.kernel.org/r/20240820175417.2782532-1-Liam.Howlett@oracle.com

  Fixes: 54a611b60590 ("Maple Tree: add new data structure")

  Signed-off-by: Liam R. Howlett <Liam.Howlett@Oracle.com>

  Reported-by: syzbot+036af2f0c7338a33b0cd@syzkaller.appspotmail.com

  Cc: Hillf Danton <hdanton@sina.com>

  Cc: Matthew Wilcox <willy@infradead.org>

  Cc: "Paul E. McKenney" <paulmck@kernel.org>

  Cc: <stable@vger.kernel.org>

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- lib
hunk_count: 2
covered_count: 2
