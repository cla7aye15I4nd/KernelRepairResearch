id: c9937dfb2303a5f18640
bug_link: https://syzkaller.appspot.com/bug?extid=c9937dfb2303a5f18640
title: WARNING in percpu_ref_kill_and_confirm (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a528b04ea40690ff40501f50d618a62a02b19620
fix_commit: 9faadcc8abe4b83d0263216dc3a6321d5bbd616b
datetime: '2020-12-22T17:14:50-07:00'
fix_commit_message: 'io_uring: fix double io_uring free


  Once we created a file for current context during setup, we should not

  call io_ring_ctx_wait_and_kill() directly as it''ll be done by fput(file)


  Cc: stable@vger.kernel.org # 5.10

  Reported-by: syzbot+c9937dfb2303a5f18640@syzkaller.appspotmail.com

  Signed-off-by: Pavel Begunkov <asml.silence@gmail.com>

  [axboe: fix unused ''ret'' for !CONFIG_UNIX]

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 3
covered_count: 0
