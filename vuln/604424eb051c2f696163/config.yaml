id: 604424eb051c2f696163
bug_link: https://syzkaller.appspot.com/bug?extid=604424eb051c2f696163
title: 'KASAN: slab-out-of-bounds Write in squashfs_readahead (2)'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 44e3876d268be49ee810481ee3c95d8d650bf22e
fix_commit: 12427de9439d68b8e96ba6f50b601ef15f437612
datetime: '2023-12-10T17:21:26-08:00'
fix_commit_message: 'Squashfs: fix variable overflow triggered by sysbot


  Sysbot reports a slab out of bounds write in squashfs_readahead().


  This is ultimately caused by a file reporting an (infeasibly) large file

  size (1407374883553280 bytes) with the minimum block size of 4K.


  This causes variable overflow.


  Link: https://lkml.kernel.org/r/20231113160901.6444-1-phillip@squashfs.org.uk

  Signed-off-by: Phillip Lougher <phillip@squashfs.org.uk>

  Reported-by: syzbot+604424eb051c2f696163@syzkaller.appspotmail.com

  Closes: https://lore.kernel.org/all/000000000000b1fda20609ede0d1@google.com/

  Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

  '
submodule:
- fs/squashfs
hunk_count: 2
covered_count: 1
