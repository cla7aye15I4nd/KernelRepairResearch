id: 4eb7a741b3216020043a
bug_link: https://syzkaller.appspot.com/bug?extid=4eb7a741b3216020043a
title: WARNING in handle_policy_update
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3b44cd0998678b55a0df20b514bca0e298f4ff48
fix_commit: f09ff307c7299392f1c88f763299e24bc99811c7
datetime: '2025-01-04T22:46:09-05:00'
fix_commit_message: 'safesetid: check size of policy writes


  syzbot attempts to write a buffer with a large size to a sysfs entry

  with writes handled by handle_policy_update(), triggering a warning

  in kmalloc.


  Check the size specified for write buffers before allocating.


  Reported-by: syzbot+4eb7a741b3216020043a@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=4eb7a741b3216020043a

  Signed-off-by: Leo Stone <leocstone@gmail.com>

  [PM: subject tweak]

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  '
submodule:
- security/safesetid
hunk_count: 1
covered_count: 1
