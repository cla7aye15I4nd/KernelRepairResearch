id: 581aff2ae6b860625116
bug_link: https://syzkaller.appspot.com/bug?extid=581aff2ae6b860625116
title: general protection fault in sctp_rcv
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9bc62afe03afdf33904f5e784e1ad68c50ff00bb
fix_commit: f7e745f8e94492a8ac0b0a26e25f2b19d342918f
datetime: '2021-09-24T10:36:19+01:00'
fix_commit_message: "sctp: break out if skb_header_pointer returns NULL in sctp_rcv_ootb\n\
  \nWe should always check if skb_header_pointer's return is NULL before\nusing it,\
  \ otherwise it may cause null-ptr-deref, as syzbot reported:\n\n  KASAN: null-ptr-deref\
  \ in range [0x0000000000000000-0x0000000000000007]\n  RIP: 0010:sctp_rcv_ootb net/sctp/input.c:705\
  \ [inline]\n  RIP: 0010:sctp_rcv+0x1d84/0x3220 net/sctp/input.c:196\n  Call Trace:\n\
  \  <IRQ>\n   sctp6_rcv+0x38/0x60 net/sctp/ipv6.c:1109\n   ip6_protocol_deliver_rcu+0x2e9/0x1ca0\
  \ net/ipv6/ip6_input.c:422\n   ip6_input_finish+0x62/0x170 net/ipv6/ip6_input.c:463\n\
  \   NF_HOOK include/linux/netfilter.h:307 [inline]\n   NF_HOOK include/linux/netfilter.h:301\
  \ [inline]\n   ip6_input+0x9c/0xd0 net/ipv6/ip6_input.c:472\n   dst_input include/net/dst.h:460\
  \ [inline]\n   ip6_rcv_finish net/ipv6/ip6_input.c:76 [inline]\n   NF_HOOK include/linux/netfilter.h:307\
  \ [inline]\n   NF_HOOK include/linux/netfilter.h:301 [inline]\n   ipv6_rcv+0x28c/0x3c0\
  \ net/ipv6/ip6_input.c:297\n\nFixes: 3acb50c18d8d (\"sctp: delay as much as possible\
  \ skb_linearize\")\nReported-by: syzbot+581aff2ae6b860625116@syzkaller.appspotmail.com\n\
  Signed-off-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Marcelo Ricardo Leitner\
  \ <marcelo.leitner@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>\n"
submodule:
- net/sctp
hunk_count: 1
covered_count: 1
