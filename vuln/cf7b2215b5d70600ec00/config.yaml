id: cf7b2215b5d70600ec00
bug_link: https://syzkaller.appspot.com/bug?extid=cf7b2215b5d70600ec00
title: kernel BUG in bch2_btree_pos_to_text
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 19773ec997201a45b3a1b5f1171897cba0f30bab
fix_commit: 0151d10a480da22d0c137f859645fdc79e10b551
datetime: '2024-10-09T16:42:53-04:00'
fix_commit_message: 'bcachefs: add check for btree id against max in try read node


  Add check for read node''s btree_id against BTREE_ID_NR_MAX in

  try_read_btree_node to prevent triggering EBUG_ON condition in

  bch2_btree_id_root[1].


  [1] https://syzkaller.appspot.com/bug?extid=cf7b2215b5d70600ec00


  Reported-by: syzbot+cf7b2215b5d70600ec00@syzkaller.appspotmail.com

  Closes: https://syzkaller.appspot.com/bug?extid=cf7b2215b5d70600ec00

  Fixes: 4409b8081d16 ("bcachefs: Repair pass for scanning for btree nodes")

  Signed-off-by: Piotr Zalewski <pZ010001011111@proton.me>

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 1
covered_count: 1
