id: 9ea265d998de25ac6a46
bug_link: https://syzkaller.appspot.com/bug?extid=9ea265d998de25ac6a46
title: WARNING in mac80211_hwsim_config_mac_nl
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 11ac0d7c3b5ba58232fb7dacb54371cbe75ec183
fix_commit: 52cebabb1264a51c80b2461d52e71600c1c58df2
datetime: '2024-12-03T11:28:59+01:00'
fix_commit_message: 'wifi: mac80211: fix vif addr when switching from monitor to station


  Since adding support for opting out of virtual monitor support, a zero vif

  addr was used to indicate passive vs active monitor to the driver.

  This would break the vif->addr when changing the netdev mac address before

  switching the interface from monitor to sta mode.

  Fix the regression by adding a separate flag to indicate whether vif->addr

  is valid.


  Reported-by: syzbot+9ea265d998de25ac6a46@syzkaller.appspotmail.com

  Fixes: 9d40f7e32774 ("wifi: mac80211: add flag to opt out of virtual monitor support")

  Signed-off-by: Felix Fietkau <nbd@nbd.name>

  Link: https://patch.msgid.link/20241115115850.37449-1-nbd@nbd.name

  Signed-off-by: Johannes Berg <johannes.berg@intel.com>

  '
submodule:
- include/net
- net/mac80211
hunk_count: 4
covered_count: 1
