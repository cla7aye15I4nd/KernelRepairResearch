id: 7170d66493145b71afd4
bug_link: https://syzkaller.appspot.com/bug?extid=7170d66493145b71afd4
title: 'KASAN: use-after-free Read in mas_next_nentry'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a1de832bd3243577de365222d8bc92708005ebf3
fix_commit: 59f2f4b8a757412fce372f6d0767bdb55da127a8
datetime: '2022-11-07T12:58:26-08:00'
fix_commit_message: 'fs/userfaultfd: Fix maple tree iterator in userfaultfd_unregister()


  When iterating the VMAs, the maple state needs to be invalidated if the

  tree is modified by a split or merge to ensure the maple tree node

  contained in the maple state is still valid.  These invalidations were

  missed, so add them to the paths which alter the tree.


  Reported-by: syzbot+0d2014e4da2ccced5b41@syzkaller.appspotmail.com

  Fixes: 69dbe6daf104 (userfaultfd: use maple tree iterator to iterate VMAs)

  Signed-off-by: Liam R. Howlett <Liam.Howlett@oracle.com>

  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

  '
submodule:
- fs
hunk_count: 1
covered_count: 1
