id: 77c53db50c9fff774e8e
bug_link: https://syzkaller.appspot.com/bug?extid=77c53db50c9fff774e8e
title: WARNING in smk_set_cipso (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 2e08fb550a2d1017052685a27691911a633c1771
fix_commit: 49ec114a6e62d8d320037ce71c1aaf9650b3cafd
datetime: '2021-05-10T13:55:08-07:00'
fix_commit_message: 'smackfs: restrict bytes count in smk_set_cipso()


  Oops, I failed to update subject line.


  From 07571157c91b98ce1a4aa70967531e64b78e8346 Mon Sep 17 00:00:00 2001

  From: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Date: Mon, 12 Apr 2021 22:25:06 +0900

  Subject: [PATCH] smackfs: restrict bytes count in smk_set_cipso()


  Commit 7ef4c19d245f3dc2 ("smackfs: restrict bytes count in smackfs write

  functions") missed that count > SMK_CIPSOMAX check applies to only

  format == SMK_FIXED24_FMT case.


  Reported-by: syzbot <syzbot+77c53db50c9fff774e8e@syzkaller.appspotmail.com>

  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>

  Signed-off-by: Casey Schaufler <casey@schaufler-ca.com>

  '
submodule:
- security/smack
hunk_count: 1
covered_count: 1
