id: e951ad5349f3a34a715a
bug_link: https://syzkaller.appspot.com/bug?extid=e951ad5349f3a34a715a
title: kernel BUG in bch2_checksum
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: c06a8b75679d73473c0c382bcc676ee4b7657bee
fix_commit: 6b74fdcc8e25323cd256a573186f9c6c6c2410c0
datetime: '2024-05-20T05:37:26-04:00'
fix_commit_message: 'bcachefs: bch2_checksum() returns 0 for unknown checksum type


  This fixes missing guards on trying to calculate a checksum with an

  invalid/unknown checksum type; moving the guards up to e.g. btree_io.c

  might be "more correct", but doesn''t buy us anything - an unknown

  checksum type will always be flagged as at least a checksum error so we

  aren''t losing any safety doing it this way and it makes it less likely

  to accidentally pop an assert we don''t want.


  Reported-by: syzbot+e951ad5349f3a34a715a@syzkaller.appspotmail.com

  Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

  '
submodule:
- fs/bcachefs
hunk_count: 2
covered_count: 1
