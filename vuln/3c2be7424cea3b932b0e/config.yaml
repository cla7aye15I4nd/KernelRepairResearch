id: 3c2be7424cea3b932b0e
bug_link: https://syzkaller.appspot.com/bug?extid=3c2be7424cea3b932b0e
title: memory leak in usb_urb_init
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 3ddcea9f7da0d7df25e12c2f2e06082341fed4fb
fix_commit: b7cd0da982e3043f2eec7235ac5530cb18d6af1d
datetime: '2021-04-09T13:02:20+02:00'
fix_commit_message: "media: dvb-usb: fix memory leak in dvb_usb_adapter_init\n\nsyzbot\
  \ reported memory leak in dvb-usb. The problem was\nin invalid error handling in\
  \ dvb_usb_adapter_init().\n\nfor (n = 0; n < d->props.num_adapters; n++) {\n....\n\
  \tif ((ret = dvb_usb_adapter_stream_init(adap)) ||\n\t\t(ret = dvb_usb_adapter_dvb_init(adap,\
  \ adapter_nrs)) ||\n\t\t(ret = dvb_usb_adapter_frontend_init(adap))) {\n\t\treturn\
  \ ret;\n\t}\n...\n\td->num_adapters_initialized++;\n...\n}\n\nIn case of error in\
  \ dvb_usb_adapter_dvb_init() or\ndvb_usb_adapter_dvb_init() d->num_adapters_initialized\
  \ won't be\nincremented, but dvb_usb_adapter_exit() relies on it:\n\n\tfor (n =\
  \ 0; n < d->num_adapters_initialized; n++)\n\nSo, allocated objects won't be freed.\n\
  \nSigned-off-by: Pavel Skripkin <paskripkin@gmail.com>\nReported-by: syzbot+3c2be7424cea3b932b0e@syzkaller.appspotmail.com\n\
  Signed-off-by: Sean Young <sean@mess.org>\nSigned-off-by: Mauro Carvalho Chehab\
  \ <mchehab+huawei@kernel.org>\n"
submodule:
- drivers/media/usb/dvb-usb
hunk_count: 2
covered_count: 2
