id: 7afeeb8e62e4716de370
bug_link: https://syzkaller.appspot.com/bug?extid=7afeeb8e62e4716de370
title: 'KASAN: slab-out-of-bounds Read in clusterip_tg_check'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 1e98ffea5a8935ec040ab72299e349cb44b8defd
fix_commit: 1a38956cce5eabd7b74f94bab70265e4df83165e
datetime: '2018-01-31T15:00:33+01:00'
fix_commit_message: 'netfilter: ipt_CLUSTERIP: fix out-of-bounds accesses in clusterip_tg_check()


  Commit 136e92bbec0a switched local_nodes from an array to a bitmask

  but did not add proper bounds checks. As the result

  clusterip_config_init_nodelist() can both over-read

  ipt_clusterip_tgt_info.local_nodes and over-write

  clusterip_config.local_nodes.


  Add bounds checks for both.


  Fixes: 136e92bbec0a ("[NETFILTER] CLUSTERIP: use a bitmap to store node responsibility
  data")

  Signed-off-by: Dmitry Vyukov <dvyukov@google.com>

  Reported-by: syzbot <syzkaller@googlegroups.com>

  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>

  '
submodule:
- net/ipv4
hunk_count: 2
covered_count: 2
