id: 3f04d36b7336f7868066
bug_link: https://syzkaller.appspot.com/bug?extid=3f04d36b7336f7868066
title: general protection fault in xsk_diag_dump (2)
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 858e8b2eb4dd6fe6c4640463ad2f2ed3b8249ad4
fix_commit: 53ea2076d851ee37e4f3954c5ae569439b138248
datetime: '2020-09-02T16:49:40+02:00'
fix_commit_message: 'xsk: Fix possible segfault in xsk umem diagnostics


  Fix possible segfault in the xsk diagnostics code when dumping

  information about the umem. This can happen when a umem has been

  created, but the socket has not been bound yet. In this case, the xsk

  buffer pool does not exist yet and we cannot dump the information

  that was moved from the umem to the buffer pool. Fix this by testing

  for the existence of the buffer pool and if not there, do not dump any

  of that information.


  Fixes: c2d3d6a47462 ("xsk: Move queue_id, dev and need_wakeup to buffer pool")

  Fixes: 7361f9c3d719 ("xsk: Move fill and completion rings to buffer pool")

  Reported-by: syzbot+3f04d36b7336f7868066@syzkaller.appspotmail.com

  Signed-off-by: Magnus Karlsson <magnus.karlsson@intel.com>

  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

  Link: https://lore.kernel.org/bpf/1599036743-26454-1-git-send-email-magnus.karlsson@intel.com

  '
submodule:
- net/xdp
hunk_count: 1
covered_count: 1
