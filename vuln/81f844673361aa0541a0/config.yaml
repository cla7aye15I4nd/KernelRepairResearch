id: 81f844673361aa0541a0
bug_link: https://syzkaller.appspot.com/bug?extid=81f844673361aa0541a0
title: 'INFO: task can''t die in blk_mq_freeze_queue_wait'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 94c4b4fd25e6c3763941bdec3ad54f2204afa992
fix_commit: 95febeb61bf87ca803a1270498cd4cd61554a68f
datetime: '2021-11-15T17:00:54-07:00'
fix_commit_message: 'block: fix missing queue put in error path


  If we fail the submission queue checks, we don''t put the queue afterwards.

  This can cause various issues like stalls on scheduler switch or failure

  to remove the device, or like in the original bug report, timeout waiting

  for the device on reboot/restart.


  While in there, fix a few whitespace discrepancies in the surrounding

  code.


  Link: https://bugzilla.kernel.org/show_bug.cgi?id=215039

  Fixes: b637108a4022 ("blk-mq: fix filesystem I/O request allocation")

  Reported-and-tested-by: Stephen Smith <stephenmsmith@blueyonder.co.uk>

  Reviewed-by: Ming Lei <ming.lei@redhat.com>

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- block
hunk_count: 3
covered_count: 0
