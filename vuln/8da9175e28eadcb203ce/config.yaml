id: 8da9175e28eadcb203ce
bug_link: https://syzkaller.appspot.com/bug?extid=8da9175e28eadcb203ce
title: 'KMSAN: kernel-infoleak in tty_compat_ioctl'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ed069827ca70af057caf21c395f76c2c0b82d429
fix_commit: 17329563a97df3ba474eca5037c1336e46e14ff8
datetime: '2020-03-18T13:15:13+01:00'
fix_commit_message: 'tty: fix compat TIOCGSERIAL leaking uninitialized memory


  Commit 77654350306a ("take compat TIOC[SG]SERIAL treatment into

  tty_compat_ioctl()") changed the compat version of TIOCGSERIAL to start

  copying a whole ''serial_struct32'' to userspace rather than individual

  fields, but failed to initialize all padding and fields -- namely the

  hole after the ''iomem_reg_shift'' field, and the ''reserved'' field.


  Fix this by initializing the struct to zero.


  [v2: use sizeof, and convert the adjacent line for consistency.]


  Reported-by: syzbot+8da9175e28eadcb203ce@syzkaller.appspotmail.com

  Fixes: 77654350306a ("take compat TIOC[SG]SERIAL treatment into tty_compat_ioctl()")

  Cc: <stable@vger.kernel.org> # v4.20+

  Signed-off-by: Eric Biggers <ebiggers@google.com>

  Acked-by: Jiri Slaby <jslaby@suse.cz>

  Link: https://lore.kernel.org/r/20200224182044.234553-2-ebiggers@kernel.org

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/tty
hunk_count: 1
covered_count: 1
