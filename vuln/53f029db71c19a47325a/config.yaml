id: 53f029db71c19a47325a
bug_link: https://syzkaller.appspot.com/bug?extid=53f029db71c19a47325a
title: general protection fault in smsusb_init_device
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 9610450ea31eb061b9914de2bf6ced424956182d
fix_commit: 31e0456de5be379b10fea0fa94a681057114a96e
datetime: '2019-05-21T10:08:56+02:00'
fix_commit_message: 'media: usb: siano: Fix general protection fault in smsusb


  The syzkaller USB fuzzer found a general-protection-fault bug in the

  smsusb part of the Siano DVB driver.  The fault occurs during probe

  because the driver assumes without checking that the device has both

  IN and OUT endpoints and the IN endpoint is ep1.


  By slightly rearranging the driver''s initialization code, we can make

  the appropriate checks early on and thus avoid the problem.  If the

  expected endpoints aren''t present, the new code safely returns -ENODEV

  from the probe routine.


  Signed-off-by: Alan Stern <stern@rowland.harvard.edu>

  Reported-and-tested-by: syzbot+53f029db71c19a47325a@syzkaller.appspotmail.com

  CC: <stable@vger.kernel.org>

  Reviewed-by: Johan Hovold <johan@kernel.org>

  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

  '
submodule:
- drivers/media/usb/siano
hunk_count: 3
covered_count: 3
