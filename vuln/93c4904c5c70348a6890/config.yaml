id: 93c4904c5c70348a6890
bug_link: https://syzkaller.appspot.com/bug?extid=93c4904c5c70348a6890
title: WARNING in ___bpf_prog_run
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 40950343932879247861ae152dcb55e4555afdff
fix_commit: 7891a87efc7116590eaba57acc3c422487802c6f
datetime: '2018-01-10T14:42:22-08:00'
fix_commit_message: "bpf: arsh is not supported in 32 bit alu thus reject it\n\nThe\
  \ following snippet was throwing an 'unknown opcode cc' warning\nin BPF interpreter:\n\
  \n  0: (18) r0 = 0x0\n  2: (7b) *(u64 *)(r10 -16) = r0\n  3: (cc) (u32) r0 s>>=\
  \ (u32) r0\n  4: (95) exit\n\nAlthough a number of JITs do support BPF_ALU | BPF_ARSH\
  \ | BPF_{K,X}\ngeneration, not all of them do and interpreter does neither. We can\n\
  leave existing ones and implement it later in bpf-next for the\nremaining ones,\
  \ but reject this properly in verifier for the time\nbeing.\n\nFixes: 17a5267067f3\
  \ (\"bpf: verifier (add verifier core)\")\nReported-by: syzbot+93c4904c5c70348a6890@syzkaller.appspotmail.com\n\
  Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>\nSigned-off-by: Alexei Starovoitov\
  \ <ast@kernel.org>\n"
submodule:
- kernel/bpf
- tools/testing/selftests/bpf
hunk_count: 2
covered_count: 0
