id: 044fdf24e96093584232
bug_link: https://syzkaller.appspot.com/bug?extid=044fdf24e96093584232
title: general protection fault in smack_log_callback
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: ea7e2d5e49c05e5db1922387b09ca74aa40f46e2
fix_commit: 8a23c9e1ba4642b60420e8caa75859883a509c24
datetime: '2024-09-19T16:37:01-04:00'
fix_commit_message: 'selinux,smack: properly reference the LSM blob in security_watch_key()


  Unfortunately when we migrated the lifecycle management of the key LSM

  blob to the LSM framework we forgot to convert the security_watch_key()

  callbacks for SELinux and Smack.  This patch corrects this by making use

  of the selinux_key() and smack_key() helper functions respectively.


  This patch also removes some input checking in the Smack callback as it

  is no longer needed.


  Fixes: 5f8d28f6d7d5 ("lsm: infrastructure management of the key security blob")

  Reported-by: syzbot+044fdf24e96093584232@syzkaller.appspotmail.com

  Tested-by: syzbot+044fdf24e96093584232@syzkaller.appspotmail.com

  Reviewed-by: Casey Schaufler <casey@schaufler-ca.com>

  Signed-off-by: Paul Moore <paul@paul-moore.com>

  '
submodule:
- security/selinux
- security/smack
hunk_count: 3
covered_count: 2
