id: e3132895630f957306bc
bug_link: https://syzkaller.appspot.com/bug?extid=e3132895630f957306bc
title: general protection fault in kernel_accept
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: f7db2beb4c2c6cc8111f5ab90fc7363ca91107b6
fix_commit: 78abe3d0dfad196959b1246003366e2610775ea6
datetime: '2018-12-18T22:02:51-08:00'
fix_commit_message: 'net/smc: fix TCP fallback socket release


  clcsock can be released while kernel_accept() references it in TCP

  listen worker. Also, clcsock needs to wake up before released if TCP

  fallback is used and the clcsock is blocked by accept. Add a lock to

  safely release clcsock and call kernel_sock_shutdown() to wake up

  clcsock from accept in smc_release().


  Reported-by: syzbot+0bf2e01269f1274b4b03@syzkaller.appspotmail.com

  Reported-by: syzbot+e3132895630f957306bc@syzkaller.appspotmail.com

  Signed-off-by: Myungho Jung <mhjungk@gmail.com>

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/smc
hunk_count: 5
covered_count: 3
