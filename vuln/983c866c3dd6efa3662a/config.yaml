id: 983c866c3dd6efa3662a
bug_link: https://syzkaller.appspot.com/bug?extid=983c866c3dd6efa3662a
title: 'BUG: unable to handle kernel paging request in coalesced_mmio_write'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: a9c20bb0206ae9384bd470a6832dd8913730add9
fix_commit: b60fe990c6b07ef6d4df67bc0530c7c90a62623a
datetime: '2019-09-18T15:56:55+02:00'
fix_commit_message: 'KVM: coalesced_mmio: add bounds checking


  The first/last indexes are typically shared with a user app.

  The app can change the ''last'' index that the kernel uses

  to store the next result.  This change sanity checks the index

  before using it for writing to a potentially arbitrary address.


  This fixes CVE-2019-14821.


  Cc: stable@vger.kernel.org

  Fixes: 5f94c1741bdc ("KVM: Add coalesced MMIO support (common part)")

  Signed-off-by: Matt Delco <delco@chromium.org>

  Signed-off-by: Jim Mattson <jmattson@google.com>

  Reported-by: syzbot+983c866c3dd6efa3662a@syzkaller.appspotmail.com

  [Use READ_ONCE. - Paolo]

  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

  '
submodule:
- virt/kvm
hunk_count: 3
covered_count: 3
