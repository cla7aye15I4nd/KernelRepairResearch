id: 9b260fc33297966f5a8e
bug_link: https://syzkaller.appspot.com/bug?extid=9b260fc33297966f5a8e
title: 'KASAN: use-after-free Read in io_async_task_func'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: efa8480a831673bb52400df9dbe5da0aacda97bf
fix_commit: 6d816e088c359866f9867057e04f244c608c42fe
datetime: '2020-08-11T08:09:13-06:00'
fix_commit_message: 'io_uring: hold ''ctx'' reference around task_work queue + execute


  We''re holding the request reference, but we need to go one higher

  to ensure that the ctx remains valid after the request has finished.

  If the ring is closed with pending task_work inflight, and the

  given io_kiocb finishes sync during issue, then we need a reference

  to the ring itself around the task_work execution cycle.


  Cc: stable@vger.kernel.org # v5.7+

  Reported-by: syzbot+9b260fc33297966f5a8e@syzkaller.appspotmail.com

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- fs
hunk_count: 9
covered_count: 1
