id: 583353673e394aa41e5fb68ddc8b8d9d5c8d576f
bug_link: https://syzkaller.appspot.com/bug?extid=583353673e394aa41e5fb68ddc8b8d9d5c8d576f
title: possible deadlock in blk_trace_remove
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 6c4ca1e36cdc1a0a7a84797804b87920ccbebf51
fix_commit: 2967acbb257a6a9bf912f4778b727e00972eac9b
datetime: '2017-11-27T12:03:58-07:00'
fix_commit_message: 'blktrace: fix trace mutex deadlock


  A previous commit changed the locking around registration/cleanup,

  but direct callers of blk_trace_remove() were missed. This means

  that if we hit the error path in setup, we will deadlock on

  attempting to re-acquire the queue trace mutex.


  Fixes: 1f2cac107c59 ("blktrace: fix unlocked access to init/start-stop/teardown")

  Signed-off-by: Jens Axboe <axboe@kernel.dk>

  '
submodule:
- kernel/trace
hunk_count: 2
covered_count: 2
