id: 707d98c8649695eaf329
bug_link: https://syzkaller.appspot.com/bug?extid=707d98c8649695eaf329
title: 'KASAN: slab-use-after-free Read in bq_xmit_all'
source_page: https://syzkaller.appspot.com/upstream/fixed
trigger_commit: 301927d2d2eb8e541357ba850bc7a1a74dbbd670
fix_commit: 9da49aa80d686582bc3a027112a30484c9be6b6e
datetime: '2024-07-29T10:55:15+01:00'
fix_commit_message: 'tun: Add missing bpf_net_ctx_clear() in do_xdp_generic()


  There are cases where do_xdp_generic returns bpf_net_context without

  clearing it. This causes various memory corruptions, so the missing

  bpf_net_ctx_clear must be added.


  Reported-by: syzbot+44623300f057a28baf1e@syzkaller.appspotmail.com

  Fixes: fecef4cd42c6 ("tun: Assign missing bpf_net_context.")

  Signed-off-by: Jeongjun Park <aha310510@gmail.com>

  Acked-by: Jason Wang <jasowang@redhat.com>

  Reviewed-by: Willem de Bruijn <willemb@google.com>

  Reported-by: syzbot+3c2b6d5d4bec3b904933@syzkaller.appspotmail.com

  Reported-by: syzbot+707d98c8649695eaf329@syzkaller.appspotmail.com

  Reported-by: syzbot+c226757eb784a9da3e8b@syzkaller.appspotmail.com

  Reported-by: syzbot+61a1cfc2b6632363d319@syzkaller.appspotmail.com

  Reported-by: syzbot+709e4c85c904bcd62735@syzkaller.appspotmail.com

  Signed-off-by: David S. Miller <davem@davemloft.net>

  '
submodule:
- net/core
hunk_count: 1
covered_count: 0
